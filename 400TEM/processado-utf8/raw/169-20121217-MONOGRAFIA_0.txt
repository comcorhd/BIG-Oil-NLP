Capítulo 3 Modelagem do Processo de Perfuração 3.1 – Introdução A Figura 8 ilustra o exemplo de uma sonda marítima de perfuração de um poço de petróleo. A coluna de perfuração é presa ao top drive, um motor responsável pela rotação da coluna, que se situa na parte superior do mastro ou derrick. A essa coluna é permitida também uma movimentação vertical uma vez que o top drive encontra-se preso a um ganho, permitindo que a coluna se movimente tanto para cima quanto para baixo, conforme for necessário para penetrar a formação rochosa. Depois de aproximadamente 27 metros uma nova seção de encanamento da coluna é conectada ao topo coluna anterior e com isso a perfuração é retomada. Este procedimento é conhecido como conexão de tubo. Para uma taxa regular de perfuração de 15m/h uma conexão de tubo é feita a cada duas horas (Stamnes, 2007).
Figura 8 - Exemplo de uma sonda de perfuração 
Durante o processo de perfuração, um componente conhecido como lama de perfuração é injetado na coluna de perfuração. A função do lama é unicamente transportar os detritos resultantes da perfuração. Ela também é responsável pelo controle da pressão durante a perfuração de um poço. Em técnicas convencionais o anular não é selado, isso torna o processo menos complexo e mais barato. Porém um sistema selado e contando com uma válvula de estrangulamento, ou válvula choke, e uma bomba de pressão reversa permite um melhor controle de sua pressão.
O principal motivo para o controle da pressão é prevenir o kick (influxo incontrolável do reservatório), que no pior dos casos pode causar o blowout de superfície, que em geral causa grandes perdas financeiras, danos ao meio ambiente e possíveis perdas de vidas humanas. O controle da pressão também é importante para prevenir o colapso do poço ou o seu fraturamento, como também para reduzir o dano à superfície das paredes do poço. Danos à parede do poço são causados quando o lama penetra ou entope as partes porosas do reservatório, o que diminui a produção em estágios posteriores (Stamnes, 2007).
Na literatura existem diversos modelos matemáticos que tratam de reproduzir a dinâmica do processo de perfuração, alguns deles rigorosos e outros mais simplificados.
Dentre destes últimos dois modelos se sobressaem, o modelo de Nygaard et al. (2006) e o modelo de Stamnes (2007), os quais serão apresentados a seguir.
3.2 – Modelo de Nygaard No trabalho de Nygaard et al. (2006) foram propostos dois modelos, um modelo de ordem reduzida e outro modelo que contém um maior detalhamento dos fenômenos que podem ocorrer no poço durante o processo de perfuração. O modelo de ordem reduzida foi desenvolvido a partir da observação do comportamento de um fluido bifásico (líquido + gás) de perfuração no que diz respeito à pressão de fundo.
A Figura 9 apresenta o esquema de balanço de massa de um processo de perfuração, dividido em dois sistemas: coluna de perfuração e anular. Seguindo esta divisão, o balanço de massa na coluna de perfuração (denotado pelo sub-índice ) é dado por: 
(1) (2) (3) (4) Sendo um índice, que quando substituído por faz referência à parte gasosa do sistema e à parte líquida, os parâmetros da equação ficam da seguinte forma: é o fluxo de massa na bomba;  é o fluxo de massa na broca de perfuração;   é a massa na coluna de perfuração.
O balanço de massa no anular (denotado pelo sub-índice ) é dado por: (5) (6) (7) (8) onde: 
é o fluxo de massa no reservatório;  é o fluxo de massa na saída da válvula choke;   é a massa no anular.
Além disso, é importante inserir no sistema a influência da pressão de fricção introduzida pela velocidade do líquido. Quando gás é injetado no poço, o volume de gás se altera da mesma forma que muda a pressão hidrostática devido à variação da densidade da mistura. Portanto, as pressões que atuam sobre o sistema estão representadas e divididas conforme Figura 10. Esse balanço é avaliado em dois pontos distintos, de onde são obtidas as acelerações de massa no final da broca e no topo do anular.
A variação na taxa do fluxo de massa da mistura gás-líquido na coluna de perfuração ( é dependente das pressões de compressão da própria coluna ( ) e do anular ( ), da pressão hidrostática da coluna ( ) e do anular ( ), das perdas causadas pela fricção da coluna de perfuração ( ) e do anular ( ). Assim, temos a Equação (9), sendo que é a área seccional da coluna de perfuração.
(9) 
(10) Adotando como a área seccional do anular, a variação do fluxo de massa da mistura gás-líquido na válvula choke é dada por: (11) (12) Outro fator que influencia na pressão de fundo é a profundidade do poço. À medida que essa profundidade vai se tornando cada vez maior, ocorre um acréscimo na taxa de perfuração . Sendo assim, a profundidade, representada por , é considerada também um estado do sistema dinâmico proposto por Nygaard et al. (2006), da forma: (13) (14) Organizando as equações de balanço de massa, e definindo as entradas e saída do sistema, o modelo de ordem reduzida pode ser descrito da seguinte forma: (15) ⃗ (16) (17) Sendo ⃗ o vetor contendo os sete estados de entrada do modelo, ⃗ a saída, onde representa a pressão anular de fundo (BHP), que é a variável que deverá ser controlada, e ⃗⃗ é o vetor contendo a variável manipulada , que corresponde ao parâmetro de abertura da válvula choke.
Quando um poço de petróleo é modelado usando a coluna de perfuração e o anular como dois compartimentos, é assumido que o gás está uniformemente disperso no líquido.
(Nygaard et al., 2006). Assim, a densidade da mistura gás-líquido em cada parte do poço é dada pela seguinte relação: 
(18) Sendo que é a massa de gás, é a massa de líquido e é o volume total no compartimento analisado.
A porosidade do líquido na mistura ( é usada para calcular a taxa de massa do gás e do líquido, e é dada por: (19) Se a velocidade é reduzida, as perdas devido à pressão de fricção são reduzidas e o gás se expande, o que causa a fuga do líquido para fora do poço e leva o gás a ficar contido na parte de dentro. Com isso, a taxa da massa de gás deve ser modificada para misturas com baixa velocidade e nesse caso é dada por: (20) Os cálculos do fluxo de massa da parte gasosa e líquida na broca e na válvula choke são obtidos a partir do fluxo de massa da mistura e utilizando a Equação (20). Assim, os fluxos de massa ficam da seguinte maneira: (21) (22) (23) (24) A pressão de fundo é dada: (25) Sendo o fator de compressão do líquido, a densidade do gás, a constante do gás, a massa molecular do gás, a temperatura média, a pressão atmosférica, a 
gravidade, a profundidade do poço, o fator de fricção que ocorre entre o líquido e a parede do poço e a velocidade da mistura, os termos que compõe a Equação (25) estão representadas pelas equações: (26) (27) (28) (29) (30) Os valores de e são obtidos da Equação (18), é o coeficiente de descarga da restrição, que é a relação da taxa de fluxo de massa no final da tubulação, e é a área de restrição, que no caso da válvula choke representa a sua abertura.
3.3 – Modelo de Stamnes Esse modelo foi originalmente proposto por Kaasa (2007) e posteriormente desenvolvido por Stamnes (2007). Nele é considerado um fluido de perfuração monofásico e o poço dividido em dois compartimentos distintos, de maneira semelhante à proposta de Nygaard et al. (2006). A Figura 11 mostra a divisão do sistema nas duas regiões, isto é a coluna de perfuração e o anular, sendo estas conectadas pela broca de perfuração.

Figura 11 - Divisão do sistema proposto no modelo de Stamnes Neste sistema, uma bomba de lama bombeia a lama de perfuração para dentro da coluna de perfuração. Em condições normais o lama flui da bomba para a coluna de perfuração, para a broca, e depois o anular e sai pela válvula choke. Depois da válvula choke, a lama é reciclada e retorna ao seu reservatório. O propósito da circulação da lama de perfuração é limpar os cascalhos e ajudar a manter o perfil de pressão correto no poço. O maior componente é o peso hidrostático da lama, seguido da pressão da choke e por último a pressão devido à fricção (Brill & Mukhrtjee, 1999). A Equação (31) mostra a equação em estado estacionário para a pressão na broca de perfuração ( e seus principais componentes.
(31) Sendo a densidade da lama de perfuração, a gravidade, a profundidade, a pressão na válvula choke, o fator de fricção e o volume do fluido no anular, pode-se perceber que modificando qualquer um desses parâmetros é possível modificar a pressão na broca de perfuração. Porém, variar a densidade leva um tempo considerável para obter uma resposta, pois essa alteração tem que atingir todo a lama para causar algum efeito e isso 
demanda tempo. As formas mais rápidas de conseguir uma variação na pressão da broca são alterando a pressão na válvula choke ( ou modificando o volume de fluido no anular ( ).
Para produzir uma alteração na pressão na choke basta modificar a sua abertura, e para modificar o volume do fluido no anular é só alterar o fluxo na bomba de lama. Caso a choke esteja completamente fechada, é possível modificar essa pressão controlando a bomba de pressão reversa.
Aplicando o princípio do balanço de massa, o sistema mostrado na Figura 11 pode ser descrito pelo seguinte conjunto de equações: (32) (33) onde é a pressão na bomba de lama, é o fluxo através da broca de perfuração, é o fluxo através da bomba de lama, é o fluxo na bomba de pressão reversa, é o fluxo na válvula choke, é o influxo do reservatório (uma perturbação que pode ocorrer no sistema). Os demais fatores são: : Volume na coluna de perfuração;  : Volume no anular;  : Módulo de elasticidade da coluna de perfuração;  : Módulo de elasticidade do anular;   : Massa da coluna de perfuração;  : Massa do anular; : Fator de fricção da coluna de perfuração;  : Fator de fricção do anular;  : densidade do anular.
 e tem os seus valores obtidos por meio das Equações (35) e (36): 
(35) (36) sendo ̅ a densidade média no anular, é o comprimento do anular, é a área seccional do anular, ̅ é a densidade média na coluna, é o comprimento total da coluna de perfuração e é a área seccional da coluna de perfuração.
O fluxo na válvula choke ( é dependente de sua abertura ( ) e de sua pressão ( ). Com isso, o fluxo é dado por: (37) onde é a constante de fluxo da válvula e é a pressão de saída na válvula, sendo a abertura da válvula normalizada, i.e. .
Os fluxos na bomba de lama e na bomba de pressão reversa são dados pelas seguintes relações: (38) (39) Ambos os fluxos são dependentes da velocidade rotacional da bomba ( para a bomba de lama e para a bomba de pressão reversa), do número de pistão de cada bomba ( e ) e do volume do golpe por pistão ( e ).
Assumindo as relações:   
e substituindo as Equações (37), (38) e (39) nas Equações (32), (33) e (34), o modelo pode ser descrito por: (40) (41) (42) Sendo a entrada de controle dada por: (43) A saída do modelo, que nesse caso corresponde à pressão da broca de perfuração que é equivalente a pressão de fundo (BHP), pode ser representada por: ̅ ) (44) 3.3 – Escolha do Modelo Na avaliação dos modelos apresentados, foi observado que o modelo de Nygaard apresenta um problema quando posto em prática o conceito de MPD. Ele é válido para um fluido de perfuração bifásico, e com isso sua aplicabilidade melhor se adéqua ao enunciado de UBD, onde gás é injetado ao líquido para mudar a densidade do fluido e em geral fazer com que a pressão de fundo seja inferior à pressão da estrutura. Por isso o modelo de Stamnes, que considera um fluido de perfuração monofásico, foi adotado no presente trabalho como a principal ferramenta de suporte à simulação do processo de perfuração e aplicação de técnicas MPD.

3.4 – Simulação em MatLab/Simulink® - Análise em Malha Aberta Usando as Equações (40), (41), (42) e (44) e os valores dos parâmetros listados na Tabela 1, foi possível desenvolver um simulador em ambiente MatLab/Simulink®, cujo layout é apresentado na Figura 12. Este simulador tem como entradas o fluxo da bomba de lama ( ) e o percentual de abertura da válvula choke ( ), e como saída a pressão da broca ( ), que equivale à pressão anular de fundo (BHP). Além disso, é possível observar os estados como a pressão da bomba de entrada ( ), o fluxo na broca ( ) e a pressão da válvula choke ( ).

Figura 12 – Implementação do modelo de Stamnes em ambiente MatLab/Simulink® Para analisar a resposta dinâmica do processo, primeiro foi mantida constante a variável correspondente à vazão de lama ( ) no valor de , já a variável correspondente ao percentual de abertura da válvula choke ( ), sendo 0% totalmente fechada e 100% totalmente aberta, e tendo como ponto de partida da simulação uma abertura de 20%, teve esse valor variado em conforme mostrado na Figura 13.
Figura 13 – Sequência de variações na abertura da válvula choke 
A resposta da saída BHP a variações na abertura da válvula choke é mostrada na Figura 14, onde se visualiza claramente que o fechamento da válvula choke resultou no aumento da pressão no fundo do poço e a abertura resultou na diminuição dessa pressão. Além disso, embora as variações na entrada sejam simétricas, a resposta é assimétrica ressaltando a grande não-linearidade do processo.
Figura 14 - Comportamento da pressão de fundo ( ) a variações na abertura da válvula choke A Figura 15 mostra o comportamento dos estados, pressão na bomba de lama ( ), fluxo na broca ( ) e pressão na válvula choke ( ). Nela é possível observar o comportamento das pressões de forma análoga ao comportamento da pressão de fundo. Se a abertura da válvula choke for alterada, a pressão nela e a pressão na bomba de lama acompanham inversamente essa alteração, apresentando um aumento na pressão caso ela seja fechada e um alívio na pressão se ela for aberta. O fluxo na broca tende a responder em forma direta à abertura da válvula, voltando a estabilizar no ponto de operação nominal.

Figura 15 – Resposta dos estados a variações na abertura da válvula choke Noutro caso, a abertura da válvula choke é mantida constante em 20% e o fluxo na bomba de lama ( ) é modificado. Essa variável de entrada é inicializada no valor de e com o tempo sofre alterações em conforme mostrado na Figura 16.
Figura 16 – Variações na vazão da bomba de lama A Figura 17 mostra o perfil de resposta da pressão de fundo. Nela é possível visualizar que a pressão varia de maneira diretamente proporcional a variação do fluxo na bomba de lama. Quando o fluxo de lama aumenta, aumenta a pressão hidrostática e, portanto, a BHP também aumenta, e quando o fluxo de lama diminui a pressão também o acompanha.

Figura 17 - Comportamento da pressão de fundo a variações no fluxo da bomba de lama A Figura 18 mostra o comportamento dos estados, pressão da bomba de entrada ( ), fluxo na broca ( ) e pressão da válvula choke ( ), respectivamente. Neste caso, os três estados se comportam de maneira semelhante à BHP, sendo também diretamente proporcionais à variação do fluxo na bomba de lama. Isto é, o aumento (diminuição) de fluxo de lama no sistema, aumenta (diminui) a pressão hidrostática que aumenta (diminui) as pressões e a vazão na broca.
Figura 18 - Resposta dos estados a variações no fluxo de lama 
Outras respostas analisadas foram a influencia de perturbações. Enquanto a vazão da bomba de lama e a abertura da válvula choke foram mantidos constantes nos seus estados estacionários, ou seja, e respectivamente, foram simulados variações no influxo no reservatório ( ) e variações na vazão da bomba de pressão reversa ( .
Nas simulações anteriores, estas variáveis permaneceriam em seu valor estacionário mostrados na Tabela 1.
A primeira perturbação simulada consistiu em variações no influxo no reservatório .
Nesse caso, seu valor estacionário foi modificado em de seu valor inicial, conforme mostra a Figura 19.
O comportamento da pressão de fundo é apresentado na Figura 20. É possível observar que uma modificação no valor de gera uma variação diretamente proporcional na pressão de fundo. Essa tendência se repete nos estados mostrados na Figura 21 com exceção do comportamento da vazão na broca de perfuração . Como a vazão na broca de perfuração está intimamente ligada com o valor de é ela quem sofre uma alteração inversamente proporcional a essa modificação do influxo.

Figura 20 - Comportamento da pressão de fundo a variações na vazão do influxo Figura 21 - Resposta dos estados a variações na vazão do influxo A segunda perturbação analisada é a influência de mudanças na vazão da bomba de pressão reversa . Neste caso seu valor estacionário foi modificado em de seu valor inicial, conforme mostrado na Figura 22. O perfil do comportamento da pressão de fundo é apresentado na Figura 23. É possível observar que uma modificação no valor de também gera uma variação diretamente proporcional na pressão de fundo. Os estados, representados na Figura 24, se comportam de maneira semelhante com exceção da vazão na broca de perfuração . Isso acontece graças à influência que a pressão na válvula choke tem sobre o fluxo na broca . Nesse caso como ocorre o aumento da pressão na choke há uma diminuição no valor de e vice-versa.

Figura 22 – Sequência de variações na vazão da bomba de pressão reversa Figura 23 – Resposta da pressão de fundo à variações na vazão da bomba de pressão reversa Figura 24 – Respostas dos estados a variações na vazão da bomba de pressão reversa 
Capítulo 4 Teoria de Controle Preditivo (MPC) 4.1 – Introdução O termo “controle preditivo” (MPC) ou “controle preditivo baseado em modelo” (MBPC) se refere a uma classe de algoritmos de controle avançado que controla a resposta futura de uma planta através do uso de um modelo explícito do processo. Em cada instante de amostragem, o MPC soluciona on-line um problema LQ (linear quadrático) de horizonte finito, usando o estado atual da planta como estado inicial. O resultado da otimização gera uma sequência de controle ótimo, que é aplicada de acordo com a filosofia do controle de horizonte móvel (moving horizon control ou receding horizon control, RHC), fornecendo ao controlador as características de realimentação desejadas (Sotomayor, 2002).
O MPC não é uma estratégia de controle específica, mas é o nome dado a um conjunto de métodos de controle que foram desenvolvidos considerando algumas ideias comuns baseadas no conceito de predição. O modelo de predição é provavelmente o elemento mais importante dentro do controlador dado que ele deve ser capaz de representar adequadamente a dinâmica do processo para permitir o cálculo das predições de sua saída, ser intuitivo e ao mesmo tempo permitir uma análise teórica do sistema (Plucenio et al., 2007).
O MPC surgiu da necessidade prática de lidar com problemas multivariáveis, pois os controladores convencionais de malha simples foram incapazes de satisfazer os requerimentos crescentes do desempenho das indústrias. As idéias do MPC tiveram início a partir de 1960 (Garcia et al., 1989), porém, o real interesse neste campo começou a crescer a partir de 1980, depois da publicação dos primeiros trabalhos sobre o MPHC (model predictive heuristic control) e o DMC (dynamic matrix control), e particularmente, depois do QDMC (quadratic dynamic matrix control), que ficaram muito populares na indústria petroquímica e nas estações de força. Desde essa época, têm surgido novas variantes do MPC. Sem entrar em detalhes, alguns dos algoritmos MPC são: MAC (model algorithm control), IMC (internal model control), GPC (generalized predictive control), MOCCA (multivariable, optimal, 
constrained control algorithm), HIECON (hierarchical constraint control), PFC (predictive funtional control), OPC (optimum predictive control), PCT (predictive control technology), e o mais recente RMPCT (robust model predictive control technology). Apesar da enorme quantidade de abreviações introduzidas, não existem muitas diferenças entre estes algoritmos.
Tipicamente, estes algoritmos diferem no modelo do processo usado, tais como modelos de parâmetros de Markov (resposta ao impulso), resposta ao degrau, função de transferência, modelos polinomiais, modelos em espaço de estados, perturbações (constantes, retardos, ruído branco, etc) e adaptação (Sotomayor, 2002).
Desde 1990, a teoria de controle MPC tem evoluído substancialmente. Questões teóricas e práticas são tratadas em vários livros (Maciejowski, 2001), (Morari et al., 2002) e centenas de artigos. Um excelente ponto de partida é o artigo de Qin e Badgwell (1997), que apresenta uma breve história e comparações de algoritmos MPC, reportando mais de 20 aplicações industriais. Morari e Lee (1999) discutem o passado, o presente e o futuro do MPC, enquanto que Rawlings (2000) mostra uma visão geral desta tecnologia. Mayne et al.
(2000) e Löfberg (2001) tratam de otimização, estabilidade e robustez do MPC. No mais recente trabalho, Nicolaou (2001) trata dos últimos desenvolvimentos do MPC, e discute as implicações para o futuro da teoria e prática deste controle (Sotomayor, 2002).
Mesmo com o aparecimento de algoritmos MPC não-lineares (NMPC) (Henson, 1998), (Qin e Badgwell, 2000), a geração corrente de algoritmos MPC comercialmente disponíveis são baseados em modelos lineares (LMPC, ou simplesmente MPC). Mais ainda, atualmente, na literatura de pesquisa, o MPC é quase sempre formulado em espaço de estados (Morari e Lee, 1999). Isto tem simplificado, unificado e generalizado a teoria, incluindo fácil extensão a sistemas multivariáveis, fácil análise das propriedades em malha fechada e cálculo on-line (Sotomayor, 2002). As principais vantagens do LMPC estão vinculadas as facilidades de obtenção de modelos lineares, se comparados aos não lineares, e as menores dificuldades para se resolver os problemas de otimização associados. Porém, quando os processos têm dinâmica muito não linear ou quando a faixa de operação é variável, então necessariamente deverá ser tomado em conta o modelo não linear no projeto do controle, de forma que permita manter o desempenho desejado para o sistema em malha fechada (Plucenio et al., 2007).
A Figura 25 ilustra a implementação básica de todos os algoritmos de controle MPC.

No instante de tempo atual usualmente definido como o instante , o comportamento do processo ao longo de um horizonte de tempo é considerado. O intervalo de tempo é conhecido como horizonte de predição. Utilizando um modelo do processo, as respostas deste processo às mudanças nas variáveis manipuladas são previstas. As ações das variáveis manipuladas são selecionadas de tal forma que a resposta prevista apresenta determinadas características que sejam desejáveis. As ações de controle podem variar apenas dentro de um horizonte conhecido como horizonte de controle. De forma geral, minimiza-se um critério de desempenho desejado sujeito à dinâmica do modelo e às possíveis restrições nas variáveis de entrada/saída. Apenas a primeira ação de controle calculada é de fato implementada no processo real. As variáveis controladas da planta são então medidas. No próximo instante de amostragem, isto é, em , o mesmo problema de otimização é resolvido com a nova condição inicial obtida mediante informação tirada das medidas da (é desta maneira que se introduz retroalimentação ou feedback no planta em controlador) e com o horizonte movido adiante por um intervalo de amostragem (Qin e Badgwell, 2003).
A estrutura inerente a todos os algoritmos MPC é ilustrada na Figura 26, onde o controlador é também chamado de otimizador.

Figura 26 - Estrutura de um sistema de controle MPC 4.2 – LMPC Convencional - O Controlador QDMC Os primeiros controladores aplicados na indústria no início dos anos 70 utilizavam a estratégia MPC sem restrições também conhecido como DMC1, que usavam um modelo de convolução linear de resposta ao degrau e geração da sequência de controle por otimização analítica. Porém, com o aparecimento de restrições presentes nos processos que necessitavam a sua inclusão no desenvolvimento do controlador, foi necessária uma evolução do algoritmo de controle. A otimização neste caso passou a ser numérica e a solução do problema convexo DMC por meio de programação quadrática (QP) deu origem ao QDMC, proposto por Garcia e Morshedi (1986).
O QDMC usa as mesmas equações de predição do DMC, ou seja: (45) 1 A síntese do desenvolvimento do DMC pode ser encontrada no Apêndice A deste trabalho.

onde: - é o vetor de erros entre os valores previstos e o valor desejado.
- é o vetor de erros entre o valor desejado e os valores previstos se não houver nenhuma ação de controle futura (sistema em malha aberta).
- é a matriz dinâmica.
Considerando a seguinte função objetivo: (46) sendo que: - é a matriz de fatores de supressão que atenua as variações das ações de controle - é a matriz diagonal de ponderação onde os valores da diagonal principal são proporcionais à importância da variável controlada Substituindo a Equação (45) na Equação (46), temos: (47) Como o último termo do segundo membro, não depende da variável de interesse , a função objetivo do controlador pode ser escrita como: (49) onde: 
(50) (51) Ao problema definido na Equação (49) podemos incluir as restrições nas variáveis manipuladas e controladas: 1. Nos incrementos das manipuladas: ou seja: As condições 1a) e 1b) podem ser resumidas em: (52) 2. Nos valores das manipuladas: Como: ou 
Portanto: Daí as condições 2a) e 2b) podem ser resumidas em: (53) Resumindo, o problema de otimização que o QDMC resolve tem a função objetivo definida na Equação (49) e as restrições representadas pelas Equações (52) e (53). É fácil observar que a função objetivo é quadrática em e as restrições são todas lineares. Esse tipo de problema é clássico dentro da área otimização e é conhecido como o problema de programação quadrática (PQ). Do resultado da otimização, só a primeira ação de controle do vetor é usado na planta.
4.3 – NMPC Convencional Embora os processos industriais sejam em geral não-lineares, a maior parte das aplicações MPC são baseadas no uso de modelos lineares. Existem duas principais razões para isso: por um lado, a identificação de um modelo linear baseado nos dados do processo é relativamente fácil e, por outro lado, modelos lineares produzem bons resultados quando a planta opera na vizinhança do ponto de operação. Nas indústrias de processos, onde o LMPC é amplamente difundido, o objetivo é manter o processo próximo ao estado estacionário ao invés de mudar frequentemente de um ponto de operação para outro, e, por isso, um modelo linear preciso é suficiente. Além disso, o uso de um modelo linear em conjunto com função objetivo quadrática leva a um problema QP que converge e cuja solução é implementada em diversos produtos comerciais disponíveis. A existência de algoritmos que garantem uma solução convergente em um período mais curto que o período de amostragem é crucial em processos com grande número de variáveis (Camacho et al., 2005).

Entretanto, a resposta dinâmica resultante de um controlador linear é inaceitável quando aplicada ao um processo não-linear com vários graus de severidade. Embora em muitas situações o processo possa estar operando na vizinhança do estado estacionário, e com isso a representação linear seria adequada, existem diversas situações onde isso não ocorre. Por um lado, há processos onde a não linearidade é tão severa (até mesmo na proximidade do estado estacionário), e tão crucial para a estabilidade em malha fechada, que um modelo linear não é suficiente. Por outro lado, há alguns processos que experimentam transições contínuas (partidas, desligamentos, etc.) e passam um bom tempo longe da região de operação no estado estacionário, ou até mesmo processos que nunca estão em operação no estado estacionário, como no caso dos fornos, onde toda a operação é levada no modo transiente. Para esses processos uma lei de controle linear não será muito eficiente, sendo os controladores não-lineares essenciais para melhorar a performance ou estabilizar a operação (Camacho et al., 2005).
Do ponto de vista conceitual o NMPC não apresenta dificuldades. Considerando a mesma função objetivo que no caso linear e um modelo não-linear para o cálculo das predições, o objetivo consiste novamente em encontrar o controle que minimize a função objetivo num algoritmo de horizonte móvel. Já, do ponto de vista prático, são várias as dificuldades encontradas neste problema (se comparado ao caso linear): (a) a determinação do modelo do processo, quando deve ser obtido por identificação, (b) a obtenção do sinal de controle requer, em geral, a solução de um problema otimização não-convexo, e (c) a análise de estabilidade e robustez da solução. Por estes motivos o NMPC é um campo aberto para pesquisas tanto na área de determinação de modelos como nos procedimentos e algoritmos de otimização para o cálculo do controle (Plucenio et al., 2007).
Existe uma grande quantidade de técnicas MPC que direta ou indiretamente tratam sistemas não-lineares (Findeisen & Allgöwer, 2002). Uma possível classificação destas técnicas as divide em 3 grupos: (a) as que utilizam diretamente um modelo não-linear genérico e um algoritmo de otimização não-linear de propósito geral; (b) as que utilizam modelos não-lineares particulares (como séries de Volterra ou modelos de Hammerstein) e métodos de otimização específicos para o modelo escolhido; (c) as que utilizam um ou vários modelos lineares para representar o processo e algoritmos de otimização lineares.

Evidentemente as vantagens e desvantagens de uma ou outra alternativa estão diretamente relacionadas ao compromisso desempenho-custo computacional (Plucenio et al., 2007).
Definido o modelo não linear que será utilizado no controlador, é hora de montar o algoritmo de controle. No presente trabalho, adotou-se a técnica do grupo (a), onde é utilizado um modelo não-linear geral do processo e um algoritmo de otimização de propósito geral.
Uma versão simplificada deste algoritmo NMPC foi desenvolvida por Qin & Badgwell (2000), a qual é apresentada a seguir.
Levando em consideração que a planta a ser controlada pode ser descrita pelo modelo em espaço de estados, não-linear e discreto no tempo definido pelas seguintes equações: (54) (55) onde é um vetor de entradas do processo ou variáveis manipuladas, é um vetor de saídas do processo ou variáveis controladas, é o vetor de variáveis de estado, é o vetor de variáveis de perturbações medidas, é um vetor de perturbações não medidas ou ruído, e é o vetor de ruído.
Para resolver o problema de controle é necessário resolver computacionalmente uma sequência de entradas que levarão o processo do seu estado atual para o estado desejado . Perturbações feedfoward são removidas incorporando seus efeitos ao modelo .
Perturbações feedback são tipicamente manuseadas assumindo que uma perturbação em degrau foi colocado na saída e ela permanecerá constante por todo o tempo futuro. Para alcançar isso, um termo que compara a saída prevista atual com a atual medida da saída é dado por: (56) sendo que o termo será utilizado para as predições subseqüentes, da forma: (57) 
O algoritmo de controle aqui descrito minimiza a seguinte função: (58) sujeita às seguintes restrições: ( ) (59) (60) (61) (62) Sendo o horizonte de predição e o horizonte de controle, o comportamento das futuras saídas é controlado penalizando os desvios do estado estacionário desejado , ou seja, ela verifica o valor atual e o valor desejado e calcula o erro representado por: (63) O termo corresponde às variações na entrada, representa a entrada num determinado instante , sendo que nesse caso, varia de acordo com o horizonte de controle . As matrizes e são as matrizes de peso, elas definem os ganhos que serão atribuídos a cada variável controlada e manipulada, ou seja, é possível atribuir uma “importância” a cada saída ou entrada e dessa forma ajustar o controlador parar funcionar de maneira mais próxima à desejada.
Do ponto de vista prático a principal vantagem desse método reside no uso de um modelo não linear, que permite em geral, obter predições muito próximas às saídas reais da planta. Como desvantagens devem citar-se as questões iterativas dos métodos de otimização, a incerteza no tempo que levam para entregar uma resposta, a convergência, as soluções em mínimos locais, etc. que fazem com que sua utilização para controle em tempo real seja ainda pouco difundida (Plucenio et al., 2007).

Capítulo 5 Controle Preditivo do Processo de Perfuração 5.1 – Introdução Neste capítulo são apresentados os resultados das simulações da aplicação do sistema de controle avançado no processo de perfuração, cujo layout em ambiente MatLab/Simulink® é mostrado na Figura 27. Dois sistemas de controle avançado são implementados: um baseado no LMPC e outro no NMPC, apresentados no capítulo anterior. O objetivo é analisar o comportamento de ambos os sistemas, bem como tecer comparações acerca de seus desempenhos quando submetidos a diversas variações nas condições de operação. Seguindo a estratégia proposta por Breyholtz et al. (2009), aqui a BHP ( ) é controlada pela ( ). A vazão de influxo do reservatório ( ) e a vazão da bomba de pressão reversa ( são consideradas como perturbações.
Figura 27 – Controle MPC da coluna de perfuração 
5.1 – Controle LMPC do Processo de Perfuração A implementação do LMPC usa um modelo linear do processo, em forma de matriz de funções de transferência, como mostrado na Tabela 2, para predição e os parâmetros de sintonia listados na Tabela 3. As funções de transferência foram obtidas pela aplicação do teste de resposta ao degrau no sistema em malha aberta. Os parâmetros de sintonia do controlador foram definidos após extensivas simulações, usando algumas regras heurísticas da literatura e o procedimento da tentativa e erro.
Tabela 2 - Funções de transferência do modelo linear A resposta do processo a mudanças no ponto de operação é mostrada na Figura 28. Na primeira mudança de setpoint, e após uma oscilação moderada, o sistema demora para estabilizar aproximadamente 65 s. Já na segunda e terceira mudança de setpoint, o sistema estabiliza em 25s e 15s, respectivamente, com um pequeno sobressinal na segunda mudança.

A Figura 29 mostra a coordenação das variáveis manipuladas para atingir o ponto de operação desejado.
Figura 28 – Resposta da pressão de fundo com LMPC a variações no setpoint Figura 29 - Comportamento das variáveis manipuladas com LMPC a variações no setpoint exibindo um offset com respeito ao setpoint. Esta falta de controle pode ser explicada pela saturação das duas variáveis manipuladas, conforme mostrado na Figura 31.

Figura 30 - Resposta da pressão de fundo com LMPC a variação na vazão de influxo do reservatório Figura 31 - Comportamento das variáveis manipuladas com LMPC a variação na vazão de influxo do reservatório Efeito da variação da vazão da bomba de pressão reversa é mostrado na Figura 32. Esta perturbação acontece no tempo t = 100s, quando a vazão muda de e para , provocando um pico positivo considerável no valor da pressão que estabiliza no ponto de operação nominal depois de aproximadamente 100 s. As variações das variáveis manipuladas para compensar a perturbação são mostradas na Figura 33, exigindo um aumento da abertura da válvula choke e a diminuição quase total da vazão de lama de perfuração.

Figura 32 - Resposta da pressão de fundo com LMPC a variação na vazão da bomba de pressão reversa Figura 33 - Comportamento das variáveis manipuladas com LMPC a variação na vazão da bomba de pressão reversa Finalmente, verifica-se a resposta do processo a uma perda de efetividade do controle, provocada por um travamento da válvula choke em 25% da sua abertura, ocorrendo no tempo t = 100 s. Este aumento repentino e sustentado da abertura da válvula choke produz o decaimento da pressão, como mostrado na Figura 34. O controlador consegue acomodar esta falha em aproximadamente 30 s, aumentando a vazão de lama conforme visto na Figura 35.

Figura 34 - Resposta da pressão de fundo com LMPC a perda de controle da válvula choke Figura 35 - Comportamento das variáveis manipuladas com LMPC a perda de controle da válvula choke 5.3 – Controle NMPC do Processo de Perfuração A implementação do NMPC usa o mesmo modelo não-linear que descreve o processo para predição da saída e os parâmetros de sintonia listados na Tabela 4. De maneira semelhante ao caso linear, os parâmetros de sintonia do controlador foram definidos após extensivas simulações, usando algumas regras heurísticas da literatura e o procedimento da tentativa e erro. Para efeitos de comparação de desempenho do NMPC com o LMPC, foram praticadas as mesmas variações nas condições de operação que no caso linear, apresentadas na seção 5.2.

Tabela 4 - Parâmetros de sintonia do controlador NMPC A resposta do processo a uma sequência de mudanças no setpoint é mostrada na Figura 36. Na primeira mudança de setpoint, o sistema atinge, sem oscilações, o novo ponto de operação em 25s e aí permanece. Na segunda mudança de setpoint o acompanhamento é quase que imediato, estabilizando em 3s, e na terceira mudança, o sistema alcança o novo ponto de operação em aproximadamente 13s. O comportamento das variáveis manipuladas é mostrado na Figura 37. Há uma oscilação brusca em , principalmente na segunda variação de setpoint, mas em geral as respostas das variáveis manipuladas foram rápidas, o que permitiu que o processo alcance rapidamente os novos pontos de operação sem oscilações.

Figura 37 - Comportamento das variáveis manipuladas com NMPC a variações no setpoint A Figura 38 apresenta o perfil de resposta da BHP a uma variação no influxo do reservatório. Diferente do caso linear, esta perturbação provoca uma diminuição acentuada da pressão de fundo, mas que se recupera rapidamente, voltando ao setpoint em aproximadamente 10s. A Figura 39 mostra o comportamento das variáveis manipuladas para contornar os efeitos desta perturbação.

Figura 39 - Comportamento das variáveis manipuladas com NMPC a variação na vazão de influxo do reservatório Ação regulatória do sistema a uma variação da vazão da bomba de pressão reversa é mostrada na Figura 40. Como pode ser visualizado, o controle compensa perfeitamente a perturbação, não mostrando nenhuma alteração na BHP. Para conseguir este objetivo, o controlador aumenta a abertura da válvula choke, mantendo constante a vazão de lama conforme ilustrado na Figura 41.
Figura 40 - Resposta da pressão de fundo com NMPC a variação na vazão da bomba de pressão reversa 
Figura 41 - Comportamento das variáveis manipuladas com NMPC a variação na vazão da bomba de pressão reversa Como último caso de avaliação, consideramos a válvula choke presa em 25% de abertura. Da Figura 42, pode-se observar que a falha provoca uma queda repentina da pressão, porém de magnitude menor que se comparada ao caso linear, que é acomodada em aproximadamente 13s. O controlar compensa a perda da efetividade de controle da válvula choke com o aumento rápido da vazão de lama de perfuração, como mostrada na Figura 43.
Figura 42 - Resposta da pressão de fundo com NMPC a perda de controle da válvula choke 
Figura 43 - Comportamento das variáveis manipuladas com NMPC a perda de controle da válvula choke 5.4 – Discussão de Resultados Foram realizadas simulações equivalentes em ambos os controladores, a primeira diz respeito a variação do setpoint. Nesse caso é possível observar a rapidez com que o controlador LMPC responde se comparado ao NMPC. Um exemplo disso é que para a primeira entrada de um degrau positivo no sistema o LMPC demora apenas 25 segundos para efetivamente controlar o processo já o NMPC demora cerca de 65 segundos.
Mediante a ocorrência de um aumento na vazão do influxo do reservatório, o NMPC sofre uma alteração mais brusca em sua saída, porém rapidamente compensada, levando a pressão de fundo novamente ao valor desejado. O mesmo não ocorre no LMPC. Nesse caso a variação da saída é um pouco mais branda, mas o controlador após a ocorrência dessa perturbação não consegue levar a saída ao valor desejado.
Quando alterada a vazão da bomba de pressão reversa novamente o NMPC possui uma melhor resposta, pois mesmo com a inserção dessa perturbação a saída não foi afetada, graças à rápida ação das variáveis manipuladas. Já a saída do LMPC sofreu uma modificação que resultou em uma demora do sistema a controlar a pressão de fundo novamente.
Ao simular um problema na válvula choke, nesse caso seu travamento em um determinado valor, o tempo de resposta de ambos os controladores foram bem próximos, 
ficando a diferença entre eles a variação que ocorreu na saída do controlador. O NMPC teve uma variação ligeiramente menor que o LMPC.
Ao serem realizadas as devidas comparações de desempenho dos sistemas de controle avançado, foi possível notar a superioridade do NMPC quando comparado ao LMPC. Nas simulações realizadas, o controlador NMPC obteve um comportamento mais suave da saída e mesmo nos momentos em que houve a presença de variações e perturbações, as variáveis manipuladas, nesse caso a bomba de entrada de lama e a válvula choke, não apresentaram oscilações que pudessem prejudicar o desempenho do sistema ao longo de sua utilização.
O fato de algoritmo NMPC responder de forma rápida resulta inclusive em uma diferença entre as repostas quando é inserida no sistema a ocorrência de um influxo sob a forma da variável . De acordo com o modelo (Figuras 19 e 20) quando o valor do influxo aumenta, a pressão de fundo deveria aumentar. Esse evento pode ser observado nas Figuras 30 e 31 que representam essa variação no controlador linear (LMPC). Porém, no controlador não linear (NMPC), as Figuras 38 e 39 mostram que isso não ocorre.
Esse fenômeno se deve ao fato de que como o esse controlador possui duas entradas e uma saída, e seu grau de liberdade é positivo, podem, nesse sistema, ocorrer variações quanto ao comportamento das entradas. E como nesse caso, o controlador responde de maneira muito rápida ele gera distúrbios nos comportamentos das variáveis de entrada e consequentemente retorna a resposta mostrada na Figura 38.

Capítulo 6 Conclusões e Recomendações 6.1 – Conclusões É de extrema importância durante o processo de perfuração ter controle sobre a pressão de fundo do poço a ser perfurado, tanto para evitar acidentes que possam vir a causar perdas de vidas humanas, ambientais e financeiras quanto para minimizar o desperdício da lama de perfuração, que é quem encarece o processo como um todo, e diminuir o tempo em que a sonda passa não operante. Esse trabalho teve como objetivo estudar algumas técnicas de controle avançado aplicadas a perfuração de poços de petróleo.
No desenvolvimento e implementação do modelo da coluna de perfuração, dois modelos foram estudados, porém vista a necessidade de um fluido monofásico imposta pelo MPD, o modelo de Nygaard (2006) foi descartado e foi utilizado como base das implementações o modelo de Stamnes (2007). As simulações realizadas em malha aberta condizem com o esperado de um sistema real.
No tocante as técnicas de controle, dois controladores foram implementados. O primeiro foi baseado em um modelo linearizado da coluna de perfuração resultando em um algoritmo de controle LMPC. Já o segundo controlador, um NMPC, foi obtido a partir de um modelo não linear do processo. Para efeitos de comparação, foram realizadas as mesmas simulações em ambos os controladores. Ao longo do trabalho foi possível visualizar a superioridade do algoritmo NMPC, algoritmo esse que resultou em respostas mais rápidas e um controle mais suave com poucas penalizações aos componentes manipulados do sistema, o que, para o caso do processo de perfuração, é algo bastante útil visto que uma demora em controlar a pressão pode resultar em acidentes que possam a levar a perdas financeiras, ecológicas e até humanas.
A utilização de algoritmos LMPC é mais difundida no mercado, mas isso não significa que algoritmos NMPC sofrem de deméritos, sua aplicação é mais escassa devido à dificuldade 
intrínseca a um processo não linear. Porém como visto nesse trabalho é possível implementar um controlador NMPC de maneira relativamente simples e cujos resultados são satisfatórios e, como nesse caso, superiores àqueles obtidos com a utilização de algoritmos LMPC.
6.2 – Trabalho Futuros A vertente dos controladores NMPC vem ganhando espaço diante as publicações acadêmicas e científicas. Os algoritmos de controle não-linear são ferramentas poderosas na manutenção e controle de processos industriais dos mais variados graus de complexidade.
Com isso a continuidade do estudo desse tipo de controle é válida principalmente quando aplicada a setores cuja exploração tende a crescer como no caso da indústria de petróleo e mais especificamente no processo de perfuração de poços.
Como trabalho futuros, recomenda-se usar modelos mais rigorosos de processos de perfuração, visto que os contidos nesse trabalho são modelos de ordem reduzida de parâmetros concentrados. Outra sugestão é a avaliação dos controladores sujeita a variações nos parâmetros do processo, como densidade do lama de perfuração, ou que levem em consideração outras variáveis manipuladas, como a bomba de pressão reversa, ou outras variáveis controladas como a ROP. Além disso, os controladores avançados LMPC e NMPC aqui testados, podem ser implementados como sendo parte de uma estrutura de controle hierárquica, conforme proposto em Breyholtz (2010a). Estruturas de controle hierárquico são comumente adotadas para controlar plantas completas, não só relacionadas à indústria do petróleo, como também em setores da indústria em geral, cujos processos são dotadas de uma certa complexidade.

