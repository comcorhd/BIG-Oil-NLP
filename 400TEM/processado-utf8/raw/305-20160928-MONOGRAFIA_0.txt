

INTRODUÇÃO 1.1 SIMULAÇÃO DE RESERVATÓRIOS Atribui-se o desígnio reservatório de petróleo a um meio poroso que contém hidrocarbonetos. Tendo em vista a concentração de investimentos no setor petrolífero e os grandes efeitos da produção de petróleo na economia global, ascendeu a necessidade de prever e otimizar a performance dos reservatórios. A decisão de implantar um complexo de explotação de petróleo envolve custos elevadíssimos e requer, por conseguinte, uma fundamentação sólida de que será vantajosa. Isso envolve um estudo prévio de viabilidade econômica e operacional.
A análise experimental completa do reservatório não é viável, porquanto ocasionaria além de altos investimentos, muitas diﬁculdades. Nesse contexto, a simulação de reservatórios desponta como uma potente ferramenta a ﬁm de prognosticar a performance do reservatório e encontrar meios para otimizar a recuperação de certos hidrocarbonetos sob diferentes condições operacionais. Essa área envolve física, matemática, engenharia de reservatórios e programação computacional.
Ainda, a simulação de reservatórios é complexa devido, sobretudo, a dois fatores. O primeiro, é a falta de contato direto com o fenômeno físico o qual se deseja simular. Sendo assim, há diﬁculdades no processo de caracterização física e, por conseguinte, da seleção de modelos matemáticos adequados que o possam descrever com um grau satisfatório de acurácia. O segundo fator consiste na própria complexidade atrelada ao fenômeno físico, pois que envolve minúcias por vezes nem compreendidas ou extremamente enredado em outros fenômenos, de forma que a dependência mútua das variáveis acarreta uma simulação numérica complicada e custosa.
A ﬁm de progredir na descrição dos fenômenos, a área de simulação de reservatórios tem caráter dinâmico, i.e., trata-se de uma área constantemente aprimorada e ampliada.
Dada a quantidade de novos modelos propostos destinados à simulação de efeitos progressivamente mais complexos, faz-se interessante dominar, primeiramente, aqueles mais básicos, os quais levam em conta os efeitos mais signiﬁcativos ao fenômeno físico. Aziz & Settari (1979) sugerem que, antes de partir à implementação de qualquer modelo mais soﬁsticado, é fundamental adquirir a compreensão do modelo bifásico. O presente trabalho almeja explorar esse modelo a ﬁm de analisar o desempenho de três esquemas de solução 
distintos – IMPES, sequencial e totalmente implícito. O conhecimento do modelo mais adequado ao objetivo da simulação numérica é imprescindível à correta interpretação dos resultados obtidos, de forma que essa comparação se faz valiosa quanto à escolha do método a ser utilizado.
1.1.1 ETAPAS DA SIMULAÇÃO DE RESERVATÓRIOS O processo de simulação de reservatórios envolve quatro etapas de modelagem fortemente atreladas, as quais estão esquematizadas na ﬁgura 1.1. Primeiramente, há de se desenvolver um modelo físico para o problema que incorpore os processos mais relevantes à caracterização do fenômeno. A seguir, o problema é modelado matematicamente através de um conjunto de equações diferenciais parciais acopladas e dependentes do tempo. É, então, desenvolvido um método numérico através do qual pode-se implementar computacionalmente a resolução do sistema de equações associados ao fenômeno físico (Chen, 1962).
Figura 1.1: Etapas da simulação de reservatórios 1.1.2 O FENÔMENO FÍSICO O fenômeno físico de interesse na simulação de reservatórios consiste no escoamento multifásico multicomponentes em um meio poroso. Usualmente, coexistem três fases: água, óleo e gás (da Cunha, 1996). Além disso, essas fases podem conter mais de um componente e estão impregnadas em micro poros rochosos como o arenito (Ewing, 1983).
Reservatórios de petróleo são, de fato, rochas-reservatório e, portanto, são considerados como um meio poroso no qual o escoamento pode ser modelado a partir da equações 
de Darcy (Bejan, 2004). O petróleo é produzido na rocha geradora e migra, sobretudo por capilaridade e forças de empuxo, para a rocha reservatório. Não se desloca para as camadas mais próximas à superfície em virtude da presença de uma rocha capeadora, a qual o envolve superiormente e apresenta baixa permeabilidade. Esses tipos de rochas estão ilustrados, esquematicamente, na ﬁgura 1.2.
Figura 1.2: Esquema ilustrativo de um reservatório sujeito à recuperação secundária Fonte: do autor Na maioria das vezes, o petróleo só pode ser retirado do meio poroso através da imposição de elevados gradientes de pressão oriundos de mecanismos físicos denominados de processos de recuperação(Cordazzo, 2006). Esses processos são divididos em três categorias, a saber (Dake, 2001): • Recuperação primária: dá-se a perfuração dos poços e a produção sem nenhuma tentativa de elevar a produtividade por meio de injeção de ﬂuidos; • Recuperação secundária: adota-se uma estratégia de injeção de água ou gás no intuito de manter a pressão, parcialmente ou totalmente, e acelerar o deslocamento do óleo em direção aos poços produtores. A ﬁgura 1.2 ilustra esse processo; • Recuperação avançada (EOR – Enhanced Oil Recovery): utiliza técnicas mais soﬁsticadas a ﬁm de alterar as propriedades originais do óleo. As três principais variantes desse processo envolvem fenomenos químicos, de alteração de miscibilidade e térmicos.

1.2 O MODELO BIFÁSICO IMISCÍVEL A simulação do processo de recuperação de hidrocarbonetos em reservatórios de petróleo requer a modelagem numérica de escoamentos multifásicos de múltiplos componentes. O modelo matemático pode levar em conta processos de transferência de calor e massa por advecção e difusão e, por vezes, reações químicas.
Tendo em vista a complexidade dos fenômenos físicos associados ao processo de extração, os modelos devem ser simpliﬁcados a ﬁm de que sua solução seja viável. Entretanto, a simpliﬁcação deve ser realizada de forma que os resultados obtidos sejam aceitáveis, i.e., as hipóteses devem prover aproximações consistentes.
O modelo utilizado no presente trabalho se destina à simulação de processos de deslocamento de duas fases ﬂuidas imiscíveis. Um exemplo característico desse processo é a recuperação secundária de petróleo de reservatórios mediante a injeção de água. Trata-se da modelagem mais simples de escoamentos multifásicos. Em comparação ao escoamento monofásico, requer, pois, técnicas mais avançadas, dada a necessidade de lidar com um sistema acoplado de equações não lineares (Aziz, 1993).
Ademais, usualmente novas técnicas numéricas para modelos mais complexos são implementadas e avaliadas, inicialmente, com o modelo bifásico, o qual apresenta diﬁculdades semelhantes em relação às questões geométricas (Hurtado, 2005).
1.3 O MÉTODO DOS VOLUMES FINITOS BASEADO EM ELEMENTOS Os primeiros simuladores utilizados na área de óleo e gás empregavam, inicialmente, apenas malhas cartesianas ortogonais. As diﬁculdades associadas à geometria complexa dos reservatórios motivaram a introdução de malhas cartesianas não-ortogonais, conhecidas como malhas corner-point. Esse tipo de malha estruturada ainda é largamente aplicado em simuladores comerciais.
O Método dos Volumes Finitos baseado em Elementos (EbFVM) emprega malhas não estruturadas para uma representação ainda mais ﬂexível e acurada do domínio. Isto é, permite solucionar o problema em geometrias mais complexas, de forma que representa o problema de forma mais ﬁdedigna. Trata-se de um método versátil e consistente, que 
satisfaz a característica fundamental dos Métodos dos Volumes Finitos – conservação da propriedade em níveis elementares (Maliska, 2004).
O EbFVM surgiu, inicialmente, para a solução das equações de Navier-Stokes em Baliga & Patankar (1983). Sua utilização na área de simulação de reservatórios de petróleo ocorreu posteriormente, muito embora ainda seja pouco utilizado em simuladores comerciais. Uma descrição detalhada e completa sobre o EbFVM pode ser encontrada em Hurtado (2011).
1.4 REVISÃO BIBLIOGRÁFICA As equações provenientes da modelagem matemática de escoamentos multifásicos compõem um sistema não linear acoplado. Dentre as metodologias utilizadas para resolver esse sistema, destacam-se os métodos IMPES e totalmente implícito (Chen, 1962). A seguir, far-se-á uma breve revisão bibliográﬁca de ambos os métodos.
1.4.1 MÉTODO IMPES O método IMPES (IMplicit Pressure Explicit Saturation) foi originalmente desenvolvido por Sheldon et al. (1959) e Stone & Garder (1961). A ideia fundamental dessa formulação clássica é dividir o sistema de equações acoplado em sistemas de equações distintos para pressão e saturação, os quais são resolvidos de forma implícita e explícita, respectivamente.
O cálculo explícito da saturação acarreta maior simplicidade quanto à implementação do método e menor custo computacional. Entretanto, sua estabilidade está atrelada à utilização de pequenos passos de tempo. (Chen, 1962) e Coats (1968) discutem a estabilidade dessa formulação.
Desenvolvimentos posteriores foram realizadas em Coats (1982), Watts (1985) e Young & Stephenson (1983) e outras metodologias baseadas no IMPES foram propostas em Buchwalter & Miller (1993),Coats et al. (1995) e Cao & Aziz (2002). Posteriormente, Chen & Li (2004) e Hurtado (2005) discutiram um IMPES modiﬁcado em que diferentes passos de tempo para pressão e saturação foram aplicados.

1.4.2 MÉTODO SEQUENCIAL A ﬁm de melhorar a estabilidade da formulação IMPES, MacDonald & Coats (1970) propuseram uma modiﬁcação na metodologia IMPES na qual após resolver a pressão implicitamente e a saturação explciitamente, os coeﬁcientes da matriz correspondente ao sistema linear da pressão são atualizados e os campos de pressão e saturação são calculados até que seus valores se alterem menos que uma tolerância especiﬁcada.
1.4.3 MÉTODO TOTALMENTE IMPLÍCITO O método totalmente implícito ou FIM (Fully Implicit Method) resolve pressão e saturação implicitamente e simultaneamente, de forma que ascende a necessidade de resolver um sistema não linear de equações. A formulação é incondicionalmente estável e apresenta boa solução para diversos problemas numéricos, conforme descrito em Aziz & Settari (1979), Farnstrom & Ertekin (1987), Peaceman (1977) e Watts (1985).
1.5 OBJETIVOS E CONTRIBUIÇÕES Desde sua criação 1981, o SINMEC – Laboratório de Simulação Numérica em Mecânica dos Fluidos e Transferência de Calor, do Departamento de Engenharia Mecânica da Universidade Federal de Santa Catarina – tem como objetivo o desenvolvimento de metodologias numéricas utilizando, sobretudo, o método dos volumes ﬁnitos para resolver problemas que envolvem escoamento de ﬂuidos. A principal linha de pesquisa do laboratório consiste no desenvolvimento de algoritmos empregando malhas não estruturadas com o método dos volumes ﬁnitos baseado em elementos (EbFVM). Uma das aplicações de engenharia precípuas nessa área de trabalho é a simulação numérica de escoamentos em reservatórios de petróleo.
Entre 2007 e 2010, o laboratório executou o projeto SIGER I, do qual resultou a biblioteca EFVLib, dedicada ao gerenciamento da topologia e geometria de malhas não estruturadas para a discretização de equações diferenciais parciais pelo método de volumes ﬁnitos baseado em elementos.
A principal contribuição deste trabalho consiste na implementação de um simulador bifásico totalmente implícito na biblioteca EFVLib, a qual, anteriormente, não dispunha 
de um solver não linear. Almeja-se assim, não apenas introduzir uma nova metologia na biblioteca, mas também analisar seu desempenho na simulação de reservatórios de petróleo. Ainda, tendo em vista o elevado custo computacional atrelado ao método totalmente implícito e ao emprego de malhas não-estruturadas, deseja-se implementar um esquema de passo de tempo adaptativo. Essa implementação tem como intuito veriﬁcar tanto a sensibilidade da solução numérica quanto a melhoria de desempenho.
Os objetivos deste trabalho são: 1. Incorporar à EFVlib um método para resolver um sistema não-linear de equações; 2. Desenvolver um simulador bifásico imiscível, isotérmico e incompressível para malhas não-estruturadas aplicando o método dos volumes ﬁnitos baseado em elementos; 3. Implementar um esquema de passo de tempo adaptativo e veriﬁcar sua inﬂuência nas soluções numéricas; 4. Comparar o simulador totalmente implícito implementado aos métodos IMPES e se-quenciala; 1.6 ORGANIZAÇÃO DO TRABALHO No capítulo 2 é apresentada a formulação matemática do problema. São expostos e descritos os conceitos fundamentais à caracterização do modelo, o conjunto de equações diferenciais que modelam o fenômeno físico e o tratamento das propriedades físicas, dos ﬂuidos, da rocha e da interação entre ﬂuidos e rocha.
No capítulo 3 são realizadas as aproximações numéricas que permitem a obtenção da solução do problema por meio de rotinas computacionais. São apresentados o método dos volumes ﬁnitos baseado em elementos, as discretizações das equações conservativas e as formulações adotadas para resolver essas equações.
A seguir, no capítulo 4 tem-se a descrição da etapa de implementação computacional do modelo matemático e numérico descrito até então. É descrita a maneira com a qual o código em C ++ é implementado a ﬁm de resolver o problema proposto satisfazendo to-aO IMPES disponível na biblioteca – implementado em (Grein, 2015) – foi modiﬁcado para se ajustar às comparações realizadas neste trabalho.

dos os requerimentos já elucidados. Expõe-se também uma visão geral do código, a qual facilita o entendimento do tratamento de dados e de suas relações hierárquicas.
O capítulo 5 se destina à validação do simulador implementado e à apresentação dos resultados obtidos por meio das formulações propostas.
Por ﬁm, no capítulo 6 estão dispostos um sumário, as conclusões e algumas sugestões para trabalhos futuros.

2 MODELO MATEMÁTICO A obtenção da solução numérica de qualquer problema físico requer sua prévia modelagem matemática(Maliska, 2004). Nessa etapa, aspectos físicos e matemáticos são integrados a ﬁm de que um fenômeno natural possa ser descrito com um certo grau de acurácia, por meio de equações diferenciais. Ressalta-se a importâncias das hipóteses realizadas ao longo da modelagem, pois que instituem o grau de proximidade entre a descrição e o fenômeno em si.
Ao longo deste capítulo, apresentar-se-á a modelagem matemática do deslocamento bifásico imiscível. Considerando-se, sobretudo, o escoamento no reservatório, será apresentado o conjunto de equações diferenciais que modelam o problema e as variáveis envolvidas em sua descrição.
Para isso, será apresentada a lei de Darcy na forma de potenciais. A seguir, será deduzida a equação de conservação da massa de um componente genérico em escoamento multifásico. Essa equação será, então, adequada às hipóteses e simpliﬁcações do modelo implementado. Por ﬁm, descrever-se-á o tratamento das propriedades físicas do ﬂuido e da rocha que apresentam dependência em relação às variáveis primárias do problema.
2.1 A LEI DE DARCY NA FORMA DE POTENCIAIS Na mecânica dos ﬂuidos em meios porosos, as equações de Navier-Stokes dão lugar às observações experimentais expressas matematicamente por meio da Lei de Darcy (Bejan, 2004). Essas observações foram relatadas em Darcy (1856), sugerindo que a velocidade média de um ﬂuido newtoniano escoando em um dado meio poroso sob regime laminar é proporcional ao gradiente de pressão e inversamente proporcional à viscosidade do ﬂuido.
Assumindo-se que o escoamento da fase p no reservatório se dê na presença do campo gravitacional e em regime de Stokes (R e ≤ 1), i.e., em baixas velocidades, de forma que as forças viscosas sejam dominantes, a Lei de Darcy para a determinação do campo de velocidades up da fase p é dada por (2.1) em que K é o tensor permeabilidade absoluta do meio e µp , P p e k p r são, respectivamente 
a viscosidade, a pressão e a permeabilidade relativa associadas à fase p (Kaviany, 1995).
Para a formulação numérica, a qual será detalhada posteriormente, faz-se mais conveniente o emprego da Lei de Darcy na forma de potenciais. Para isso, deﬁne-se a função potencial da fase p como (2.2) em que G é a função potencial gravitacional, dada por G = x· g, (2.3) sendo x o vetor posição e g, o vetor aceleração da gravidade. Dado isso, o gradiente do potencial da fase p é (2.4) Substituindo a equação (2.4) na equação (2.1), tem-se a Lei de Darcy modiﬁcada, escrita na forma de potenciais: (2.5) 2.2 EQUAÇÕES FUNDAMENTAIS DO MODELO A ﬁgura 2.1 representa um volume de controle Ω, de volume V , ﬁxo no espaço, extraído de um meio poroso. O vetor área é representado por dS e a fronteira do volume, por ∂ Ω.
Figura 2.1: Volume de controle em um meio poroso Uma vez que o modelo é imiscível, o balanço de massa de um componente coincide com o balanço de massa da fase associada a esse componente. Sendo assim, pode-se efetuar o balanço de massa de uma fase p do escoamento multifásico através desse volume 
de controle, o qual é dado por (2.6) em que F p é a taxa de geração ou extinção de massa da fase p por unidade de volume.
Tendo em vista que a porosidade φ é a razão entre o volume poroso e o volume total do meio e a saturação da fase p é a razão entre o volume ocupado pela fase p e volume poroso do meio, isto é, (2.7) (2.8) sível, tem-se (2.9) em que (2.10) Uma vez que o volume de controle é ﬁxo no espaço e o escoamento é incompressível, pode-se reescrever a equação na forma (2.11) Já que a equação (2.11) deve ser válida para qualquer volume V , deve-se ter (2.12) A velocidade da fase p pode ser substituída pela Lei de Darcy na forma de potenciais dada na equação (2.5). A equação da conservação da massa para a fase p é, então: (2.13) em que λp é a mobilidade da fase p , dada por (2.14) Assim, as equações de conservação da massa das fase água e óleo são dadas, respectiva- 
mente, por (2.15) (2.16) O modelo bifásico é completado pela equação de restrição volumétrica (2.17) Ainda, assumindo-se que os efeitos de pressão capilar são poucos signiﬁcativos, considera-se uma única pressão P . Utilizando a equação (2.18) a pressão pode ser obtida por meio de um pós processamento tendo em vista que assumiu-se escoamento incompressível. Tem-se, assim, três equações – (2.15), (2.16) e (2.17) – e três incógnitas – S w , S o e P .
2.3 PROPRIEDADES FÍSICAS Nos estudos de um reservatório de petróleo, é de caráter essencial o conhecimento das propriedades básicas da rocha e dos ﬂuidos nela contidos. São essas propriedades que determinam as quantidades dos ﬂuidos existentes no meio poroso, sua distribuição, seu comportamento. É evidente que têm forte inﬂuência sobre a quantidade de ﬂuido que pode ser extraída e, portanto, se fazem muito importantes no contexto de exploração de petróleo (Thomas, 2001).
Esta seção se destina à descrição da obtenção e tratamento das propriedades físicas abarcadas no modelo matemático apresentado. Primeiramente, serão descritas as propriedades do ﬂuido; posteriormente, da rocha. Por ﬁm, as propriedades associadas ao conjunto rocha-ﬂuido.
2.3.1 PROPRIEDADES DOS FLUIDOS • Viscosidades: A viscosidade é uma medida da resistência do ﬂuido em relação ao escoamento. Está relacionada diretamente ao tipo e ao tamanho de suas moléculas. Trata-se de um 
parâmetro presente em qualquer equação que descreve movimentos de ﬂuidos (McCain Jr, 1990). A viscosidade é função da pressão e da temperatura. Sua variação em virtude da temperatura será desconsiderada, pois que o modelo matemático é destinado a um escoamento isotérmico. Quanto à pressão, a viscosidade é crescente com a pressão para um reservatório subsaturado; decrescente, para saturado (Trangenstein & Bell, 1989). Neste trabalho, contudo, as viscosidades da água e do óleo foram consideradas constantes.
• Densidades: A densidade é a relação entre a massa e o volume da fase. Uma vez que o modelo considerado é incompressível, as densidades da água e do óleo permanecem constantes.
2.3.2 PROPRIEDADES DA ROCHA • Porosidade: A porosidade é a razão entre o volume poroso e o volume total da rocha. Neste trabalho, a rocha reservatório é considerada incompressível.
• Permeabilidade absoluta: A propriedade permeabilidade absoluta da rocha, presente na Lei de Darcy –equação (2.5)–, é a medida de sua capacidade de permitir o ﬂuxo de ﬂuidos. Neste trabalho, a permeabilidade absoluta é representada na forma de um tensor de segunda ordem.
Tal tensor é simétrico, contendo nove componentes Kaviany (1995). A representação é ortotrópica, considerando as direções principais de permeabilidade alinhadas com os eixos de coordenadas x , y , z . Dessa forma, o tensor K é uma matriz puramente diagonal dada por (2.19) 
2.3.3 PROPRIEDADES DO CONJUNTO ROCHA-FLUIDO • Permabilidade relativa: No escoamento multifásico em meio poroso, faz-se necessário introduzir a permeabilidade relativa na Lei de Darcy no intuito de considerar as interações entre os ﬂuidos (Peaceman, 1977). Permeabilidade relativa é um conceito utilizado para relacionar a permeabilidade absoluta (de um ﬂuido único e saturado) à permeabilidade efetiva do ﬂuido no escoamento multifásico, quando esse ocupa uma fração do volume poroso. Foi observado, experimentalmente, que a permeabilidade relativa é função das saturações – seu valor decresce com a diminuição da saturação da fase (Archer & Wall, 1986). Ou seja, essa propriedade associada ao conjunto rocha-ﬂuido introduz a forma segundo a qual o escoamento é afetado em virtude da presença de outras fases e da matriz porosa. Trangenstein & Bell (1989) aﬁrmam que a permeabilidade relativa depende do volume ocupado por cada fase, da rocha, do histórico do escoamento e da tensão interfacial entre as fases. Essas interações complexas ainda não são totalmente entendidas e dominadas. Pode-se aﬁrmar, contudo, que a movimentação de uma fase também tende à zero conforme sua saturação tende à zero.
Ainda, sabe-se que a fase deve alcançar o estado imóvel antes que sua saturação seja nula (Trangenstein & Bell, 1989).
Optou-se por calcular as permeabilidades relativas da água e do óleo por meio do modelo proposto em Corey et al. (1956). Para caracterizá-lo, deﬁnem-se S p mi n, as saturações máxima e mínima, respectivamente, da fase p . A permeabilidade rela-ma x e S p tiva desta fase é dada por (2.20) (2.21) em que o parâmetro αp e o expoente n p são constantes conhecidas dependentes da interação entre a fase e a rocha e a saturação ˆS normalizada é calculada por (2.22) 
3 MÉTODO NUMÉRICO O conjunto de equações que constitui o modelo numérico associado à simulação de um reservatório é, quase sempre, demasiadamente complexo para que o problema físico possa ser solucionado analiticamente. Advém disso a necessidade de introduzir aproximações à formulação numérica, as quais permitam escrever as equações em um formato possível de ser resolvido por rotinas computacionais (Aziz & Settari, 1979).
Maliska (2004) aﬁrma que a tarefa do método numérico é resolver um conjunto de equações diferenciais, substituindo as derivadas por expressões algébricas que envolvam a função incógnita. Nesse procedimento, obtém-se a solução do problema para um número discreto de pontos, com um determinado erro. Se o método adotado for consistente, quanto maior o número de pontos, mais perto da solução exata estará a solução aproximada.
Este capítulo é dedicado à apresentação dos método numéricos adotados na solução do modelo bifásico implementado. Serão apresentados o método dos volumes ﬁnitos baseado em elementos, as discretizações das equações conservativas e as formulações adotadas para resolver o conjunto de equações.
3.1 MÉTODO DOS VOLUMES FINITOS BASEADO EM ELEMENTOS Atribui-se o desígnio de Método dos Volumes Finitos (FVM) a qualquer método numérico que satisfaz a conservação da propriedade em níveis elementares no processo de obtenção das equações aproximadas (Maliska, 2004).
A abordagem frequentemente adotada para deduzir as equações conservativas consiste em realizar um balanço de uma determinada propriedade em um volume de controle pertencente ao domínio do problema. O procedimento de fazer esse volume tender a zero fornece as equações diferenciais. Ao invés de utilizá-las diretamente, o Método dos Volumes Finitos emprega as equações prévias de balanço. Isso assegura o caráter conservativo do método.
Ressalta-se que muitos dos balanços não são facilmente deduzidos – e.g. para volumes de controle irregulares. Disso provém a preferência por obter as equações discretizadas através da integração das equações diferenciais, visto que integrar a forma conservativa ou 
divergente da equação diferencial e fazer um balanço da propriedade são procedimentos equivalentes (Maliska, 2004).
O Método dos Volumes Finitos baseado em Elementos (EbFVM) é um Método dos Volumes Finitos que explora alguns conceitos provenientes do Método dos Elementos Finitos (FEM) a ﬁm de prover maior ﬂexibilidade geométrica e possibilidade de reﬁnos localizados de malha. Por conseguinte, consegue-se alcançar elevada acurácia de representação do domínio mantendo a característica fundamental do método dos volumes ﬁnitos – o caráter conservativo (Hurtado, 2011). A formulação adotada permite empregar triângulos e quadriláteros em malhas bidimensionais; hexaedros, tetraedros, prismas e pirâmides, em malhas tridimensionais. Essas malhas são não-estruturadas, o que signiﬁca que não há um padrão que possa descrever a conﬁguração dos vizinhos de um dado elemento (Maliska, 2004). O potencial de discretização geométrica de malhas não-estruradas está ilustrada na ﬁgura 3.1, a qual ilustra uma malha de 36950 elementos no formato aproximado do território brasileiro.
Figura 3.1: Potencial geométrico da malha não-estruturada 
3.1.1 ENTIDADES GEOMÉTRICAS DA MALHA A ﬁm de caracterizar completamente uma malha associada a um determinado domínio, deve-se deﬁnir o que é uma malha e descrever as entidades que a compõem. Uma malha é a coleção de elementos ei tais que para um domínio fechado Ω tem-se (3.1) Cada e deve possui um interior não vazio. Ainda, deve-se satisfazer ∀ i = j.
(3.2) Isto é, a interseção dos interiores dos elementos deve ser um conjunto vazio (Hurtado, 2011). De forma mais simples, pode-se aﬁrmar que os elementos devem cobrir completamente o domínio sem que ocorra superposição ou espaços vazios.
As superfícies que delimitam os elementos são chamadas de facetas. Tratam-se de arestas em elementos 2D e superfícies, em 3D. Cada faceta que não esteja no contorno do domínio é necessariamente compartilhada por dois elementos. Isso signiﬁca que não é possível contato parcial entre as facetas e por conseguinte, a malha é conforme (Hurtado, 2011).
As faces dos elementos bidimensionais são deﬁnidas como os segmentos que conectam os pontos médios das arestas ao centroide do elemento. A deﬁnição para o caso tri-dimensional é análoga. Essas faces subdividem o elemento em porções denominadas subelementos, os quais estão associados a duas das faces do elemento – com exceção do elemento tridimensional pirâmide, no qual cada subelemento pode estar associado a quatro faces do elemento.
O campo de uma variável do modelo diferencial é aproximado no EbFVM pelos valores discretos em locais coincidentes com os vértices dos elementos da malha, denominados nós. A ﬁgura 3.2 ilustra as principais entidades de uma malha para o elemento mais simples: o triângulo. As deﬁnições para os demais elementos são similares e podem ser encontradas em (Hurtado, 2011).
A construção do volume de controle se dá a partir dos elementos dispostos ao redor dos nós, conforme ilustrado na ﬁgura 3.3. Logo, a superfície de controle é composta por faces de elementos.

Figura 3.2: Principais entidades de um elemento triangular Fonte: do autor Em virtude da disposição geométrica, é conveniente que propriedades físicas tais como porosidade e permeabilidade sejam homogêneas no domínio de um elemento. Assim, não ascende necessidade de adotar qualquer esquema de interpolação a ﬁm de avaliá-los na superfície do volume de controle (Cordazzo, 2006).
Figura 3.3: Construção do volume de controle Fonte: do autor 3.1.2 ABORDAGEM NUMÉRICA A estratégia adotada a ﬁm de lidar com a distorção geométrica dos elementos contidos em uma malha não estruturada é uma transformação denominada mapeamento. Trata-se de uma função bijetora por meio da qual os pontos no espaço físico são representados na forma de elementos regulares em espaços transformados (Hurtado, 2011).

Nesse procedimento, um ponto deﬁnido em coordenadas globais – (x , y ) no caso bi-dimensional – passa a ser descrito em termos de coordenadas locais – (ξ, η). A ﬁgura 3.4 ilustra o mapeamento de um elemento triangular para o espaço transformado. Conforme será veriﬁcado posteriormente, essa transformação facilita a discretizações das equações modelo.
Figura 3.4: Mapeamento para um espaço transformado Fonte: do autor O mapeamento das coordenadas locais para as globais é realizado empregando funções de forma de primeira ordem oriundas do Método dos Elementos Finitos. Para cada vértice i pertencente a um elemento, há uma função de forma Ni , a qual assume valor 1 em i e 0 em todos os outros vértices. Sendo assim, cada ponto p = (x , y , z ) pode ser representado segundo a expressão (3.3) As funções de forma devem ser contínuas, diferenciáveis e partições da unidade, de forma que sejam valores positivos e satisfaçam a equação (3.4) para qualquer ponto (ξ, η, ζ) no sistema local de coordenadas Zienkiewicz & Taylor (2000).
Seja ψ uma função deﬁnida nos nós de uma malha. O EbFVM propõe que o valor de ψ dentro do elemento seja dado pela relação (3.5) Portanto, o valor de ψ dentro do elemento é uma média ponderada de seus valores nos 
vértices do elemento e o peso dessa média é dado pela função de forma.
Uma vez que funções de forma são diferenciáveis, o gradiente de ψ no sistema de co-ordenadas global pode ser expresso conforme (3.6) em que (3.7) é um vetor com os valores de ψ nos nós do elemento.
As funções de forma, contudo, são usualmente dadas em termos das coordenadas locais e, por conseguinte, utilizar as derivadas de Ni com respeito às coordenadas globais é inconveniente. Aplicando a regra da cadeia: (3.8) A matriz J dada por (3.9) (2011). Deﬁnindo a matriz (3.10) 
pode-se elucidar a equação (3.6) no formato A matrix J 3.1.3 DISCRETIZAÇÃO DE UMA EQUAÇÃO DE CONSERVAÇÃO DE UMA VARIÁVEL GENÉRICA Maliska (2004), propõe que a equação de conservação de uma propriedade genérica ψ associada a um escoamento seja escrita na forma (3.12) em que ρ é a massa especíﬁca, u é a velocidade do ﬂuido, Γ é um coeﬁciente difusivo e F , um termo fonte associado à propriedade conservada. Na equação (3.12), o primeiro termo é o de acumulação; o segundo, advectivo; o terceiro, difusivo; o quarto, o termo fonte.
A ﬁm de realizar discretização da equação (3.12), realiza-se uma integração dessa equação para cada volume de controle. Almejando a clareza dos procedimentos, cada termo apresentado na equação (3.12) será discretizado separadamente. Considera-se um volume de controle arbitrário P – vide ﬁgura 3.3 – e uma malha ﬁxa.
A discretização do termo de acumulação se dá utilizando a formulação totalmente implícita (Maliska, 2004): (3.13) em que MP é massa contida no volume P e ψP é média do valor de ψ em P. Essa média é, no Método dos Volumes Finitos, aproximada pelo valor da propriedade no nó. Essa aproximação é razoável, pois que o nó se localiza, geralmente, próximo ao centro do volume de controle.
A discretização do termo fonte é similar: (3.14) O termo de transporte advectivo é discretizado por meio da aplicação do Teorema da 
Divergência de Gauss: (3.15) em que o índice f representa a face do volume de controle; ∂ P , seu contorno; ∆Af o vetor área associado à face f e ˙m f o ﬂuxo de massa que a atravessa. O valor da propriedade ψf na face no centro da face é calculado a partir de algum método de iterpolação, como CDS ou UDS.
Por ﬁm, parte-se à discretização do termo difusivo – o último termo da equação (3.12).
A discretização desse termo é similar àquela realizada para o termo advectivo. Novamente, lança-se mão do Teorema da Divergência de Gauss e da deﬁnição do operador gradiente discreto – equação (3.11) – para obter (3.16) Infere-se das equações discretizadas que as equações discretizadas envolvem, além do próprio nó associado a P, os nós que compartilham um elemento com o nó P. Sendo assim, esse é o estêncil associado ao EbFVM.
Matematicamente, se P é o conjunto dos elementos que compartilham o nó P e e , o conjunto dos nós associados ao elemento e , então o estêncil P é dado por (3.17) Graﬁcamente, a ﬁgura 3.5 exibe em preto os nós, os quais em conjunto, compõem o estêncil associado ao nó P.
Figura 3.5: Estêncil associado ao nó P 
3.2 EQUAÇÕES DISCRETIZADAS Empregando o procedimento de discretização exposto anteriormente, obtém-se a equação de conservação da massa das fases água e óleo para um dado volume de controle P da malha, as quais são (3.18) (3.19) em que o índice superior old indica o valor da propriedade no passo de tempo anterior, Φe é um vetor com os valores de Φ nos nós do elemento e e P é o conjunto de elementos que compartilham o nó P.
Em conjunto com a equação de restrição volumétrica equação (2.17) tem-se três equações para as três variáveis primárias: P , S w e S o .
Esse conjunto de equações pode ser, ainda, manipulado algebricamente para que o sistema de equações seja resolvido de forma mais conveniente. Somando a equação (3.18) à equação (3.19) e substituindo a equação (2.17) chega-se à conservação da massa global, dada por (3.20) em que (3.21) são, respectivamente, mobilidade e termo fonte totais.
As equações a serem resolvidas são as equações de conservação da massa da água – equação (3.18)– e a equação de conservação da massa global – equação (3.20). Assim, há duas equações para duas variáveis primárias – S w e P . A pressão pode ser obtida a partir do potencial por meio da expressão (3.22) Já a saturação do óleo pode ser calculada por meio da equação (2.17). Em virtude de sua relação estreita com a implementação computacional, a construção do sistema de equações será explicado apenas no capítulo subsequente.

3.3 FORMULAÇÕES IMPES E SEQUENCIAL O método IMPES (IMplicit Pressure Explicit Saturation), em sua formulação clássica, fundamenta-se na divisão do sistema acoplado de equações em sistemas de equações distintos para pressão e saturação, os quais são resolvidos de forma implícita e explícita, respectivamente. O cálculo explícito da saturação acarreta menor custo computacional, e estabilidade condicionada a pequenos passos de tempo (Chen, 1962).
As equações associadas ao cálculo implícito de P e explícito de S w são, respectivamente: ∆VP, (3.23) P (3.24) O procedimento iterativo para determinar as variáveis primárias do problema através do IMPES clássico é: 1. Especiﬁcar os valores inciais das variáveis primárias – P e S w – em todos os volumes de controle da malha; 2. Calcular as mobilidades em todos os volumes de controle da malha; 3. Interpolar as mobilidades nas faces dos elementos; 4. Resolver o sistema linear da equação da pressão – equação (3.23); 5. A partir da solução obtida para a pressão, calcular a saturação da água explicitamente – equação (3.24) 6. Avançar a solução no tempo e retornar ao item 2 até atingir a simulação do tempo total desejado.
O método sequencial calcula as variáveis primárias de modo similar. Neste caso, contudo, após o passo 5, retorna-se ao 2 até que os campos de pressão e saturação mudem menos que uma dada tolerância.

3.4 FORMULAÇÃO TOTALMENTE IMPLÍCITA No método totalmente implícito ou FIM (Fully Implicit Method) as váriaveis são resolvidas de maneira concomitante. Trata-se da formulação mais estável e robusta para a simulação de reservatórios. Apresenta limitações de passo de tempo menos restritivas em relação aos esquemas que linearizam o acoplamento entre pressão e saturação, como é feito no método IMPES (IMplicit Pressure, Explicit Saturation). (Chen, 1962).
3.4.1 MÉTODO DE Newton Quanto à aplicação do FIM, faz-se necessário o emprego de um solver não linear para a resolução do sistema de equações. No intuito de resolver esse sistema, foi adotado o método de Newton contido na biblioteca PETSc (Portable, Extensible Toolkit for Scientiﬁc Computation). As rotinas implementadas nessa biblioteca são eﬁcientes e têm suporte para a resolução dos problemas em paralelo (Balay et al., 2009). Antes de utilizar a PETSc, contudo, as equações devem ser preparadas à aplicação do método de Newton.
A ideia fundamental desse método é mais simples de ser entendida no caso unidimensional, no qual deseja-se determinar, de forma iterativa, as raízes de uma função a partir de uma estimativa inicial. Calcula-se a reta tangente à função no ponto associado à estimativa. Determina-se, então, a interseção dessa reta tangente com o eixo das abcissas a ﬁm de encontrar uma melhor aproximação para a raiz. Repetindo esse procedimento, tem-se um método iterativo que pode ser utilizado para estimar a raíz de uma função. Matematicamente, o método de Newton para funções de uma variável é representado por em que n indica a n-ésima iteração e f mento iterativo está ilustrado e descrito na ﬁgura 3.6.

Figura 3.6: Método de Newton para funções de uma variável No caso de funções de múltiplas variáveis – caso deste trabalho –, o método de Newton apresentado para uma única variável deve ser expandido a uma forma mais genérica.
Nessa, são resolvidas, simultaneamente, raízes de várias funções, as quais são denominadas resíduos. As equações resíduo associadas às equações de conservação discretizadas são (3.26) (3.27) uma vez que as raízes dessas funções consistem na solução do sistema de equações. Nas equações 3.26 e 3.27 o símbolo R w denota o resíduo associado à conservação da massa da água e R t , da conservação da massa total. Ambos os resíduos são funções da saturação da água S w e da pressão P , as quais constituem as variáveis primárias do problema.

O procedimento iterativo utilizado no intuito de determinar essas variáveis primárias está listado a seguir: 1. Construir um vetor X com as estimativas das variáveis primárias – P e S w – em todos os volumes de controle da malha; 2. Calcular as propriedades e as mobilidades em todos os volumes de controle da malha; 3. Interpolar as mobilidades nas faces dos elementos; 4. Computar os resíduos de cada equação – R w e R t – em todos os volumes de controle da malha; 5. Computar as derivadas parciais dos resíduos em cada nó através da expansão em série de Taylor truncadaa (3.28) 6. Resolver o sistema linear J ∆X =−R; (3.29) em que J é a matriz jacobiana, contendo todas as derivadas parciais dos resíduos em todos os volumes; ∆X, o vetor com as correções a serem aplicadas às estimativas e R, o vetor contendo os resíduos correspondentes às estimativas; 7. Corrigir o valor das variáveis contidas em X por meio da equação (3.30) 8. Retornar ao item 2 e iterar até que seja atingida a convergência; 9. Retornar ao item 2 e avançar a solução no tempo até a simulação do tempo total desejado.
Assim, todas as variáveis são resolvidas de forma implícita, e, portanto, podem ser utilizados passos de tempo signiﬁcativamente maiores àqueles utilizados em métodos que apresentam algum caráter explícito Aziz & Settari (1979).
aRessalta-se que os resíduos são funções de S w e P , de forma que a derivada numérica em relação a X deve levar em conta a contribuição dessas duas variáveis. A forma por meio da qual essas contribuições são consideradas serão detalhadas posteriormente.

No capitulo ulterior, destinado ao tema implementação computacional, procedimentos tais como a construção da matriz jacobiana serão mais bem detalhados.


IMPLEMENTAÇÃO COMPUTACIONAL Conquanto as fases de modelagem matemática e numérica detenham papeis fundamentais à acurácia com a qual o fenômeno físico é representado, é por meio da implementação computacional que se obtêm os resultados concretos através da simulação numérica do problema. Maliska (2004) aﬁrma que o desenvolvimento de um bom programa computacional requer a harmonia entre o uso das ferramentas computacionais disponíveis, a estratégia de depuração dos erros e a ulterior interpretação correta dos resultados.
Este capítulo se destina à descrição de alguns aspectos relacionados à implementação computacional. Também proporciona uma visão geral do simulador do ponto de vista de programação. Isso facilita o entendimento da forma por meio da qual o conjunto de dados físicos foi tratado e da inter-relação entre cada módulo implementado. A possibilidade de adquirir essa visão é importante, pois que estreita o caminho entre a percepção de um fenômeno físico e a capacidade de obter algum resultado a partir das equações abstratas que o modelam.
Primeiramente, as metodologias IMPES e totalmente implícita serão explicadas do ponto de vista de implementação. Posteriormente, será explicado um esquema de passo de tempo adaptativo implementado a ﬁm de reduzir o esforço computacional de ambas as formulações.
4.1 MÉTODOS IMPES E SEQUENCIAL O método IMPES, conforme já discutido anteriormente, é mais simples e direto do ponto de vista de implementação, quando comparado ao método totalmente implícito.
Esta seção de destina ao esclarecimento da abordagem computacional utilizada para obter a solução do problema. Primeiramente, será exposta a estrutura geral do simulador.
A seguir, serão brevemente descritos os procedimentos de cálculo implícito da pressão e explícito da saturação. Para mais detalhes quanto ao tratamento numérico do modelo por meio do método dos volumes ﬁnitos baseado em elementos, consultar Hurtado (2011).

4.1.1 ESTRUTURA GERAL DO SIMULADOR A simulação do escoamento bifásico por meio da formulação IMPES é fundamentado em uma classe denominada Simulator. Essa classe é responsável por administrar a resolução implícita da pressão por meio da classe TwoPhasePressureComputer e pelo cálculo explícito da saturação, por meio da classe WaterSaturationComputer. Ainda há classes derivadas das classes abstratas Event e Controller, as quais são, respectivamente, destinadas à execução de eventos – e.g. avanço no tempo e exportação de dados – e controle da simulação – e.g. veriﬁcar convergência e chegada ao tempo ﬁnal de simulação. A relação entre essas classes está ilustrada esquematicamente na ﬁgura 4.1.
Figura 4.1: Classes responsáveis pela simulação pelo método IMPES Fonte: do autor 4.1.2 CÁLCULO IMPLÍCITO DA PRESSÃO O cálculo implícito da pressão consiste em resolver o sistema linear constituído pelas equações de conservação da massa total para cada nó da malha. A equação para o nó P é dada por (4.1) A ﬁm de adicionar os termos da equação (4.1) à matriz do sistema linear da pressão sem executar procedimentos duplicados, procede-se conforme o pseudocódigo representado na listagem 4.1. A estrutura ﬁnal da matriz do sistema linear está ilustrada, para uma malha bidimensional simples, na ﬁgura 4.2.

Figura 4.2: Exemplo de estrutura da matriz do sistema linear da pressão 
Listagem 4.1: Pseudocódigo da rotina que resolve o sistema linear da pressão 1 PARA todos os elementos da malha PARA todas as faces do elemento 
PARA todos os nós do elemento 
calcular contribuição do nó no ﬂuxo difusivo 
adicionar contribuição às equações referentes aos nós atrás ...

... e à frente da face 
FIM PARA 
FIM PARA 
9 FIM PARA Já o termo do lado direito da equação (4.1) é adicionado diretamente ao termo independente, por meio de uma varredura dos nós do poço ou da fronteira com condição de contorno do tipo Neumann. Caso a condição de contorno seja do tipo Dirichlet as linhas da equação dos nós da fronteira são zeradas, exceto a entrada da diagonal principal, à qual é atribuído o valor 1. Ao termo independente é, então, atribuído o valor prescrito. Dadas as montagens da matriz e do termo independente, tem-se o sistema linear, do qual são calculadas as pressões para um determinado passo de tempo.
4.1.3 CÁLCULO EXPLÍCITO DA SATURAÇÃO O cálculo explícito da saturação é dado a partir dos valores de pressão calculados implicitamente para o passo de tempo em questão. A equação resolvida explicitamente é (4.2) A maneira de construir a equação explícita é análoga àquela relativa ao sistema linear.
Nesse caso, contudo, não há necessidade de montar a matriz com essas contribuições, pois que os valores de pressão são conhecidos e pode-se efetuar o somatório presente na equação (4.2) diretamente.

4.2 MÉTODO TOTALMENTE IMPLÍCITO O método totalmente implícito é mais laborioso tanto do ponto de vista de formulação quanto de implementação. Há de se atentar para diversos detalhes referentes não somente ao método numérico em si, mas também aos aspectos computacionais envolvidos em sua concepção. Esta seção se destina ao esclarecimento da abordagem computacional utilizada para obter a solução do problema. Primeiramente, será exposta a estrutura geral do simulador. A seguir, serão detalhados os procedimentos de cálculo dos resíduos e contrução da matriz jacobiana.
4.2.1 ESTRUTURA GERAL DO SIMULADOR A simulação do escoamento bifásico por meio da formulação totalmente implícita é fundamentado em uma classe denominada TwoPhaseFlowComputer. Essa classe é responsável por administrar a resolução do sistema não linear, a qual é efetuada com o suporte da biblioteca PETSc (Balay et al., 2013). Para isso, a TwoPhaseFlowComputer possui classes responsáveis por calcular as mobilidades (MobilityCalculator); montar os resíduos (ResidualsAssembler); montar a matriz jacobiana (JacobianAssembler) e exportar a solução numérica de forma que essa possa ser visualizada convenientemente (TwoPhaseFlowExporter). A relação entre essas classes está ilustrada esquematicamente na ﬁgura 4.3.
Figura 4.3: Classes responsáveis pela simulação pelo método FIM A classe TwoPhaseFlowComputer contém a função responsável pela resolução do sistema não linear, a qual está representada em pseudocódigo na listagem 4.2. As opera- 
ções executadas nas linhas 2 e 3 da listagem são executadas, respectivamente, pelas classes ResidualsAssembler e JacobianAssembler. A linha 6, por sua vez, se refere ao passo de tempo adaptativo já explicado anteriormente.
Listagem 4.2: Pseudocódigo da rotina que resolve o sistema não linear 1 Alocar memória para o vetor de resíduos 2 Alocar memória para a matriz jacobiana 3 REPETIR Resolver o sistema não linear utilizando a PETSc ...

...( informando à biblioteca a implementação própria das funções ...

... de montagem do vetor de resíduos e da matriz jacobiana) 
SE convergência atingida e saturação consistente ENTÃO 
Ajustar passo de tempo 
Avançar a solução no tempo 
SE NÃO 
Ajustar passo de tempo 
FIM SE 
13 ENQUANTO tempo ﬁnal atingido 4.2.2 CÁLCULO DOS RESÍDUOS A ﬁm de facilitar a indexação das variáveis, optou-se por dispô-las de forma que a saturação e a pressão de um dado volume de controle consistam em entradas adjacentes do vetor de resíduos. A classe ResidualsAssembler dispõe de uma função que calcula os resíduos R w e R t e já os adiciona nas posições corretas do vetor resíduo. Essa adição é feita por etapas nas quais são calculados os termos difusivo, acumulativo e fonte denotados, respectivamente, por αdif, αac e αfon nas equações a seguir: (4.3) 
(4.4) A função responsável por esses cálculos está representada em pseudocódigo na listagem 4.8. As quatro subrotinas chamadas na listagem 4.8 serão explicadas nos itens a seguir.
Listagem 4.3: Pseudocódigo da rotina que computa os resíduos 1 CHAMA função que adiciona o termo difusivo 2 CHAMA função que adiciona o termo acumulativo 3 CHAMA função que adiciona termo fonte 4 CHAMA função que aplica condições de contorno ADIÇÃO DO TERMO DIFUSIVO A adição dos termo difusivos correspondentes às equações de conservação da massa da água e global, e (4.5) foi implementada de forma que não fossem realizados cálculos e procedimentos duplicados. A listagem 4.4 contém o pseudocódigo da função que executa essa operação.
Listagem 4.4: Pseudocódigo da rotina que adiciona o termo difusivo nos resíduos 1 PARA todos os elementos da malha PARA todas as faces do elemento 
calcular ﬂuxo difusivo de água 
calcular ﬂuxo difusivo total 
adicionar ﬂuxos nas equações referentes aos volumes de controle ...

... separados pela face 
FIM PARA 
8 FIM PARA 
Ressalta-se que as mobilidades λw e λt devem ser avaliadas nas faces. Tendo em vista que a mobilidade é função de variáveis primárias armazenadas nos nós, essas são primeiramente avaliadas nos nós. Posteriormente, esses valores são interpolados a ﬁm de determinar as mobilidades na face do volume de controle. Essa interpolação foi realizada pelo esquema upwind, o qual tem relação direta com o termo parabólico da equação, i.e., o valor da função na interface é igual ao valor do volume de controle a montante (Maliska, 2004).
Matematicamente, tem-se (4.6) onde nB e nF indicam os nós atrás e a frente da face, conforme mostrado na ﬁgura 4.4.
Figura 4.4: Esquema de interpolação upwind em elemento triangular Fonte: do autor ADIÇÃO DO TERMO ACUMULATIVO A função que adiciona o termo acumulativo da equação da conservação da massa da água, (4.7) por sua vez, é mais direta e está representada na listagem 4.5. Tendo em vista que esse termo não necessita interpolações e cálculos envolvendo outras entidades além dos nós, pode-se varrer os nós da malha diretamente. Ressalta-se, pois, que esse termo deve ser adicionado apenas à equação da conservação da massa da água, porquanto a equação de restrição volumétrica cancela esse termo na equação de conservação da massa totala.
aEssa simpliﬁcação só se aplica em caso de escoamento incompressível.

Listagem 4.5: Pseudocódigo da rotina que adiciona o termo acumulativo nos resíduos 1 PARA todos os nós da malha calcular termo acumulativo 
adicionar termo na equação de conservação da massa da água 
4 FIM PARA ADIÇÃO DO TERMO FONTE A função que adiciona os termos fontes correspondentes às equações de conservação da massa da água e global, e (4.8) veriﬁca os poços localizados ao longo da malha, e, a partir da informação sobre sua operação – pressão constante ou vazão constante – adiciona o valor adequado ao resíduo das equações associadas aos volumes de controle nos quais os poços se encontram. Tendo em vista que esse termo não necessita interpolações e cálculos envolvendo outras entidades além dos nós, pode-se varrer os nós da malha diretamente e adicionar os termos fonte. A função responsável por adicioná-los aos resíduos está representada em pseudocódigo na listagem 4.6.
A vazão nos poços cuja condição de operação é pressão prescrita é calculada por meio da equação (4.9) em que qpoço é a vazão da fase p no sentido reservatório-poço, WI é o well index ou índice de poço, PP é a pressão no nó P do reservatório e Ppoço é a pressão de fundo de poço. Neste trabalho, o índice de poço foi calculado realizando uma adaptação do modelo de Peaceman (1978), utilizando a expressão (4.10) em que h é o comprimento do poço, rpoço é o raio do poço e req é o raio equivalente, o qual nesse trabalho foi calculado como metade do diâmetro hidráulico do volume de controle associado ao poço por meio da equação req = Volume do volume de controle associado ao poço Área da superfície de controle associada ao poço .
(4.11) 
Listagem 4.6: Pseudocódigo da rotina que adiciona o termo fonte nos resíduos 1 PARA todos os poços da malha SE poço opera com pressão constante 
calcula vazão no poço a partir de sua pressão de operação 
adiciona vazão às equações dos volumes de controle do poço 
FIM SE 
SE poço opera com vazão constante 
adiciona vazão às equações dos volumes de controle do poço 
FIM SE 
9 FIM PARA APLICAÇÃO DAS CONDIÇÕES DE CONTORNO Quanto à imposição das condições de contorno, optou-se por considerar condições de Neumann e Dirichlet. Quanto à imposição de ﬂuxo prescrito – condição de contorno de Neumann – preferiu-se prescrever velocidade, a ﬁm de que o problema a ser resolvido ﬁcasse independente da malha utilizada.
Ressalta-se que em malhas não estruturadas tanto a face quanto o nó nos quais são prescritas condições de Neumann e Dirichlet, respectivamente, estão localizados sobre o contorno. Essa conﬁguração geométrica pode ser visualizada na ﬁgura 4.5, em que está ilustrado um volume de controle adjacente ao contorno. É importante ressaltar que o volume de controle associado ao nó P é interior ao domínio, ao passo que o nó está sobre a fronteira.
A condição de Neumann é imposta diretamente fazendo, nas equações (4.3) e (4.4), e (4.12) em que q w P e q t P são as vazões volumétricas de água e total, obtidas através de (4.13) em que b P é o conjunto de faces que formam a parte da superfície de controle associada ao nó P que está localizada sobre a fronteira e bf são as faces contidas nesse conjunto. Já V w e V t são as velocidades de água e total prescritas, respectivamente.
No caso de condição de contorno de Dirichlet, elimina-se a equação da variável co- 
Figura 4.5: Volume de controle adjacente ao contorno nhecida e, em seu lugar, insere-se apenas o valor unitário na diagonal principal da matriz jacobiana. O resíduo, por sua vez, recebe o valor zero.
O pseudocódigo da função destinada à aplicação das condições de contorno está representada por meio de pseudocódigo na listagem 4.7. A face de contorno mencionada no algoritmo é uma entidade da fronteira, a qual está ilustrada na ﬁgura 4.5 juntamente às outras entidades das fronteiras da malha.
Listagem 4.7: Pseudocódigo da rotina que aplica as condições de contorno nos resíduos 1 PARA todas as fronteiras com condição de contorno do tipo Neumann PARA todos os elementos da fronteira 
PARA todas as faces do elemento 
adicionar ﬂuxo prescrito na equação do nó associado ...

... à face de contorno 
FIM PARA 
FIM PARA 
8 FIM PARA 9 PARA todas as fronteiras com condição de contorno do tipo Dirichlet PARA todos os nós da fronteira 
adicionar zero nas equações do nó 
FIM PARA 
13 FIM PARA 
4.2.3 CONSTRUÇÃO DA MATRIZ JACOBIANA O cálculo da matriz jacobiana é a parte mais custosa e complexa dos algoritmos de solução de sistemas não lineares. Ainda, sua construção é diferenciada em se tratando do método dos volumes ﬁnitos baseado em elementos, pois que esse método se fundamenta em varreduras nos elementos da malha computacional.
Um aspecto relevante do processo de montagem da matriz jacobiana é sua estrutura, a qual deve ser compativel àquela associada ao vetor resíduo. Uma vez que a indexação de variáveis se deu de forma que as equações de conservação da massa da água e total de um determinado volume de controle fossem adjacentes, tem-se: (4.14) em que (4.15) Na equação (4.15), P é o volume de controle em que se deseja calcular a derivada e RP é o resíduo, o qual pode ser associado à equação de conservação da massa da água ou total do nó P. Já x j é a variável em relação à qual a derivada é calculada. Ressalta-se que x j é um componente do vetor solução, o qual possui tanto S w quanto P em suas entradas, i.e., a variável x j representada na equação (4.15) pode ser tanto saturação quanto pressão.
Quanto à estrutura da matriz, pode-se veriﬁcar que cada linha é composta pelas derivadas de uma única equação do resíduo, ao passo que cada coluna contém as derivadas em relação a uma única variável. Ademais, a equação (4.14) consiste na equação (3.29) com os coeﬁcientes explicitados.
Na ﬁgura 4.6 pode-se visualizar um exemplo de estrutura da matriz jacobiana. É interessante notar que a estrutura da matriz do sistema linear da pressão no método IMPES, representada na ﬁgura 4.2 é semelhante àquela associada à matriz jacobiana e exposta na ﬁgura 4.6. Esta última, contudo, é composta por blocos – matrizes 2x2 nas quais estão 
dispostas as derivadas numéricas de R w e R t em relação à S w e P , conforme ilustrado na ﬁgura.
Figura 4.6: Exemplo de estrutura da matriz jacobiana A ﬁm de efetuar o cálculo das derivadas numéricas que compõem a matriz jacobiana de forma mais conveniente e eﬁcaz, as equações resíduo podem ser escritas na forma e (4.16) 
Assim, as derivadas numéricas associadas ao resíduo R w são dadas por (4.17) (4.18) e as derivadas numéricas associadas ao resíduo R t , por (4.19) (4.20) Dado isso, infere-se que a montagem da matriz jacobiana pode ser realizada considerando separadamente as contribuições devidas aos termos difusivo, acumulativo e fonte.
A classe JacobianAssembler dispõe de uma função responsável por calcular cada uma dessas contribuições e adicioná-las à matriz jacobiana. Essa função é semelhante àquela destinada a calcular os resíduos. Seu pseudocódigo está contido na listagem 4.8. As quatro subrotinas chamadas na listagem 4.8 serão explicadas nos itens a seguir.
Listagem 4.8: Pseudocódigo da rotina que monta a matriz jacobiana 1 CHAMA função que adiciona o termo difusivo 2 CHAMA função que adiciona o termo acumulativo 3 CHAMA função que adiciona termo fonte 4 CHAMA função que aplica condições de contorno ADIÇÃO DO TERMO DIFUSIVO Quanto à função que adiciona a contribuição do termo difusivo à matriz jacobiana, procurou-se efetuar a implementação computacional de forma a tentar minimizar procedimentos repetidos. Essa preocupação se deu, sobretudo, em relação às varreduras das entidades da malha.
Lembrando que termos difusivos são dados conforme a equação (4.5), as derivadas numéricas do termo difusivo podem ser calculadas por 
(4.21) (4.22) (4.23) (4.24) j é uma perturbação na saturação e ∆Pj , na pressão do nó j . Isto é, as deriva-em que ∆S w das parciais dos resíduos calculadas numericamente consistem em subtrair o ﬂuxo difusivo perturbado do ﬂuxo difusivo não perturbado e dividir esse valor pela perturbação. Optou-se por armazenar o ﬂuxo não perturbado já na etapa da construção dos resíduos. Sendo assim, a função da classe JacobianAssembler, cujo intuito é adicionar os termos difusivos à matriz jacobiana, deve calcular o ﬂuxo perturbado, para então calcular a derivada numérica e adicioná-la à matriz.
A ﬁm de realizar esse cálculo, dá-se primeiro a perturbação da saturação; depois, da pressão. Para o primeiro caso, faz-se a varredura dos elementos da malha e para cada nó do elemento, perturba-se a saturação, calcula-se os ﬂuxos nas faces e adiciona-se esse valor à matriz jacobiana.
O mesmo procedimento é realizado para a perturbação da pressão. Contudo, neste caso pode-se ocasionar uma mudança no sentido dos ﬂuxos e, por conseguinte, nas mobilidades nas faces, interpoladas por upwind. Para simpliﬁcar o cálculo dessas mobilidades, deﬁne-se o pseudoﬂuxo na face f , dado por (4.25) Esse pseudoﬂuxo, apesar de não apresentar o valor correto do ﬂuxo difusivo, contém a informação referente a seu sentido, e pode, portanto, ser utilizado para determinar os valores corretos de mobilidade.
Os procedimentos de perturbação da saturação e da pressão para a montagem da matriz jacobiana estão representados de forma mais detalhada na listagem 4.9.

Listagem 4.9: Pseudocódigo da rotina que adiciona o termo difusivo na matriz jacobiana {Perturbação da saturação} 
2 PARA todos os elementos da malha PARA todos os vértices do elemento 
perturbar saturação do vértice 
calcular mobilidade do vértice perturbado 
PARA todas as faces do elemento 
PARA todos os vértices do elemento 
calcular contribuição do nó no ﬂuxo perturbado da face 
adicionar contribuição ao ﬂuxo perturbado da face 
FIM PARA 
adicionar ﬂuxo perturbado dividido pela perturbação à matriz ...

... nas equações dos nós nF e nB da face 
subtrair ﬂuxo perturbado dividido pela perturbação à matriz ...

... nas equações dos nós nF e nB da face 
FIM PARA 
FIM PARA 
17 FIM PARA 
{Perturbação da pressão} 
20 PARA todos os elementos da malha PARA todos os vértices do elemento 
perturbar pressão do vértice 
calcular pseudoﬂuxo 
calcular mobilidade do vértice perturbado 
PARA todas as faces do elemento 
PARA todos os vértices do elemento 
calcular contribuição do nó no ﬂuxo perturbado da face 
adicionar contribuição ao ﬂuxo perturbado da face 
FIM PARA 
adicionar ﬂuxo perturbado dividido pela perturbação à matriz ...

... nas equações dos nós nF e nB da face 
subtrair ﬂuxo perturbado dividido pela perturbação à matriz ...

... nas equações dos nós nF e nB da face 
FIM PARA 
FIM PARA 
36 FIM PARA 
No intuito de prover uma visualização menos abstrata da função responsável por montar a matriz jacobiana, ilustrou-se um exemplo na ﬁgura 4.7. Nela, considera-se uma malha composta por um único elemento triangular. Admite-se, também, que está sendo realizada a etapa de perturbação da saturação. Dá-se, então, a perturbação da saturação do nó cujo índice é 0.
Uma vez que a perturbação é da variável correspondente à primeira equação do sistema, esse procedimento proverá as contribuições do termo difusivo à primeira coluna da matriz. Dada a perturbação da saturação e o cálculo das mobilidades perturbadas nas faces do elemento, parte-se à varredura das faces. Para cada face, varre-se os nós do elemento calculando a contribuição do nó aos ﬂuxos difusivos perturbados de água e total. Faz-se, então, o cálculo da derivada numérica a partir dos valores de ﬂuxos perturbado, não perturbado e perturbação. Essa derivada é, pois, adicionada às equações dos nós associados a essa face. Por exemplo, à face f0, estão associados os nós 0 e 1. Sendo assim, são calculadas as seguintes derivadas: (4.26) Esses coeﬁcientes são relacionados às equações 0, 1, 2 e 3, respectivamente, i.e. conservação da massa da água do nó 0, conservação da massa total do nó 0, conservação da massa da água do nó 1 e conservação da massa total do nó 1. Constituem, portanto, contribuições às entradas (0,0), (1,0), (2,0) e (3,0) da matriz jacobiana. A ﬁgura 4.7 ainda apresenta a sequência do processo de varredura das faces do elemento, ilustrando as contribuições dos ﬂuxos através das faces f1 e f2.
Para continuar a montagem da matriz, ter-se-ia de realizar o mesmo procedimento incrementando as saturações dos nós 1 e 2, processo do qual seriam calculadas as colunas 2 e 4 da matriz – referentes às equações de conservação da massa da água dos nós 1 e 2.
Por ﬁm, o mesmo procedimento seria feito incrementando as pressões dos nós 0, 1 e 2, procedimento do qual seriam determinadas as colunas 1, 3 e 5, referentes às equações de conservação da massa total dos nós 0, 1 e 2. Conforme já explicitado, a única diferença entre esse processo de perturbação de pressão é a necessidade de calcular o pseudoﬂuxo nas faces do elemento.

Figura 4.7: Exemplo de etapa de montagem da matriz jacobiana 
ADIÇÃO DO TERMO ACUMULATIVO Adicionar o termo acumulativo à matriz jacobiana é muito mais simples que adicionar o termo difusivo. Isso porque só há termo de acumulação na equação da conservação da massa da água e, além disso, o resíduo desse termo é função exclusiva e linear da saturação: (4.27) A derivada parcial, pois, consiste em um valor constante e que pode ser calculado direta-mente para cada nó da malha: (4.28) A listagem 4.10 representa o pseudocódigo da função que adiciona esse termo à jacobiana.
Listagem 4.10: Pseudocódigo da rotina que adiciona o termo acumulativo na matriz jacobiana 1 PARA todos os nós da malha calcular derivada do termo acumulativo 
adicionar derivada à matriz jacobiana na equação de conservação da ...

... massa da água do nó 
5 FIM PARA ADIÇÃO DO TERMO FONTE A função que adiciona o termo fonte veriﬁca os poços localizados ao longo da malha, e, a partir da informação sobre sua operação – pressão constante ou vazão constante – adiciona o valor adequado à matriz jacobiana. Os termos fonte devidos aos poços são (4.29) Assim, se o poço opera com vazão constante, a derivada numérica é nula, logo não é preciso varrer os poços que operam sob essa condição. Já para os poços de pressão constante tem-se (4.30) Portanto, os termos fonte correspondentes aos poços que operam sob a condição de pressão constante são funções de S w e P . São necessárias, então, as perturbações da satu- 
ração e da pressão de forma a calcular suas contribuições à matriz jacobiana. Essa função está representada em pseudocódigo na listagem 4.11 Listagem 4.11: Pseudocódigo da rotina que aplica as condições de contorno na matriz jacobiana {Perturbação da saturação} 
2 PARA todos os poços da malha SE poço opera com pressão constante 
PARA cada vértice contido no poço 
perturbar saturação do nó 
calcular mobilidade perturbada 
calcular ﬂuxo perturbado calcular derivada e adicioná−la à matriz nas equações de ...


... conservação do nó 
FIM PARA 
FIM SE 
12 FIM PARA {Perturbação da pressão} 
14 PARA todos os poços da malha SE poço opera com pressão constante 
PARA cada vértice contido no poço 
perturbar pressão do nó 
calcular mobilidade perturbada 
calcular ﬂuxo perturbado calcular derivada e adicioná−la à matriz nas equações de ...


... conservação do nó 
FIM PARA 
FIM SE 
24 FIM PARA APLICAÇÃO DAS CONDIÇÕES DE CONTORNO Se a fronteira apresentar condição de contorno do tipo Neumann, a derivada numérica de sua contribuição é nula. Apenas ascende, pois, a necessidade de varrer as fronteiras cuja condição de contorno é do tipo Dirichlet. A imposição dessa condição é bastante simples – basta zerar as linha referentes às equações 
dos nós da fronteira e atribuir o valor unitário às entradas da diagonal principal. A função responsável pela aplicação das condições de contorno à matriz jacobiana está representada por meio de pseudocódigo na listagem 4.12.
Listagem 4.12: Pseudocódigo da rotina que aplica as condições de contorno na matriz jacobiana 1 PARA todas as fronteiras com condição de contorno do tipo Dirichlet PARA todos os nós da fronteira 
zerar as entradas das linhas associadas às equações do nó 
setar valor unitário na diagonal principal dessas linhas 
FIM PARA 
6 FIM PARA 4.3 PASSO DE TEMPO ADAPTATIVO Almejando poupar esforço computacional demasiado e, simultaneamente, prevenir a especiﬁcação de passos de tempo excessivamente altos, foi implementado um esquema de modiﬁcação do passo de tempo inicialmente especiﬁcado na simulação a partir da diferença do campo de saturação calculado em relação ao campo de saturação antigo, i.e., associado ao passo de tempo anterior. O funcionamento desse esquema está esquematizado por meio de um ﬂuxograma na ﬁgura 4.8.
Devem ser especiﬁcados pelo usuário cinco parâmetros de entrada: o passo de tempo inicial ∆t , a diferença máxima de saturação ∆Smax, a diferença mínima de saturação ∆Smin e as duas constantes αaum e αred. A ideia central do esquema de passo de tempo adaptativo é ajustar o passo de tempo de acordo com a magnitude da variação do campo de saturação a partir da especiﬁcação de um valor de αaum superior ao valor unitário e de αred, inferior.
Dessa forma, caso a diferença entre a saturação atual e a saturação antiga exceda ∆Smax em algum volume de controle, o passo de tempo é reduzido por meio da expressão (4.31) e a solução no nível de tempo em questão é recalculada. Por outro lado, se essa diferença for inferior a ∆Smin em todos os volumes de controle, permite-se um aumento do passo de 
tempo calculando-o por meio de (4.32) Almejando dispor de mais indicativos quanto à adequação do valor do passo de tempo, também são efetuadas veriﬁcações quanto à convergência da solução. Se ocorrer divergência de algum sistema linear, ou até mesmo do sistema não-linear no caso do método totalmente implícito, o passo de tempo é reduzido utilizando a equação (4.31) e não se dá o avanço no tempo, mas sim calcula-se a solução novamente com um passo de tempo de valor mais baixo. Considera-se também como divergência o caso em que o método sequencial efetua o número máximo de iterações em um mesmo passo de tempo sem atingir a tolerância requerida.
Ademais, ainda é veriﬁcado se o campo de saturação é ﬁsicamente consistente identiﬁcando se as saturações de todos os volumes de controle possuem valores entre 0 e 1 −6. Se essa condição não ocorrer, procede-se como no caso da divergência, reduzindo o passo de tempo e resolvendo novamente os campos de pressão e com uma tolerância de 10 saturação associados àquele mesmo nível temporal.
Neste trabalho optou-se por utilizar dois conjuntos de parâmetros especiﬁcados ao esquema de passo de tempo adaptativo. O primeiro, e mais rígido, tem os valores de seus parâmetros listados na tabela 4.1; O segundo, e menos rígido, na tabela 4.2.
Tabela 4.1: Parâmetros correspondentes ao critérios mais rígido de passo de tempo adaptativo Tabela 4.2: Parâmetros correspondentes ao critérios menos rígido de passo de tempo adaptativo 
Fonte: do autor 
4.4 ESPECIFICAÇÃO DAS TOLERÂNCIAS O método totalmente implícito requer a especiﬁcação de duas tolerâncias. A primeira corresponde ao sistema linear composto pela matriz jacobiana e pelo vetor de resíduos.
Tendo em vista que o termo independente é o resíduo, optou-se por utilizar a tolerância absoluta da biblioteca PETSc para esse caso a ﬁm de que não fosse especiﬁcado um critério excessivamente apertado. Assim, o critério de convergência do solver linear é R < , (4.33) em que R é o vetor resíduo e é a tolerância especiﬁcada. O valor de atribuído para −5. Outra tolerância que necessita resolver os problemas apresentados neste trabalho foi 10 ser especiﬁcada no método totalmente implícito corresponde ao sistema não linear. Nesse caso, optou-se por utilizar a norma da mudança da solução ao longo dos passos de tempo ∆X X < , (4.34) em que X é a solução e ∆X é a diferença entre a solução atual em relação à iteração anterior −8 do solver não linear. Para resolver os problemas desta trabalho, especiﬁcou-se valor 10 para essa tolerância.
Quanto ao método IMPES, a única tolerância a ser especiﬁcada diz respeito ao sistema linear de cálculo da pressão. Atribuiu-se, nesse caso, o mesmo critério do solver não linear do método totalmente implícito. Ao método sequencial também atribuiu-se o mesmo criério de convergência. Neste último, contudo, após resolver o sistema linear da pressão, segue-se a atualização das mobilidades e nova resolução do sistema linear até que a solução mude menos que uma tolerância. Para isso, utilizou-se como critério a razão entre a norma inﬁnita do campo de pressão atual e a norma inﬁnita do campo de pressão obtido no passo na iteração anterior, i.e., utlizou-se a expressão presta a impedir que o programa continue sendo executado indeﬁnidamente nos casos de divergência. Conforme explicado na seção anterior, caso isso ocorra a solução correspondente a esse mesmo nível de tempo é recalculada com um passo de tempo inferior.


RESULTADOS Neste capítulo, serão apresentados os resultados provenientes da simulação numérica do modelo descrito. Primeiramente, será apresentada a validação do simulador implementado lançando-se mão de um caso de deslocamento unidimensional em que há solução analítica disponível – o caso de Buckley-Leverett. A seguir, serão expostos os resultados obtidos para a simulação do deslocamento bidimensional em um reservatório que apresenta a conﬁguração conhecida como quarter ﬁve-spot. Por ﬁm, serão apresentados os resulta-dos provenientes da simulação do deslocamento tridimensional em uma malha híbrida.
5.1 DESLOCAMENTO UNIDIMENSIONAL 5.1.1 DESCRIÇÃO DO PROBLEMA Considera-se uma amostra de rocha homogênea inicialmente embebida em óleo na qual injeta-se água a uma vazão constante através de uma de suas fronteiras, conforme ilustrado na ﬁgura 5.1. Se a vazão de água for suﬁcientemente alta, a inﬂuência da pressão capilar diminui de tal forma que o problema pode ser modelado como um processo de deslocamento unidimensional do tipo que permite uma solução analítica (Hurtado, 2005).
Figura 5.1: Conﬁguração do problema de deslocamento unidimensional A equação que modela o escoamento na direção do eixo x é dada por (Maliska et al., 
2015): (5.1) em que Ff é o ﬂuxo fracionário deﬁnido por (5.2) É possível mostrar que a solução analítica para essa problema depende do ﬂuxo fracionário, o qual, por sua vez, é determinado pelas curvas de permeabilidade relativa e pela relação entre as viscosidades (Maliska et al., 2015).
Para os exemplos apresentados nesta seção foram empregadas as curvas de permea-blidade descritas dadas pelo modelo de Corey – descrito no capítulo 2 – com coeﬁciente unitário e expoente 2, isto é, (5.3) (5.4) A saturação ˆS normalizada é calculada por (5.5) em que as saturações mínimas e máximas de água foram tomadas como 0 e 1, respectivamente. Já a relação entre as viscosidades é dada, neste problema, por (5.6) À porosidade foi atribuído o valor unitário. As curvas de permeabilidade relativa e ﬂuxo fracionário podem ser visualizadas na ﬁgura 5.2.
Outro parâmetro presente na equação (5.1) é a velocidade total v T , que consiste na soma das velocidades das duas fases na direção x . Pois que nesse caso a equação de conservação é simpliﬁcada para (5.7) e a velocidade prescrita na fronteira x = 0 é constante, pode-se aﬁrmar que essa velocidade é constante ao longo do domínio (Hurtado, 2005).

Figura 5.2: Curvas de permeabilidade e ﬂuxo fracionário (a) Curvas de permeabilidade relativa (b) Fluxo fracionário em função da saturação Fonte: do autor 5.1.2 SOLUÇÃO ANALÍTICA A ﬁm de obter a solução analítica, as variáveis do problema são adimensionalizadas. As versões adimensionais da coordenada axial do domínio e do tempo são, respectivemente (5.8) Dado isso, a equação (5.1) pode ser escrita na forma (5.9) Deﬁnindo, ainda, o parâmetro (5.10) a equação (5.9) se torna uma equação diferencial ordinária: (5.11) A solução analítica dessa equação é (Dullien, 1979): em que (5.12) 
Si é a saturação inicial do domínio e Sf , a saturação da frente de água. Essa solução analítica é conhecida como solução de Buckley-Leverett.
5.1.3 RESULTADOS OBTIDOS A ﬁm de comparar resultados numéricos à solução analítica, especiﬁcou-se como condição inicial (5.13) (5.14) i.e., o domínio está, inicialmente, embebido com óleo. A condição de contorno para a fronteira x = 0 é de Neumann. A velocidade de água foi prescrita com valor unitário; do óleo, nulo. Já para a fronteira x = L prescreveu-se os mesmos valores de pressão e saturação iniciais. Devido ao caráter hiperbólico da equação e sabendo-se que o ﬂuido está deixando essa fronteira, nenhuma condição de saturação precisaria ser prescrita (Maliska et al., 2015). Por motivos computacionais, foi prescrito o mesmo valor das condições iniciais e faz-se uma veriﬁcação para identiﬁcar se a frente de água ainda não chegou a x = L.
Não obstante se trate de um problema unidimensional, utilizou-se um domínio bidimensional e exportou-se as soluções de todos os nós da malha. Os quatro perﬁs mostrados nos resultados são correspondentes aos instantes de tempo 0,2, 0,3, 0,4 e 0,5 VPI – equivalentes a 0,8, 1,2, 1,6 e 2,0 segundos. O VPI pode ser interpretado como um tempo adimen-t 
sional em um problema de deslocamento é o volume poroso injetado e é dado por (Ql )entdt φdV VPI = Volume de ﬂuido injetado volume poroso disponível = 
, (5.15) V em que (Ql )ent é a vazão injetada no meio poroso.
As soluções analíticas correspondentes a esses tempos foram comparadas às soluções numéricas advindas dos métodos IMplicit pressure, Explicit Saturation, sequencial e totalmente implícito, identiﬁcados nos gráﬁcos, respectivamente, pelas siglas FIM, IMPES e SEQ. Os resultados numéricos foram obtidos empregando três malhas com diferentes graus de reﬁno, todas compostas por elementos triangulares. A mais grosseira possui 430 nós; a mediana, 1961; a mais reﬁnada, 7392. Essas malhas podem ser visualizadas na ﬁgura 5.3. Os resultados numéricos apresentados a seguir foram obtidos considerando-se −3 segundos.
um passo de tempo inicial de 10 
Figura 5.3: Malhas não-estruturadas utilizadas na solução do problema de Buckley-Leverett Os resultados obtidos com passo de tempo ﬁxo estão dispostos nas ﬁguras 5.4, 5.5 e 5.6 para malhas de 430, 1961 e 7392 nós, respectivamente. O tempo computacional despendido para 0,5 VPI por meio dos três métodos pode ser visualizado na ﬁgura 5.7. Nesses −3s.
casos, o passo de tempo foi mantido em seu valor inicial de 10 Já os resultados obtidos para o critério mais rígido de passo de tempo estão dispostos nas ﬁguras 5.8, 5.9 e 5.10 para malhas de 430, 1961 e 7392 nós, respectivamente. O tempo computacional despendido para 0,5 VPI por meio dos três métodos pode ser visualizado na ﬁgura 5.11. A evolução dos passos de tempo estão dispostas nas ﬁguras 5.12, 5.13 e 5.14.
Por ﬁm, os resultados obtidos para o critério menos rígido de passo de tempo estão dispostos nas ﬁguras 5.15, 5.16 e 5.17 para malhas de 430, 1961 e 7392 nós, respectivamente.
O tempo computacional despendido para 0,5 VPI por meio dos três métodos pode ser visualizado na ﬁgura 5.18. A evolução dos passos de tempo estão dispostas nas ﬁguras 5.19, 5.20 e 5.21.
Ainda, os campos de saturação e pressão obtidos por meio do método totalmente implícito com o critério mais rígido de passo de tempo adaptativo e na malha mais reﬁnada estão ilustrados na ﬁgura 5.22 para 0,2, 0,3, 0,4 e 0,5 VPI. Os resultados são associados às curvas correspondentes ao método FIM na ﬁgura 5.10.

Figura 5.4: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malha de 430 nós Fonte: do autor Figura 5.5: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malha de 1961 nós Fonte: do autor 
Figura 5.6: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malha de 7392 nós Fonte: do autor Figura 5.7: Tempo computacional para os três métodos com passo de tempo ﬁxo Fonte: do autor 
Figura 5.8: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempo adaptativo em uma malha de 430 nós Fonte: do autor Figura 5.9: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempo adaptativo em uma malha de 1961 nós Fonte: do autor 
Figura 5.10: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempo adaptativo em uma malha de 7392 nós Fonte: do autor Figura 5.11: Tempo computacional para os três métodos com critério mais rígido de passo de tempo adaptativo Fonte: do autor 
Figura 5.12: Evolução do passo de tempo para a malha de 430 nós com critério mais rígido de passo de tempo adaptativo Fonte: do autor Figura 5.13: Evolução do passo de tempo para a malha de 1961 nós com critério mais rígido de passo de tempo adaptativo Fonte: do autor 
Figura 5.14: Evolução do passo de tempo para a malha de 7392 nós com critério mais rígido de passo de tempo adaptativo Fonte: do autor Figura 5.15: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo de tempo adaptativo em uma malha de 430 nós Fonte: do autor 
Figura 5.16: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo de tempo adaptativo em uma malha de 1961 nós Fonte: do autor Figura 5.17: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo de tempo adaptativo em uma malha de 7392 nós Fonte: do autor 
Figura 5.18: Tempo computacional para os três métodos com critério menos rígido de passo de tempo adaptativo Figura 5.19: Evolução do passo de tempo para a malha de 430 nós com critério menos rígido de passo de tempo adaptativo Fonte: do autor 
Figura 5.20: Evolução do passo de tempo para a malha de 1961 nós com critério menos rígido de passo de tempo adaptativo Fonte: do autor Figura 5.21: Evolução do passo de tempo para a malha de 7392 nós com critério menos rígido de passo de tempo adaptativo Fonte: do autor 
Figura 5.22: Campos de saturação e pressão para os instantes de tempo 0,2, 0,3 0,4 e 0,5 VPI Fonte: do autor Para todos os critérios de passo de tempo adaptativo, as soluções numéricas apresentam o comportamento esperado, i.e., os perﬁs numéricos de saturação se aproximam ao perﬁl correspondente à solução analítica à medida que a malha é reﬁnada. Entretanto, até mesmo na malha mais reﬁnada há considerável presença de difusão numérica, a qual é responsável pela suavização da discontinuidade dos perﬁs. Hurtado (2005) aﬁrma que esse é o preço que deve ser pago pela garantia de soluções ﬁsicamente coerentes e que, neste caso, a difusão numérica advém da interpolação de primeira ordem utilizada nos termos advectivos.
Quanto à evolução do passo de tempo, infere-se que o esquema de passo de tempo adaptativo pode ser responsável por considerável redução do tempo computacional, pois que permite-se um acréscimo de seu valor até que isso não afete a obtenção de uma solução estável. Além disso, conforme esperado, o passo de tempo deve ser reduzido à medida que a malha é reﬁnada, conforme expõem as ﬁguras 5.12, 5.13, 5.14, 5.19, 5.20 e 5.21.

Entretanto, observa-se que a utilização de um esquema de passo de tempo adaptativo pode inﬂuenciar na qualidade da solução numérica obtida. Quando esse esquema não é aplicado as soluções determinadas pelos três métodos praticamente coincidem – 5.4, 5.5 e 5.6. A solução obtida por meio do método totalmente implícito não é afetada signiﬁcativamente quando os criérios mais e menos rígido de passo de tempo adaptativo são empregados. O método sequencial, contudo, apresenta alguns pontos distantes da curva quando o critério menos rígido de passo de tempo adaptativo é empregado – 5.15, e 5.17. Já o método IMPES apresenta uma solução mais próxima da analítica quando o critério de passo de tempo adaptativo é aplicado. Isso se deve, possivelmente, a uma condição mais próxima daquela na qual essse método fornece a solução analítica para o caso de Buckley-Leverett.
Essa condição é apresentada no apêndice A para o caso de uma malha unidimensional.
Também é explicado que o método FIM, não obstante a estabilidade incondicional, apresenta difusão numérica para quaisquer combinações de malha e parâmetros do problema.
Os resultados obtidos neste trabalho sugerem que esse comportamento se mantém no caso de uma malha não estruturada bidimensional. Nesse caso, entretanto, as condições que permitem ao IMPES apresentar a solução analítica não podem ser obtidas de forma direta.
Mesmo se essas condições pudessem ser determinadas, ter-se-ia de especiﬁcar um passo de tempo ﬁxo, logo não seria possível satisfazê-la com o esquema de passo adaptativo.
Quanto ao tempo computacional despendido em cada simulação, infere-se que o passo de tempo adaptativo é interessante sobretudo ao método totalmente implícito, o qual permite uma redução do custo computacional sem que a solução seja signiﬁcativamente alterada. O método sequencial, muito embora tenha fornecido soluções mais rapidamente que o FIM para alguns casos, apresentou certa sensibilidade em relação ao uso de um passo de tempo adaptativo, de forma que deve-se ter cautela a aplicar essa condição para tal método. Já o método IMPES clássico se comportou bem quanto à utilização do passo de tempo adaptativo. Contudo, conforme já explicado, isso pode ser devido a um caráter particular do problema unidimensional de Buckley-Leverett.

5.2 DESLOCAMENTO BIDIMENSIONAL EM CONFIGURAÇÃO QUARTER FIVE-SPOT 5.2.1 DESCRIÇÃO DO PROBLEMA Considera-se uma amostra de rocha quadrada, homogênea, inicialmente embebida em óleo e na qual injeta-se água a uma vazão constante através de um poço injetor e produz-se óleo a partir de um poço produtor que opera com pressão constante, conforme ilustrado na ﬁgura 5.23.
Figura 5.23: Conﬁguração do problema de deslocamento bidimensional Fonte: modiﬁcado de (Maliska et al., 2015) A conﬁguração desse problema é conhecida como quarter ﬁve-spot, pois que representa um quarto de um domínio quadrado em que há quatro poços produtores nos vértices e um poço injetor no centro (Aziz & Settari, 1979). Os dados de entrada utilizados no problema estão listados na tabela 5.1. A injeção de água ao longo do tempo especiﬁcado corresponde a cerca de 48% do volume poroso injetado. O modelo de permeabilidade relativa considerado foi o modelo de Corey com coeﬁciente unitário e expoente quadrático, ou seja, (5.16) (5.17) As saturações mínima e máxima de água e óleo foram especiﬁcadas como 0 e 1, respectivamente e o campo de pressão inicial é nulo.

Tabela 5.1: Dados do problema de deslocamento bifásico bidimensional Fonte: do autor 5.2.2 RESULTADOS OBTIDOS A seguir serão apresentados alguns resultados obtidos para o problema descrito. Os resultados numéricos advindos de cada método – IMPES, totalmente implícito e sequencial – serão apresentados e comparados entre si. Foram empregadas três malhas computacionais com diferentes graus de reﬁno – 425, 1483 e 5985 nós – compostas apenas de elementos triangulares. Essas malhas podem ser visualizadas na ﬁgura 5.24. Os valores de índice −11 m3 para as −11 m3, 3,25968.10 −11 m3 e 6,18471.10 de poço utilizados foram 2,85208.10 malhas de 425, 1483 e 5985 nós, respectivamente.
Figura 5.24: Malhas não-estruturadas utilizadas na solução do problema quarter ﬁve-spot Os critérios de convergência e as tolerâncias utilizadas foram idênticos àqueles especiﬁcados no caso de deslocamento unidimensional. Neste caso utilizou-se apenas o esquema mais rídido de passo de tempo, o qual tem seus parâmetros listados na tabela 4.1.

Os resultados obtidos para a malha mais grossa – de 425 nós – sem e com a utilização do passo de tempo adaptativo podem ser visualizados, respectivamente, nas ﬁguras 5.25 e 5.26. No caso de passo de tempo ﬁxo, seu valor foi mantido constante e igual a 1 dia. No caso em que é utilizado o esquema de passo de tempo adaptativo, esse valor corresponde ao passo de tempo inicial. As primeiras curvas expostas são a pressão média ao longo do tempo e a taxa de produção de óleo. A terceira curva corresponde ao corte de água – razão entre a vazão de água e a vazão total no poço. A quarta curva correlaciona o volume poroso injetado à eﬁciência de varrido horizontal – razão entre o volume de óleo produzido e o volume injetável. Quando se dispõem de curvas de eﬁciência de varrido horizontal, para se obterem os valores reais para um determinado reservatório basta multiplicar os valores adimensionais que podem ser lidos na ﬁgura pelo volume deslocável do meio poroso em estudo (Rosa et al., 2006). Em decorrência de sua deﬁnição, essa curva é idêntica à de saturação média no domínio. Por ﬁm, a última curva apresenta a evolução do passo de tempo da simulação. Os tempos computacionais despendidos sem e com a utilização do passo de tempo adaptativo estão listados, respectivamente, nas tabelas 5.2 e 5.3.
Os mesmos resultados também foram obtidos para uma malha de 1483 nós e estão dispostos, sem e com a utilização do passo de tempo adaptativo, respectivamente, nas ﬁguras 5.27 e 5.28. Para esse caso, o passo de tempo inicial especiﬁcado foi de 0,5 dia quando utilizado o esquema de passo de tempo adaptativo. Quando não utilizado, seu valor foi mantido em 0,5 dia. Os tempos computacionais despendidos sem e com a utilização do passo de tempo adaptativo estão listados, respectivamente, nas tabelas 5.4 e 5.5.
Por ﬁm, também foram calculados os mesmos resultados para a malha mais reﬁnada – de 5985 nós. Esses resultados estão dispostos, sem e com a utilização do passo de tempo adaptativo, respectivamente, nas ﬁguras 5.29 e 5.30. Para essa conﬁguração, o passo de tempo foi mantido em 0,05 dia quando não utilizada a estratégia de passo de tempo adaptativo. Quando utilizada, esse foi o valor especiﬁcado como passo de tempo inicial. Os tempos computacionais despendidos sem e com a utilização do passo de tempo adaptativo estão listados, respectivamente, nas tabelas 5.6 e 5.7.
Ademais, os campos de saturação e pressão no instante de breakthrough estão ilustrados na ﬁgura 5.31. A partir desse instante, o poço produtor passa a produzir não apenas óleo, mas também água (Rosa et al., 2006). Já a ﬁgura 5.32 exibe os campos de saturação obtidos pelo método totalmente implícito, com passo de tempo ﬁxo e com a malha mais reﬁnada para os instantes de tempo de 500, 1500, 3000 e 5000 dias.

Figura 5.25: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e uma malha de 425 nós (e) Curva de passo de tempo Fonte: do autor Tabela 5.2: Tempo computacional – passo de tempo ﬁxo e malha de 425 nós FIM IMPES 46,7706 s SEQ 481,315 s 206,893 s Fonte: do autor 
Figura 5.26: Resultados obtidos para o deslocamento bidimensional com passo de tempo adaptativo e uma malha de 425 nós (e) Curva de passo de tempo Fonte: do autor Tabela 5.3: Tempo computacional – passo de tempo adaptativo e malha de 425 nós 
Figura 5.27: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e uma malha de 1483 nós (e) Curva de passo de tempo Fonte: do autor Tabela 5.4: Tempo computacional – passo de tempo ﬁxo e malha de 1483 nós 
Figura 5.28: Resultados obtidos para o deslocamento bidimensional com passo de tempo adaptativo e uma malha de 1483 nós (e) Curva de passo de tempo Fonte: do autor Tabela 5.5: Tempo computacional – passo de tempo adaptativo e malha de 1483 nós 
Figura 5.29: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e uma malha de 5985 nós (e) Curva de passo de tempo Fonte: do autor Tabela 5.6: Tempo computacional – passo de tempo ﬁxo e malha de 5985 nós 
Figura 5.30: Resultados obtidos para o deslocamento bidimensional com passo de tempo adaptativo e uma malha de 5985 nós (e) Curva de passo de tempo Fonte: do autor Tabela 5.7: Tempo computacional – passo de tempo adaptativo e malha de 5985 nós 
Figura 5.31: Campos de pressão e saturação no instante de breakthrough Fonte: do autor Figura 5.32: Campos de saturação para os instantes de tempo de 500, 1500, 3000 e 5000 dias 
Observa-se que a curva de eﬁciência de varrido horizontal apresenta dois trechos distintos – uma reta correspondente à função identidade e uma curva tendendo a se tornar horizontal. O tempo associado à transição entre esses dois trechos é o instante de breakthrough (BT).
Quanto à curva de pressão, veriﬁca-se que seu valor máximo não ocorre quando a rocha está saturada de óleo. Tem-se uma curva de pressão média crescente até atingir seu valor máximo e, a partir de então, a curva passa a ser decrescente. Esse comportamento decorre da utilização de um modelo de permeabilidade relativa quadrático, pois que com esse modelo o mínimo valor de mobilidade total ocorre quando a saturação de óleo é menor que a unidade.
Pode-se inferir dos resultados que o métodos IMPES apresenta instabilidades na solução numérica correspondente após o breakthrough. Essas instabilidades ocorrem porque esse esquema não itera na não linearidade existente entre pressão e saturação, de modo que o valor da saturação utilizada para calcular a vazão de ﬂuido produzida é o do tempo anterior. Isso pode levar a inconsistências físicas no instante de tempo em que se passa a produzir água. Nesse instante, os volumes de controle ao redor do poço produtor apresentam saturação de água relativamente elevada, levando a uma vazão de água entrando no volume de controle do poço também relativamente alta. Porém, a vazão de água produzida no poço ainda é baixa, pois a saturação de água nesse volume é a do instante anterior, que é pequena. Ou seja, a diferença entre as vazões entrando e saindo do volume de controle é alta. Caso passos de tempo grandes sejam utilizados, a variação da saturação será tam-bém relativamente alta (e possivelmente não física). No próximo passo de tempo ter-se-ia, pois, mobilidade da água com valor elevado, levando a uma produção de água excessiva, que leva a uma redução demasiada da saturação. Desse modo, a saturação de água no volume de controle do poço ﬁca instável, alternando entre valores altos e baixos. Essas instabilidades podem ser reduzidas substancialmente modiﬁcando o IMPES clássico para o método sequencial. Contudo, isso se dá às custas da necessidade um maior tempo de computação.
Já o método totalmente implícito apresenta soluções estáveis não obstante a utilização do esquema de passo de tempo adaptativo. Ademais, essa estratégia permitiu uma redução signiﬁcativa do custo computacional correspondente ao método FIM, que com passo de tempo ﬁxo era o que mais demandava tempo computacional e com passo de tempo adaptativo ﬁcou menos custoso que o método sequencial. Ressalta-se que embora o IMPES tenha sido o método menos custoso em todos os casos, sua solução só apresentou estabi- 
lidade em casos de passo de tempo ﬁxo. Além disso, o custo computacional de utilizar o método totalmente implícito com passo de tempo adaptativo ﬁcou da mesma ordem do custo correspondente à utilização da formulação IMPES sem o passo de tempo adaptativo e ambos os métodos apresentaram soluções estáveis e consistentes. Portanto, foi possível tirar proveito da robustez do FIM no intuito de utilizar passos de tempo mais elevados e por conseguinte reduzir o tempo despendido na simulação numérica. Os tempos computacionais despendidos estão sumarizados por meio de gráﬁcos na ﬁgura 5.33.
Almejando analisar mais pormenorizadamente a inﬂuência do esquema de passo de tempo adaptativo na solução numérica obtida por meio do método totalmente implícito, foram comparados os resultados advindos de três tratamentos distintos do passo de tempo – passo de tempo ﬁxo, critério mais rígido e critério menos rígido. Os parâmetros associados a esses critérios já foram explicados e podem ser encontrados nas tabelas 4.1 e 4.2.
Para realizar essa comparação, optou-se por utilizar a malha mais grossa, a qual possui 425 nós. Os resultados obtidos estão expostos na ﬁgura 5.34. Os tempos computacionais despendidos na obtenção de tais soluções estão listados na tabela 5.8.
Fonte: do autor Tabela 5.8: Tempo computacional despendido com o método FIM 
Pode-se inferir dos resultados obtidos que o emprego do passo de tempo adaptativo reduziu o tempo computacional em uma ordem. Além disso, do critério mais rígido para o menos rígido veriﬁcou-se uma redução de cinco vezes nesse tempo despendido. Não obstante essa redução esteja inevitavelmente em conjunto com uma maior difusão numérica e por conseguinte menor capacidade de capturar gradientes elevados, todas as soluções apresentadas são ﬁsicamente consistentes. Logo, é evidente que a escolha do esquema de passo de tempo adaptativo a ser utilizado está fortemente relacionado com a precisão com a qual se deseja solucionar o problema.

5.3 DESLOCAMENTO TRIDIMENSIONAL EM MALHA HÍBRIDA 5.3.1 DESCRIÇÃO DO PROBLEMA O problema de deslocamento bifásico tridimensional será simulado em uma malha não-estruturada híbrida com o formato aproximado do território brasileiro. Trata-se de um processo de recuperação secundária de óleo em um reservatório tridimensional no qual há três poços injetores e dois produtores, conforme esquematizado na ﬁgura 5.35.
Figura 5.35: Conﬁguração do problema tridimensional Fonte: do autor Os três poços injetores são verticais e atravessam integralmente a espessura do reservatório. Os dois poços produtores, por sua vez, são direcionais. Em torno de cada um dos poços a malha tem formato cilíndrico acompanhando a trajetória da linha que representa o poço, conforme ilustrado na ﬁgura 5.36. Todas as fronteiras do reservatório são impermeáveis. Tanto as informações relacionadas à malha quanto os dados de entrada estão listados na tabela 5.9.
O modelo de permeabilidade relativa é o mesmo que aquele utilizado nos casos anteriores, i.e., modelo de Corey com expoente quadrático e coeﬁciente unitário. Ainda, o problema foi resolvido em termos de potenciais. A ﬁm de obter o campo de pressão poder- 
Figura 5.36: Ilustração da malha cilíndrica ao redor dos poços Tabela 5.9: Dados do problema de deslocamento bifásico tridimensional se-ia fazer um pós processamento a partir dos dados de densidades das fases e aceleração devida à gravidade. As saturações mínima e máxima de água e óleo foram especiﬁcadas como 0 e 1, respectivamente e os campos inciais de pressão e saturação são nulos. Os critérios de convergência e as tolerâncias especiﬁcadas para este problema também foram iguais àqueles utilizados nos problemas anteriores. Já os valores de índice de poço utiliza-−13 m3 e 3,92357.10 −13 m3.
dos para os poços 1 e 2 foram, respectivamente, 3,05816.10 
5.3.2 RESULTADOS OBTIDOS A seguir, os resultados numéricos advindos de cada método – IMPES, totalmente implícito e sequencial – serão apresentados e comparados entre si. Uma vez que foi observado, a partir dos resultados obtidos para o deslocamento bidimensional, que o método IMPES é signiﬁcativamente sensível ao esquema de passo de tempo adaptativo implementado, optou-se por utilizar passo de tempo ﬁxo quando este método for empregado. Quanto ao método sequencial, veriﬁcou-se que sua limitação quanto ao passo de tempo utilizado após o instante de breakthrough é severa a ponto de ser mais vantajoso especiﬁcar passo de tempo ﬁxo. Sendo assim, apenas para o método FIM foi empregado o esquema de passo de tempo variável mais rígido, cujos parâmetros estão listados na tabela 4.1.
Os resultados obtidos para 3000 dias de simulação podem ser visualizados na ﬁgura 5.37. As primeiras curvas expostas são a pressão e saturação média ao longo do tempo. As terceira e quarta curvas correspondem à produção de óleo e ao corte de água, respectivamente. A quinta curva correlaciona o volume injetado adimensional injetado à eﬁciência de varrido horizontal. Já a última curva apresenta a evolução do passo de tempo da simulação. Por ﬁm, os tempos computacionais despendidos estão listados na tabela 5.10.
Quanto à solução numérica, infere-se que os três métodos apresentam soluções coerentes e quase coincidentes. O método FIM, contudo, apresenta expressiva vantagem em relação ao tempo computacional necessário à simulação do problema, tendo em vista que despendeu apenas 7,69% do tempo computacional gasto pelo método IMPES e 2,96%, do sequencial. É interessante veriﬁcar que em nenhum momento foi necessária uma redução do passo de tempo adaptativo quando se empregou a formulação totalmente implícita.
A ﬁm de explorar ainda mais as potencialidades do método totalmente implícito, foram obtidos resultados para 10000 dias de simulação apenas com esse método, os quais podem ser visualizados na ﬁgura 5.38. As ﬁguras ﬁgura 5.39 e ﬁgura 5.40 ilustram, respectivamente, os campos de saturação e pressão para seis instantes de tempo – 496, 997, 3010 e 5000, 7013 e 10000 dias. Em ambas as ﬁguras foi realizado um corte na malha a ﬁm de prover uma melhor visualização da região próxima aos poços injetores. Os campos ﬁnais de saturação e pressão – para 10000 dias – podem ser visualizados na ﬁgura 5.41. O tempo computacional despendido nesse caso foi de 18909,8 segundos, apenas cerca de 12% a mais que o tempo necessário para simular 3000 dias. Percebe-se, assim, que lançando-se mão de um esquema de passo de tempo adaptativo foi possível utilizar-se da robustez da formulação totalmente implícita a ﬁm de prover uma simulação menos custosa.

Fonte: do autor Tabela 5.10: Tempo computacional despendido Fonte: do autor 
(e) Curva de passo de tempo Fonte: do autor 
Figura 5.39: Campo de saturação para quatro instantes de tempo Figura 5.40: Campo de pressão para quatro instantes de tempo 
Figura 5.41: Campos ﬁnais de pressão e saturação Fonte: do autor 

CONCLUSÃO 6.1 SUMÁRIO Neste trabalho foram expostos o estudo e a implementação de um simulador bifásico, imiscível, isotérmico e incompressível destinado à simulação numérica do deslocamento de ﬂuidos em reservatórios de petróleo. Foram apresentadas e comparadas três formulações distintas – método totalmente implícito, IMPES clássico e sequencial – em termos de estabilidade, acuracidade e tempo computacional. Utilizou-se o método dos volumes ﬁnitos baseado em elementos, o qual proporciona uma maior ﬂexibilidade para a representação geométrica de reservatórios. Ainda, foi implementado um esquema de passo de tempo adaptativo a ﬁm de veriﬁcar tanto a sensibilidade de cada método em relação a esse esquema quanto a capacidade de reduzir os tempos computacionais despendidos nas simulações.
Os métodos IMPES clássico e sequencial foram adaptados a partir do código desenvolvido em (Grein, 2015) e disponibilizado na EFVLib. Nessas formulações, a pressão é resolvida de forma implícita; a saturação, explícita. A diferença entre ambos é que o método sequencial atualiza os coeﬁcientes do sistema linear da pressão e resolve novamente os campos de pressão e saturação até que a alteração de seus valores seja inferior a uma tolerância especiﬁcada.
O método totalmente implícito ou FIM (Fully implicit method) foi implementado integralmente. Nessa formulação, as variáveis são resolvidas simultaneamente. Para isso, fez-se necessária a integração de um método capaz de resolver um sistema não-linear de equações à EFVLib. A implementação desse solver não-linear na EFVLib consistiu em uma das grandes contribuições deste trabalho. Foi adotado o método de Newton-Raphson, o qual foi implementado com o suporte da biblioteca PETSc (Balay et al., 2013). A utilização do método disponível na biblioteca, contudo não foi direta. Foram construidos e informados, manualmente, o vetor resíduo e a matriz jacobiana. O algoritmo de montagem da matriz jacobiana consiste na parte mais custosa e complexa do código computacional.
Além disso, o procedimento realizado para calcular corretamente as derivadas numéricas que compõem essa matriz demandou um estudo especial em se tratando do método dos volumes ﬁnitos baseado em elementos, o qual se fundamenta em varreduras de elementos da malha computacional.

As três metodologias abordadas foram analisadas por meio de três exemplos de aplicação. O primeiro foi destinado à validação do simulador. Trata-se de um caso de deslocamento unidimensional em uma amostra de rocha no qual é possível calcular uma solução analítica – a solução de Buckley-Leverett. O segundo exemplo de aplicação foi o deslocamento bidimensional em conﬁguração ﬁve-spot, a qual é amplamente empregada em estudos relacionados à simulação numérica de reservatórios de petróleo. Já o ultimo caso analisado foi o deslocamento tridimensional em uma malha híbrida.
6.2 CONCLUSÕES O primeiro caso avaliado, de deslocamento unidimensional através de um meio poroso, possibilitou a veriﬁcação das três metologias utilizadas. As soluções numéricas apresentaram o comportamento esperado quanto ao reﬁno de malha, i.e., os perﬁs numéricos de saturação se aproximaram do perﬁl correspondente à solução analítica à medida que a malha foi reﬁnada. Entretanto, até mesmo na malha mais reﬁnada há considerável presença de difusão numérica, a qual é responsável pela suavização da discontinuidade dos perﬁs. Quanto à evolução do passo de tempo, inferiu-se que o esquema de passo de tempo adaptativo pode ser responsável por signiﬁcativa redução do tempo computacional. Além disso, conforme esperado, o passo de tempo deve ser reduzido à medida que a malha é reﬁnada. Veriﬁcou-se, também, que sua utilização pode inﬂuenciar demasiadamente a qualidade da solução numérica obtida. Quando esse esquema não foi adotado, as soluções determinadas por meio dos três métodos praticamente coincidiram. A solução obtida por meio do método totalmente implícito não foi afetada signiﬁcativamente quando os critérios de passo de tempo adaptativo foram empregados. O método sequencial, contudo, apresentou sensibilidade ao critério menos rígido. Já o método IMPES apresentou uma solução mais próxima da analítica quando o critério de passo de tempo adaptativo foi aplicado. Isso se deve, possivelmente, a uma condição mais próxima daquela na qual essse método fornece a solução analítica para o caso de Buckley-Leverett. Quanto ao tempo computacional despendido em cada simulação, infere-se que o passo de tempo adaptativo é interessante sobretudo ao método totalmente implícito, o qual é capaz de resolver o problema mais rapidamente sob essa condição sem que a solução seja demasiadamente alterada. O método sequencial, muito embora tenha fornecido soluções mais rapidamente que o FIM para alguns casos, apresentou certa sensibilidade em relação ao uso de um passo de tempo adaptativo, de forma que deve-se ter cautela a aplicar essa condição para tal mé- 
todo. Já o método IMPES clássico se comportou bem quanto à utilização do passo de tempo adaptativo. Contudo, isso pode ser devido a um caráter particular do problema unidimensional de Buckley-Leverett.
O segundo caso analisado, de deslocamento em conﬁguração quarter ﬁve-spot, foi utilizado a ﬁm de comparar os três métodos quanto ao desempenho e à sensibilidade em relação ao esquema de passo de tempo adaptativo em um problema bidimensional. Quando empregado o esquema de passo de tempo adaptativo, o método IMPES apresentou instabilidades na solução numérica após o instante de breakthrough. Essa instabilidade pode ser reduzida substancialmente modiﬁcando o IMPES clássico para o método sequencial.
Contudo, isso se dá às custas da necessidade um maior tempo de computação. O método totalmente implícito, por sua vez, não apresentou tamanha sensibilidade em relação à esse esquema, provendo soluções consistentes tanto com passo de tempo ﬁxo, quanto variável.
Ainda, o tempo computacional despendido por esse método foi aproximadamente dez vezes inferior quando utilizou-se o critétio de passo de tempo adaptativo proposto. Além disso, a utlização dessa estratégia permitiu que o método FIM, que demandava o maior custo computacional com passo de tempo ﬁxo, chegasse a um custo menor que aquele despendido pelo método sequencial quando foi utilizado o passo de tempo adaptativo.
Ressalta-se ainda que os tempos de simulação correspondentes ao método totalmente implícito com passo de tempo adaptativo ﬁcaram da mesma ordem daqueles correspondentes à utilização da formulação IMPES com passo de tempo ﬁxo e ambos os métodos apresentaram soluções estáveis e consistentes. Portanto, conseguiu-se tirar proveito da robustez do FIM no intuito de utilizar passos de tempo mais elevados e, assim, reduzir o tempo demandado pela simulação numérica.
O terceiro caso analisado, de deslocamento tridimensional em uma malha híbrida, possibilitou a veriﬁcação de que, no caso de um problema tridimensional, os métodos IMPES e sequencial são severamente limitados quanto ao máximo passo de tempo que pode ser utilizado, sobretudo em decorrência de um maior grau de reﬁno nas regiões próximas aos poços. À luz dos resultados previamente obtidos, optou-se, nesse caso, por especiﬁcar um passo de tempo ﬁxo aos métodos IMPES e sequencial a ﬁm de evitar instabilidades nas soluções numéricas e utilizar o esquema de passo de tempo adaptativo no caso do método totalmente implícito no intuito de reduzir o tempo computacional consumido por essa formulação. Os resultados obtidos praticamente coincidiram para os três métodos. O FIM, contudo, foi capaz de prover as soluções com um custo computacional muito inferior em relação aos outros métodos – apenas 7,69% do tempo despendido pela formulação IMPES e 2,96%, do método sequencial. Certamente, esses resultados podem servir a enco- 
rajar futuros desenvolvimentos que utilizem o método totalmente implícito em conjunto com o método dos volumes ﬁnitos baseado em elementos.
6.3 SUGESTÕES PARA TRABALHOS FUTUROS Para estudo subsequentes quanto ao tema abordado neste trabalho recomenda-se: • Estudar esquemas de passo de tempo adaptativo a ﬁm de reduzir a sensibilidade dos métodos IMPES clássico e sequencial à sua utilização; • Paralelizar o simulador implementado a ﬁm de melhorar seu desempenho quanto ao tempo computacional empregado nas simulações; • Introduzir um modelo físico mais complexo no simulador; • Incluir a equação da energia no modelo proposto; • Acoplar modelos de geomecânica ao modelo proposto; 