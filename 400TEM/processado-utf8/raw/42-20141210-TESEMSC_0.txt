Capítulo 4 4 Fundamentos Teóricos Neste capítulo são introduzidos os conceitos fundamentais utilizado na síntese de controladores apresentada no Capítulo 5. Estes fundamentos teóricos são as ferramentas manipuladas quando da redefinição da estratégia de controle para cada modelo desenvolvido, aplicado e testado. Por fim, tão embora os exemplos trabalhados no decorrer deste capítulo não correspondam a um modelo de controlador específico desenvolvido posteriormente, estes exemplos servem como base para guiar o entendimento do funcionamento do sistema VASPS no tocante às características e variáveis relevantes para o sistema de controle, de forma que a lógica apresentada corresponde à realidade física proposta e delimitada no Capítulo 3.
4.1 Introdução à Teoria de Conjuntos Nebulosos A Teoria de Conjuntos Nebulosos pode ser aplicada a sistemas de controle, provendo uma abordagem prática. Nesta abordagem é importante a formação de uma Base de Conhecimento onde o comportamento do sistema – as Regras – e as informações sobre as variáveis – os Dados – devem ser traduzidas de uma forma matemática.
Conforme proposto por Riid (2002), um sistema que utiliza a Teoria de Conjuntos Nebulosa pode ser representado pelo esquema da Figura 4.1.

Figura 4.1 Sistema nebuloso genérico, adaptado de Riid (2002).
Na Figura 4.1, o primeiro bloco, à esquerda, identifica a etapa de transformação dos dados reais, numéricos, em dados do sistema nebuloso, lingüísticos. Esta transformação de variáveis pode ser chamada de Nebulização (ou Fuzzificação, como na referência apresentada). Após esta transformação, as variáveis numéricas tornam-se variáveis lingüísticas, identificadas por substantivos, e possuem valores de pertinência (de 0 a 1) em ‘conjuntos nebulosos’, representados por adjetivos, que identificam o ‘valor’ daquela variável. Este processo é detalhado na seção 4.1.1 Nebulização.
Com as variáveis definidas e classificadas, uma série de regras lógicas, pertencentes a uma Base de Regras, são aplicadas através de um mecanismo de inferência, chamado de nebuloso.
Para gerar valores de saída são usados dados de um Banco de Dados que, juntamente com a Base de Regras, formam o Conhecimento sobre o sistema. Este Mecanismo de Inferência Nebuloso pode possuir diversas formas de tratar estes dados, e devem ser configurado de acordo com o sistema em questão. Detalhes são apresentados nas seções 4.1.2 e 4.1.4.
Finalmente, após a aplicação das regras e o cômputo da solução, as variáveis de saída devem ser convertidas de volta para o sistema numérico sendo necessário realizar uma ‘transformada inversa’. Este passo pode ser chamado de Desnebulização (ou Defuzzificação, como apresentado na referência). Maiores explicações se apresentam nas seções 4.1.3 e 4.1.5.
4.1.1 Nebulização Para uma melhor compreensão da lógica nebulosa é necessário remeter à teoria de conjuntos. Nesta, pode-se agrupar os elementos de cada conjunto separadamente, de forma que ao avaliar a pertinência µA(x) de uma variável x para um conjunto A em um universo X, pode-se afirmar que: 
(4.1) Desta forma, ou o elemento pertence ao conjunto A ou não pertence. Esta classificação implica que a função de pertinência µA(x) assume valores booleanos, 0 ou 1. No entanto, para diversos problemas práticos é difícil classificar uma dada variável em apenas dois valores. Por exemplo, qual o critério para classificar o nível da piscina no VASPS como ‘alto’? Ou ‘baixo’?
Ainda, se o nível da piscina é crítico no valor de 30% superior a um dado valor de referência, quão crítico este o é quando estiver em 20% superior? Para trabalhar com estes valores intermediários, que muitas vezes são relevantes, surge a teoria de conjuntos nebulosos, apresentada em Jager (1995), Passino e Yurkovich (1998) e Riid (2002). A teoria de conjuntos nebulosos admite a possibilidade de uma pertinência parcial, com um valor percentual entre 0 e 100%, diferente da noção clássica. Assim, um elemento pode pertencer a um dado conjunto com determinado grau de pertinência µA(x) dentro do intervalo [0,1].
Como exemplo, considere o sistema VASPS apresentado no Capítulo 3. A referência de coordenadas dimensionais será tratada como no sentido da emergência, ou seja, o ponto mais fundo do vaso separador equivale à cota de 0 metro. Adicionalmente, foi visto que o limite inferior de trabalho para o nível, LI, é de 20 metros, e o limite superior, LS, é de 40 metros, de forma pressupõe-se que a região ideal de trabalho seja em torno do nível de 30 metros, eqüidistante aos limites operacionais. Com isso, um conjunto nebuloso rotulado de Baixo pode caracterizar o nível da piscina de líquido do VASPS fortemente para um valor entre 20 e 30 metros, de forma que o “grau de pertinência” para o nível Baixo seja dado por uma função [ ]1,0 )( ∈h Baixoµ Baixoµ , onde h é o nível da piscina. A pertinência )(h do nível da piscina h no conjunto Baixo pode então ser descrita conforme alguma das funções representada na Figura 4.2.
Figura 4.2. Exemplo de três possíveis funções de pertinência para o conjunto nebuloso Baixo.

É possível observar pela figura que quanto menor é o valor da variável Nível da Piscina, maior é a pertinência que esta tem no conjunto Baixo. Da mesma forma, diversas podem ser as funções que classificam este conjunto, sendo mais, ou menos gradativas. No entanto, apenas uma pode ser a função que classifica o conjunto Baixo na variável Nível da Piscina, de forma que uma das três funções apresentadas – ou alguma outra – deve ser escolhida para relacionar o conjunto nebuloso em uma variável nebulosa.
A variável nebulosa Nível da Piscina, entretanto, também pode ser caracterizada por outros conjuntos nebulosos - por exemplo, Alto e Médio - podendo conter mais de um conjunto ativo, com diferentes graus de pertinência, ou seja, com diferentes participações em cada conjunto.
Desta maneira, a variável Nível da Piscina é modelada como uma variável lingüística nebulosa, assumindo valores como Alto, Baixo e Médio, chamados de rótulos lingüísticos. A variável lingüística é caracterizada pela pertinência que possui em cada um de seus conjuntos nebulosos – no caso, os conjuntos Alto, Baixo e Médio – que possuem, cada um, sua função de pertinência, que deve ser única para cada conjunto. A Figura 4.3 mostra uma possível configuração para a variável Nível da Piscina.
Figura 4.3. Representação da variável nebulosa Nível da Piscina.
Através da figura, pode-se observar que nesta modelagem da variável de entrada, foram cobertos os valores reais de entrada (que podem ser medidos com um sensor no sistema) de 20 a 40 metros de altura do líquido da piscina, considerando como referência para medição a emergência (início da medição no fundo do vaso). É possível concluir também que caso os valores estejam acima ou abaixo desta faixa, eles ativam os conjuntos extremos (Alto ou Baixo, respectivamente) com 100% de pertinência.
Outra variável que pode ser considerada para o sistema VASPS e que pode ser relevante no sistema de controle é a Variação do Nível da Piscina, como uma derivada no tempo, da variável 
anterior. Neste caso, também deve ser adotado um critério para a classificação do universo de operação da variável, a fim de cobri-lo com conjuntos nebulosos.
Supondo que a variação máxima do nível seja a vazão nominal de entrada, 1000 m³/d, sem vazão de saída, a variação de nível equivale a: (4.2) Considerando também que é necessário um bombeamento de igual taxa para manter o equilíbrio do sistema, no caso crítico inverso – bombeio a 1000 m³/d e vazão de entrada nula – o decrescimento do nível seria no valor oposto, – 4,45 cm/s. Assim, o universo de variação da nova variável será dado pelo intervalo [-5;5]. Gerando rótulos adequados, a representação desta segunda variável pode ser dada pela Figura 4.4.
Figura 4.4. Representação da variável nebulosa Variação do Nível da Piscina.
Uma vez definidas as variáveis de entrada do sistema e seu universo de valores de entrada, é possível traduzir um valor real em termos lingüísticos aplicando a transformação de variáveis, a Nebulização, conforme exemplificado na Figura 4.5, que apresenta a conversão do valor de 32 metros de altura do Nível da Piscina para o valor de 60% Médio e 40% Alto, e na Figura 4.6, que apresenta a conversão do valor – 0,8 cm/s da variável Variação do Nível da Piscina para o valor de 30% Negativa e 70% Nula.

H, Nível da Piscina [m] H, Nível da Piscina [m] Figura 4.5. Nebulização da variável de entrada Nível da Piscina.
Figura 4.6. Nebulização da variável de entrada Variação do Nível da Piscina.
O mesmo processo de definição de variáveis lingüísticas e de conjuntos nebulosos deve ser realizado para as variáveis de saída, de forma que estas sejam expressas em termos lingüísticos e cobrindo o universo conhecido para o atuador.

4.1.2 Base de Regras do tipo Mamdani Uma vez definidas as variáveis nebulosas de entrada e saída referentes a um determinado processo é possível codificar o conhecimento sobre tal por meio de regras lingüísticas condicionais, com a estrutura “Se <condição>, Então <conseqüência>”. Assim, para uma dada condição de ativação de uma variável de entrada, em que esta possua qualquer valor de pertinência diferente de zero em algum de seus conjuntos nebulosos, a conseqüência é a ativação de algum conjunto nebuloso de uma variável de saída, conforme definido pela regra lingüística.
Considerando o exemplo da seção anterior, um exemplo de regra lingüística é apresentado a seguir: “Se o Nível da Piscina é Alto, Então a Rotação da Bomba é Alta.” Esta regra aciona o conjunto nebuloso Alta da variável de saída Rotação da Bomba quando a variável Nível da Piscina possuir o conjunto Alto ativo. A partir daí, a associação de diversas regras lingüísticas compõe a Base de Regras, que determina o comportamento do sistema. Assim, dando continuidade ao exemplo da seção anterior, é possível construir um sistema nebuloso usando as mesmas duas variáveis de entrada propostas ativando uma variável de saída Rotação da Bomba, com o objetivo de manter o Nível da Piscina com a maior pertinência possível no conjunto Médio. Isso poderia ser obtido segundo a seguinte Base de Regras: 1. Se o Nível da Piscina é Baixo, Então a Rotação da Bomba é Baixa (Peso 2).
2. Se o Nível da Piscina é Médio, Então a Rotação da Bomba é Média (Peso 2).
3. Se o Nível da Piscina é Alto, Então a Rotação da Bomba é Alta (Peso 2).
4. Se a Variação do Nível da Piscina é Negativa, Então a Rotação da Bomba é Baixa (Peso 1).
5. Se a Variação do Nível da Piscina é Nula, Então a Rotação da Bomba é Média (Peso 1).
6. Se a Variação do Nível da Piscina é Positiva, Então a Rotação da Bomba é Alta (Peso 1).
Através desta Base de Regras, a leitura do Nível da Piscina garantiria que quando este começasse a subir em direção ao limite superior, LS, a BCS seria acionada com uma maior rotação e consequentemente com maior vazão, reduzindo então o volume de óleo na piscina e fazendo o nível manter o conjunto Médio ativo. O mesmo raciocínio se aplica para o abaixamento do nível.
Já a Variação do Nível segue a lógica de que se o nível diminuir (conjunto Negativa), deve-se também reduzir a rotação para que se reduza a vazão de saída, equilibrando o balanço de 
massa no transiente. Com isso, a redução de nível se daria vagarosamente, de forma a minimizar os efeitos no transiente – o que também funciona para o raciocínio inverso, de aumento de nível.
No entanto, no caso de manipulação da bomba através da variável Variação do Nível, trata-se de uma variável auxiliar, uma vez que seu status direto não necessariamente significa que seja necessária a atuação apresentada na Base de Regras. Isto ocorrerá, por exemplo, quando a Variação do Nível for Negativa e o Nível for Alto – neste caso, a saída desejada para a Rotação da Bomba é sim Alta, o que estabilizará o sistema. Claro que tão logo a correção de nível seja realizada, caso a variação se mantenha no status de negativa, desejar-se-á reduzir a vazão de saída. Assim, para conciliar as regras conflitantes, foi considerada uma diferença no peso entre as regras, provendo maior importância para as regras onde há a avaliação da variável crítica (peso 2) e menor para a variável auxiliar (peso 1).
A fim de ilustrar a aplicação dos pesos das regras no sistema, considere os conjuntos nebulosos ativos no exemplo da seção anterior e a Base de Regras proposta. Há quatro conjuntos nebulosos ativos nas variáveis de entrada, o que implica na ativação de quatro regras, com diferentes graus de ativação. Assim, é obtido o seguinte resultado de saída: 1) Conjunto Médio da variável Nível da Piscina, com pertinência 0,6.
Esta condição ativa a regra 2, ativando a variável de saída Rotação da Bomba no conjunto Média. O grau de ativação é a pertinência ativa da entrada vezes o peso da regra: Pertinência 0,6 x Peso 2 = Grau de ativação 1,2 2) Conjunto Alto da variável Nível da Piscina, com pertinência 0,4.
Esta ativa a regra 3, ativando o conjunto Alta.
Pertinência 0,4 x Peso 2 = Grau de ativação 0,8 3) Conjunto Negativa da variável Variação do Nível da Piscina, com pertinência 0,3.
Esta ativa a regra 4, ativando o conjunto Baixa.
Pertinência 0,3 x Peso 1 = Grau de ativação 0,3 4) Conjunto Nula da variável Variação do Nível da Piscina, com pertinência 0,7.
Finalmente, a última condição ativa a regra 5, ativando também o conjunto Média.
Pertinência 0,7 x Peso 1 = Grau de ativação 0,7 Assim as saídas ativas são apresentadas na Tabela 4.1.

Tabela 4.1. Aplicação da Base de Regras a uma entrada ativa.
conjuntos nebulosos de saída ativos, através da ponderação do valor relativo com o total. Assim, para a variável de saída Rotação da Bomba, os conjuntos ativos (Baixa, Média e Alta) têm a pertinência dada por: O resultado para a saída nestas condições é a figura geométrica representativa da variável Rotação da Bomba, apresentada na Figura 4.7.
F, Rotação da Bomba [Hz] F, Rotação da Bomba [Hz] Figura 4.7. Representação da variável de saída ativada pelas entradas exemplificadas.

O processo de aplicação das regras é representado na Figura 4.8, onde as contribuições para cada conjunto nebuloso de saída são apresentadas separadamente à direita, com as respectivas condições de entrada que ativaram a saída.
1) 1) 4) 4) 2) 2) 1) 1) + + 3) 3) H, Nível da Piscina [m] H, Nível da Piscina [m] H, Nível da Piscina [m] 3) 3) 2) 2) 4) 4) F, Rotação da Bomba [Hz] F, Rotação da Bomba [Hz] F, Rotação da Bomba [Hz] Figura 4.8. Representação da aplicação da Base de Regras para uma entrada dada.
Outra forma de aplicar a Base de Regras é utilizando a associação de entradas na mesma regra. Lingüisticamente, a associação de regras ou variáveis se dá através dos operadores E e OU, enquanto que matematicamente são computadas segundo a Tabela 4.2.

Tabela 4.2. Implementações mais comuns de operadores lógicos E e OU.
Pela tabela, é possível exemplificar tomando uma situação arbitrária. Considere que na Base de Regras anteriormente apresentada, o efeito da oscilação do nível apenas fosse considerado em condições específicas do nível da piscina, de forma a melhor caracterizar uma condição e conseqüentemente melhor controlar a resposta. Neste caso, a Base de Regras poderia ser reconstruída para o seguinte formato: 1. Se o Nível da Piscina é Médio, Então a Rotação da Bomba é Média (Peso 1).
2. Se o Nível da Piscina é Baixo E a Variação do Nível da Piscina é Positiva, Então a Rotação da Bomba é Média (Peso 2).
3. Se o Nível da Piscina é Baixo E a Variação do Nível da Piscina NÃO é Positiva, Então a Rotação da Bomba é Baixa (Peso 2).
4. Se o Nível da Piscina é Alto E a Variação do Nível da Piscina é Negativa, Então a Rotação da Bomba é Média (Peso 2).
5. Se o Nível da Piscina é Alto E a Variação do Nível da Piscina NÃO é Negativa, Então a Rotação da Bomba é Alta (Peso 2).
Nas regras apresentadas aparece também o operador NÃO, que tem a função de ativar a regra com o complemento do valor de pertinência do conjunto em questão, ou seja, se o conjunto é acionado com pertinência 0,3, este é não acionado em 0,7, de forma que este segundo valor é usado no cômputo do grau de ativação.
Retomando o exemplo anterior e considerando a mesma entrada (Nível da Piscina com 0,6 em Médio e 0,4 em Alto e Variação do Nível da Piscina com pertinência igual a 0,3 em Negativa e 0,7 em Nula), as regras ativas seriam as de número 1, 4 e 5, pois: • A regra de número 1 possui a entrada ativa (Nível da Piscina em Médio) com pertinência de 0,6; • A regra 4 possui ativos o Nível da Piscina em Alto com 0,4 de pertinência e a Variação do Nível da Piscina em Negativa com 0,3; • A regra 5 possui ativo o Nível da Piscina em Alto com 0,4 e possui NÃO ativa a Variação do Nível da Piscina em Negativa com 0,7; Para associar as duas entradas acionadas nas regras 4 e 5, é necessário usar alguma das regras para o operador E. Tomando ambos os casos e aplicando cada um dos critérios, as pertinências totais de entrada ficam: 
Regra 4) Regra 5) Verificam-se os diferentes níveis de conservadorismo adotados por cada critério, de forma que cada um pode ser usado de acordo com a necessidade de cada sistema. No caso desta segunda Base de Regras, como a associação das duas variáveis de entrada permitiram tratar cada condição independentemente, as alternativas configuradas são as condições críticas do sistema, e por isso o peso maior frente à regra de número 1. Então, de forma a reforçar a importância das regras associativas, escolhe-se o critério que permite o maior aumento de pertinência e conseqüentemente o acionamento mais rápido – o critério de Zadeh.
Finalmente, o grau de ativação das regras é dado pela Tabela 4.3.
Tabela 4.3. Aplicação da Base de Regras usando entradas associativas.
A saída do sistema com esta nova Base de Regras pode então ser calculada, de forma que a Rotação da Bomba é representada pela condição: 
2. Alto com pertinência de 4.1.3 Desnebulização para sistemas Mamdani Com o valor das pertinências dos conjuntos nebulosos das variáveis de saída calculados, o próximo passo é realizar a Desnebulização de forma a calcular o valor da variável no domínio do tempo para então acionar o sistema. Considerando as variáveis tomadas como exemplo na seção anterior, pode-se ilustrar o processo segundo a Figura 4.9. Repare que h é o Nível da Piscina, h& é a Variação do Nível da Piscina e f é a Rotação da Bomba, de forma que as letras minúscula representa a variável no domínio do tempo, o domínio real, e as letras maiúsculas representam as variáveis no domínio nebuloso.
Figura 4.9. Processo de conversão de variáveis exemplo do VASPS para o domínio nebuloso.
Da mesma forma que no processo de nebulização, também é necessário definir o intervalo de discurso para a variável de saída. No caso do nosso exemplo, isso pode ser feito utilizando-se a expressão para a equação da curva da bomba apresentada no Capítulo 3, Equação (3.1), bem como a curva de vazão de entrada, apresentada através do Gerador de Golfadas, na Figura 3.1 e na Figura 3.2. Considerando que é necessário acionar a bomba com uma freqüência que permite uma vazão de saída média que garanta o balanço de massa, é possível definir uma vazão igual à média do patamar inferior de vazão do gerador de golfadas, algo em torno de 750 m³/d. Os acionamentos superiores serviriam então para compensar as golfadas, e os acionamentos inferiores, para compensar a redução do nível causada pelos acionamentos sucessivos.

Assim, substituindo o valor de 750 m³/d na Equação (3.1), obtém-se uma freqüência de acionamento de aproximadamente 54 Hz – esta freqüência funcionará como o centro de faixa.
Então, considerando a oscilação de vazão entre 500 e 1000 m³/d, os valores de acionamento encontrado estão respectivamente pouco acima de 52 Hz e pouco abaixo de 56 Hz. Estes são os valores ideais com que a bomba deveria trabalhar. No entanto, nos casos mais críticos, estes valores de vazão apenas equilibrarão a vazão de entrada com a de saída, de forma que o nível se manteria estático em um nível específico. É desejado que haja a possibilidade de correção do nível da piscina, o que doravante exige o acionamento mais crítico da bomba. Tomando os acionamentos de 250 m³/d e 1200 m³/d, de forma a prover uma velocidade de correção apropriada, são encontrados os valores críticos de acionamento da bomba, 50 Hz e 58 Hz. Claro que tão embora estes estejam no universo de discurso, é desejado que não ocorra nenhum acionamento nestes patamares.
Assim, com o intervalo da variável de saída definido, deve-se determinar a desnebulização.
Há diversos métodos para tratar este processo. Comumente estes são métodos geométricos, imaginando que os conjuntos nebulosos de saída compõem uma figura com área calculável.
Assim, há tentativas de se encontrar o valor numérico em torno do qual esta figura se localiza, seja através do centro de massa (COG), do centro de área (COA), do pico da figura geométrica formada (MOM) ou desprezando parcelas de menores valores de pertinên • Centro de Gravidade (COG): calcula o centro de massa, (média ponderada) da figura.
(4.3) • Centro de Gravidade discreto (COG): a mesma técnica pode ser utilizada quando a função de pertinência é discretizada, utilizando-se a variável q como índice para a discretização.
(4.4) • Centro de Gravidade indexado (ICOG): calcula o centro de gravidade considerando apenas a região que possui valor de pertinência igual ou acima de um dado parâmetro, 
chamado de α. No exemplo, a função cut representa a remoção de área com pertinência menor que α.
(4.5) • Média do Máximo (MOM): calcula o ponto onde a região de valor de pertinência máximo (pico) é dividida pela metade.
(4.6) • Centro de Área (COA): calcula o ponto onde a área para desnebulização é dividida pela metade. Na equação, as funções inf(x) e sup(x) representam, respectivamente, o valor inferior e o valor superior da abscissa no intervalo avaliado.
(4.7) A Figura 4.10 ilustra a aplicação dos métodos de desnebulização apresentados para a variável de saída obtida nos exemplos desenvolvidos ao longo deste capítulo.
Figura 4.10. Técnicas de desnebulização aplicadas ao exemplo, com o valor de saída destacado.

4.1.4 Sistemas do tipo Sugeno Outro tipo de sistema nebuloso encontrado comumente na literatura e usado neste trabalho, é o sistema com regras do tipo Sugeno, como apresentado em Tanaka e Sugeno (1992) e Takagi e Sugeno (1985). Neste sistema, não são usados conjuntos nebulosos na saída, mas sim constantes ou funções das variáveis de entrada. Assim, a representação de uma regra poderia ser dada por: Se o Nível da Piscina é Baixo, Então a Rotação da Bomba deve ser igual a 54Hz.
Matematicamente falando, e denotando o conjunto nebuloso Baixo por HB: Note que não há conjunto nebuloso de saída. No entanto, a definição de uma função para uma dada regra permite a interpolação de diversas funções lineares simples para obter um resultado não linear complexo, ou uma representação não linear de um sistema com funcionamento linear em diversas regiões.
Assim, retomando o último exemplo de Base de Regras, apresentado no formato Mamdani, é possível convertê-la para Sugeno através da definição de valores constantes de acionamento da saída (Rotação da Bomba) para cada regra, de forma que esta poderia ser expressa da seguinte maneira: 1. Se o Nível da Piscina é Médio, Então a Rotação da Bomba é 54 Hz (Peso 1).
2. Se o Nível da Piscina é Baixo E a Variação do Nível da Piscina é Positiva, Então a Rotação da Bomba é 54 Hz (Peso 2).
3. Se o Nível da Piscina é Baixo E a Variação do Nível da Piscina NÃO é Positiva, Então a Rotação da Bomba é 50 Hz (Peso 2).
4. Se o Nível da Piscina é Alto E a Variação do Nível da Piscina é Negativa, Então a Rotação da Bomba é 54 Hz (Peso 2).
5. Se o Nível da Piscina é Alto E a Variação do Nível da Piscina NÃO é Negativa, Então a Rotação da Bomba é 58 Hz (Peso 2).
Embora os valores críticos 50 e 58 Hz estejam presentes nas regras, estes não serão diretamente acionados, uma vez que o grau de pertinência toma valores progressivos, permitindo o uso parcial do valor crítico. Para o entendimento, vide abaixo na Tabela 4.4 a aplicação das regras à mesma condição anterior de acionamento da entrada usando o critério associativo de Zadeh.

Tabela 4.4. Aplicação da Base de Regras Sugeno.
Com os graus de ativação em mãos, é possível realizar a desnebulização. Como as saídas são dadas em função de constantes, o valor final da saída é dado então pela média ponderada dos valores de acionamento pelos respectivos graus de ativação: Rotação da Bomba é igual a Diferentemente dos sistemas Mamdani, os sistemas Sugeno já provêem a resposta no domínio real diretamente, por tratar de valores numéricos reais. Entretanto, caso as variáveis de saída fossem expressas em termos de funções lineares, haveria outra forma de computar a saída, também baseado em médias ponderadas, mas como não este artifício não será usado neste trabalho, esta situação também não será aqui introduzida.
4.2 Introdução à Teoria de Controle Um sistema é representado por suas equações diferenciais, modelado de acordo com a dinâmica física que este apresenta. É considerado como sistema qualquer fenômeno que possa ser representado por uma equação – a trajetória de um projétil quando este é disparado, o comportamento do nível de um tanque em função de suas vazões de entrada e saída ou a vazão de saída de uma bomba em função da rotação de seu rotor e da carga a que está submetida. Assim, um sistema responde com uma saída y(t) para uma dada entrada x(t), podendo ser ilustrado pela Figura 4.11.
Figura 4.11. Representação de um sistema em malha aberta.

Diz-se que um sistema está em malha aberta, quando sua saída y(t) não é usada para controlar sua entrada, ou seja, quando o cômputo do sinal de entrada x(t) independe do valor de saída que o sistema apresentou. Por outro lado, se o valor da saída é monitorado e deve atingir um dado alvo, um valor desejado, é possível calcular o erro que a saída apresentou em relação a esta referência, de forma que o valor de entrada x(t+1) para o sistema é corrigido na expectativa de se reduzir o erro causado pelo valor anterior de saída. Este processo configura o sistema em malha fechada.
A teoria de controle clássico prevê que o sistema controlado deve ser um sistema em malha fechada. Assim, os sistemas controlados possuem, além do bloco representando o fenômeno físico em questão, chamado de Planta, o bloco referente ao Controlador, que irá realizar o cálculo corretivo do valor de entrada do processo no próximo instante de tempo. O sistema em malha fechada é então representado pelo diagrama de blocos da Figura 4.12.
Figura 4.12. Diagrama de blocos para um sistema em malha fechada.
Além dos dois blocos, que possuem cada um sua dinâmica representada por equações diferenciais, há os sinais característicos deste tipo de sistema, a saber: • r(t): sinal de referência, ou set point. O sistema deve ser forçado a retornar o seu sinal de saída para o valor de referência por atuação do controlador. No sistema VASPS, o sinal de referência é o nível desejado de líquido na piscina; • e(t): sinal de erro. É a diferença entre o sinal de referência e o sinal de saída; • u(t): sinal de controle, ou esforço de controle. É o sinal que corrige o processo para que este retorne à referência. A variável que sofre a ação de controle é encontrada no atuador, e é chamada de variável manipulada. No VASPS, a variável manipulada é a freqüência de rotação da BCS, que é diretamente relacionada com a vazão de saída de líquido.
• y(t): sinal de saída. É um valor medido no processo que indica seu status. A variável medida é a variável controlada. No caso, o nível real (medido) da piscina.

O problema de controle tradicional tem o objetivo de fazer a saída y(t) se comportar de uma forma desejada através da manipulação do sinal de controle u(t). Esta forma desejada é ditada pela referência r(t), de forma que o erro e(t) seja minimizado. Na literatura também é comum encontrar referências ao problema do regulador, que nada mais é que realizar o problema de controle para um sinal de referência r(t) constante, sendo usualmente nulo. Diversos exemplos podem ser encontrados na literatura, como Ogata (1996) e Skogestad e Postlethwaite (1996).
No caso do VASPS, a Planta é dada pela dinâmica de variação do nível da piscina, apresentada no Capítulo 3 pela Equação (3.4), que é função das vazões de entrada (golfadas) e saída (vazão da BCS) de líquido.
A vazão de entrada funciona como um distúrbio no sistema, causando oscilações no sinal de saída, y(t), representado pelo nível da piscina. Este sinal de distúrbio é conjugado na dinâmica de variação do nível com a vazão de saída, que é acionada pela saída do controlador, estando, portanto, relacionada com o sinal de controle, u(t). A modelagem do sistema de controle será discutida com mais detalhes no Capítulo 5 usando a modelagem física apresentada no Capítulo 3.
Em suma, o distúrbio de entrada provoca flutuações na variável controlada, que, no controle clássico, devem ser suavizadas a fim de melhorar o desempenho do sistema. Neste caso de controle clássico, o desempenho do sistema poderia ser entendido como a manutenção de um patamar de vazão restrito à garantia da eficiência de separação. No caso do sistema VASPS, onde são utilizadas também outras técnicas que não o controle clássico, como visto mais adiante, além deste objetivo de controle, outro será abordado – a minimização do esforço de controle sobre a bomba. Isso se deve ao fato de que, conforme relatado em Peixoto et al. (2005) e no Capítulo 3, o atuador é um componente crítico do sistema que afeta a estratégia de controle a ponto de redefinir o conceito do controlador.
A manipulação dos sinais apresentados na forma de equações diferenciais tem uma complexidade matemática inerentemente alta. O sistema controlado em si é expresso por meio da convolução das equações diferenciais do controlador e da planta, e suas soluções temporais são na forma de funções senoidais e exponenciais, que representam a oscilação da resposta y(t) a uma dada excitação u(t) na planta. Para evitar um esforço desnecessariamente alto, é importante realizar a transformação do domínio do tempo para algum outro que facilite a análise matemática do comportamento do sistema. Uma ferramenta adequada para esta tarefa é a Transformada de Laplace, que transfere o domínio do tempo para um domínio alternativo na variável ‘s’, o que 
torna as funções diferenciais em funções algébricas simples. Operações de diferenciação e integração são substituídas por operações algébricas no plano complexo, e as soluções das equações algébricas em ‘s’ fornecem as soluções transiente e estacionária das equações diferenciais por meio das transformadas inversas de Laplace.
Sabendo que um ‘sistema’ responde com uma saída y(t) para uma excitação x(t), e levando em conta que este pode ser expresso em formas algébricas simples no domínio de Laplace, define-se a Função de Transferência (FT) como a relação entre a saída de um sistema e sua entrada no domínio da variável ‘s’. O conceito de Função de Transferência (FT) é importante uma vez que a variável ‘s’ representa o domínio das freqüências, e consequentemente um dado valor de ‘s’ possui a informação a respeito da amplitude de oscilação do sistema para uma excitação naquela freqüência específica. Isso permite uma série de benefícios no tratamento de sistemas de controle: • É possível saber as freqüências em que há máxima amplitude de oscilação no sistema a partir do gráfico de resposta em freqüência, que nada mais é do que o valor da FT variando-se o ‘s’ em um intervalo. Estas freqüências são identificadas como valores singulares e freqüência de ressonância (ou freqüência natural); • É possível definir conceitos importantes para a realimentação em malha fechada, como largura de banda (freqüências nas quais o sistema deve operar) e a amplitude dos picos das FTs (maior oscilação transiente da resposta do sistema); • As FTs permitem avaliar a resposta da planta, controlada ou não, a uma excitação qualquer definida, tão embora não forneça nenhuma relação pertinente à estrutura física do sistema; • A avaliação de sistemas em série é rapidamente obtida pela multiplicação das FTs, em vez das complicadas integrais de convolução necessárias no domínio do tempo; • Os pólos e zeros, respectivamente os pontos singulares (quando a resposta tende ao infinito) e pontos nulos, do sistema aparecem explicitamente nas FTs, através das raízes dos polinômios de seu denominador e numerador.
Assim, retomando o conceito de malha de controle e tendo em mãos as FT’s da Planta e do controlador, é possível exemplificar uma possível malha de controle para o VASPS segundo o 
diagrama de blocos da Figura 4.13. A variável controlada (o Nível) seria então regida de acordo com a Equação (3.4), e a curva da bomba BCS, não linear, de acordo com a Equação (3.1), conforme proposto nos trabalhos de Teixeira et al. (2004) e Wang et al. (2001).
Figura 4.13. Diagrama de blocos com o detalhamento da planta do sistema VASPS.
Ainda importantes em um sistema de controle são os conceitos de parâmetros de desempenho. Antes de explicá-los, vale dizer que os controladores, cuja lógica é desenvolvida para minimizar o erro dentro de um limite de operação, são dispositivos de baixa potência que calculam as modificações necessárias para um dado erro de entrada e amplificam este sinal de saída, u(t), a um nível suficientemente alto para alimentar o atuador. A partir daí, o atuador exerce uma ação sobre a planta que por sua vez responde com o sinal de saída, y(t). Assim, para a avaliação dos parâmetros de desempenho, considere um sinal de resposta qualquer como o apresentado na Figura 4.14.
Figura 4.14. Sinal de resposta com o destaque dos parâmetros de desempenho.

Os principais critérios para se avaliar se uma resposta atendeu a um determinado nível de desempenho são expressos em função de características da resposta. Estas características também são usadas na especificação de estratégias de controle. Basicamente, as principais características avaliadas são as seguintes: • Tempo de reação: tempo necessário para que a resposta atinja o valor de 50% do seu valor estacionário; • Tempo de estabilização: Tempo necessário para que o valor da resposta após oscilações se encaixe no intervalo de +5% a -5% de seu valor estacionário; • Percentual de sobresinal (PSS): valor máximo (de pico) atingido pela resposta, em porcentagem relativa ao seu valor estacionário; • Erro estacionário: divergência em porcentagem entre o valor estacionário da resposta e o valor de referência recebido pelo sistema.
Por fim, os controladores industriais mais comumente utilizados são os PIDs, assim chamados por computarem as modificações necessárias para a planta de acordo com uma composição dos sinais Proporcional ao erro, Integral do erro e Derivada do erro. Estes controladores possuem ganhos ajustáveis em cada um destes três sinais, de forma a permitir o ajuste de características específicas de resposta transiente separadamente e serão apresentados com mais detalhes na próxima seção.
4.2.1 Controle PID O controle PID se baseia em utilizar o sinal de erro calculado através da realimentação da variável controlada real na entrada do sistema, fechando a malha de controle e comparando-a com o valor de referência que deve seguir. Este erro alimenta o controlador, que integra e deriva este erro, somando estes três sinais após passarem por ganhos individuais, proporcional, integral e derivativo, conforme diagrama esquemático da Figura 4.15.
Figura 4.15. Diagrama esquemático de controle PID convencional.

O efeito dos três sinais na composição do sinal de controle u(t) é suficiente para cobrir a maior parte dos problemas de controle, utilizando-se técnicas diferentes para ponderar os ganhos do controlador. Em suma, o ganho proporcional é responsável pelo tempo de resposta do sistema a uma dada entrada, provocando muitas oscilações e sobresinal no caso de este estar muito alto.
O ganho integral é responsável por remover o erro estacionário do sistema, causando atrasos na resposta para ganhos altos, e o ganho derivativo remove as oscilações, amortecendo o sistema, mas causando erro estacionário se muito alto. O cálculo do sinal de controle u(t) e sua FT são dados pela Equação (4.8).
(4.8) O correto balanço no valor dos ganhos é chamado se ajuste ou sintonia do controlador PID, e compreende a tarefa mais difícil na configuração deste tipo de controlador. Há técnicas de projeto de controle PID, como a técnica de Ziegler-Nichols, onde um valor pré-ajustado para os ganhos é sugerido, de forma que o ajuste a ser realizado normalmente é apenas um ajuste fino em torno dos valores encontrados no projeto. No entanto, alguns controladores PID, especialmente aqueles em que se deseja alto desempenho, não apresentam o desempenho ótimo com esta técnica, exigindo um projeto analítico do controlador, realizado com base na FT do sistema e na alocação dos pólos do sistema controlado, conforme apresentado na literatura consagrada, como em Ogata (1996), onde diversos exemplos podem ilustrar o projeto de controlador PID.
Para sistemas de ordem maior é necessário o auxílio de recursos computacionais e softwares especializados, pois o cálculo analítico torna-se muito complexo, tanto para o cômputo do controlador quanto para a identificação do sistema - que compreende descobrir a FT através de técnicas experimentais. Este fator é principal demandante de uma modelagem correta e simplificada de sistemas dinâmicos para controle.
4.2.2 Controle Nebuloso As técnicas de controle nebuloso fazem uso dos mesmos sinais convencionados para as técnicas de controle tradicional, com a exceção de que seu objetivo não necessariamente é minimizar o erro e(t). O acoplamento do dispositivo de inferência nebulosa, que permite a tomada de decisões em sistemas que utilizam a lógica nebulosa, permite que o controlador trate seus sinais de entrada, ou seja, o sinal de erro, e(t), do sistema, de acordo com sua lógica programada, extraindo informações que permitem a retirada de conclusões simples sobre o status 
do processo. Assim, é possível construir um mecanismo que funcione de forma a considerar objetivos mais flexíveis na estratégia de controle.
Os passos a serem seguidos no projeto de controladores nebulosos são basicamente os mesmos da construção de um dispositivo de lógica nebulosa, conforme apresentado anteriormente. Em essência, o controle nebuloso lança mão das variáveis lingüísticas introduzidas pela lógica nebulosa para realizar o controle de sistemas em malha fechada, permitindo que o conhecimento de especialistas seja incorporado ao controlador, melhorando o desempenho de sistemas de comportamento conhecido. Há diversas técnicas de controle nebuloso, em especial algumas utilizando o controle PID. A não ser que seja desenvolvido com o propósito contrário, o controlador nebuloso é não-linear, se adaptando melhor a plantas não-lineares e lidando eficientemente com as incertezas do modelo, caso o controlador tenha sido desenvolvido com eficácia.
A Figura 4.16. apresenta um diagrama de blocos de um sistema controlado por um controlador nebuloso com as entradas erro e derivada do erro. A integração do controlador inteligente com as entradas convencionais de um controlador PID implica em um conjunto de características peculiares para a construção das variáveis nebulosas e seus conjuntos, dado que o controle é comumente realizado com fechamento de malha e, portanto, lida com a minimização do erro em um processo qualquer.
Figura 4.16. Processo controlador por sistema nebuloso com entradas Erro e Derivada do Erro.
Uma vez que o controle nebuloso é comumente não-linear, o sinal de controle não possui uma função de transferência, de forma que o controlador pode ser projetado para se ajustar à não-linearidade da planta, quando há conhecimento sobre seu comportamento. Esta adequação se dá na forma da Base de Regras de um sistema Nebuloso, substituindo um cômputo tão analítico do sinal de controle quanto o realizado por uma equação. Assim sendo, um sistema com um controlador nebuloso teria regras referenciando o erro e suas derivações como variáveis nebulosas de entrada e o sinal de controle como variável nebulosa de saída. Com a construção de conjuntos nebulosos adequados, poder-se-ia ter uma situação como a ilustrada pela Figura 4.17, onde é apresentada uma possível aplicação da base de regras a uma determinada entrada.

Figura 4.17. Exemplo de aplicação de sistema com controle nebuloso.

Capítulo 5 5 Metodologia Este capítulo apresenta a aplicação dos conceitos explorados no Capítulo 4 para a síntese de controladores no contexto do Sistema VASPS, delimitado na modelagem física realizada no Capítulo 3. O desenvolvimento das metodologias de síntese de controladores usa duas estratégias de controle distintas abordadas nas duas seções deste capítulo. A primeira estratégia compreende melhorar o sinal de resposta através de melhorias no mesmo controlador usado em campo, limitando o escopo da metodologia à reformulação da solução existente e melhorando seu desempenho. A segunda estratégia, abordada na seção seguinte, extrapola o uso da tecnologia convencional, lançando mão de uma solução menos convencional para alcançar resultados operacionais mais significativos, trabalhando diretamente a questão da melhor manipulação do atuador, a Bomba BCS, reduzindo o esforço de controle realizado sobre esta.
5.1 Controle voltado ao Desempenho O controle voltado ao desempenho tem o objetivo de acompanhar o sinal de referência, de forma que a saída do sistema oscile o mínimo possível. Por sua vez, a saída do sistema pode ser qualquer variável física lida através de um sensor – temperatura, pressão, vazão, rotação ou nível.
No caso do VASPS, a variável de saída é o nível de líquido no reservatório interno ao separador, chamado anteriormente de ‘piscina’, de forma que mantendo um sinal de referência fixo, mantém-se também este nível o menos variante possível e por conseqüência o sistema permanece em condições operacionais previsíveis.
Esta abordagem leva à possibilidade de análise do sinal de resposta – no caso, a variação do nível – para determinar comportamentos assintóticos da resposta do sistema, ou seja, é possível afirmar sobre seu valor estacionário em regime permanente ou identificar a variação da resposta 
em função de uma dada entrada conhecida. Por sua vez, o sinal de controle, ou seja, a freqüência de rotação da bomba oscila de forma a corrigir os distúrbios impostos no processo, possuindo uma forma muitas vezes similar à do distúrbio de entrada.
Este tipo de abordagem é necessário quando a trajetória do sinal de saída é importante, ou quando os limites de estabilidade da saída do processo são muito rígidos. Aplicações comuns são no controle de rotação de bombas, com o intuito de mantê-las trabalhando no ponto ótimo operacional. Devido à simplicidade e à facilidade em aplicar-se a lógica a máquinas, este é o uso mais comum de controladores na indústria, tendo apresentado desenvolvimentos bastante complexos desde a concepção do controlador PID. Este mesmo já possui hoje diversas técnicas de projeto que permitam ajustar os ganhos de forma a evitar um regime transiente complicado, com atrasos na resposta ou picos de funcionamento antes da estabilização do sistema.
Aplicando então técnicas de controle nebuloso ao controlador PID clássico, apresentado no Capítulo 4, é possível sintetizar um mecanismo de ajuste dinâmico dos ganhos, modificando-os segundo condições operacionais do sistema. Esta forma de ajuste automático foi inicialmente proposta por Van Nauta Lemke e De-Zhao (1985) para melhorar o desempenho dinâmico do controlador. Muitas técnicas foram desenvolvidas neste sentido, e podem ser encontradas na literatura como ‘controle adaptativo’ (Krstic et al., 1995 e Astrom e Wittenmark, 1994), ‘PID com gain scheduling’ (Zhao et al., 1995) ou ‘self tuning PID’ (Astrom e Wittenmark, 1973 e Clarke e Gawthrop, 1975).
A aplicação desta tecnologia de auto-ajuste no sistema VASPS é apresentada na próxima seção sob a nomenclatura de controle híbrido Fuzzy-PID, uma vez que mescla a técnica clássica de controle PID com conceitos de lógica nebulosa. Outras formas desta mesma combinação podem ser encontradas na literatura.
5.1.1 Controle Híbrido Fuzzy-PID O modelo adaptado de Van Nauta Lemke e De-Zhao (1985) consiste na supervisão de um sistema de controle PID por um controlador inteligente hierarquicamente superior. Isto tem objetivo de propiciar um aumento do desempenho na resposta possibilitando melhorar a eficiência operacional, bem como permitir a concepção de um controlador não-linear, capaz de seguir um sistema também não-linear. Conceitualmente, ao aplicar o controlador inteligente no nível de supervisão, o controle efetivo do processo permanece sendo o Controlador PID, não 
havendo intervenção direta na malha de controle, mas com a diferença que o PID será ajustado dinamicamente de acordo com o status do processo monitorado.
Considerando o modelo da planta apresentado no Capítulo 3, foi elaborado um controle PID clássico para que o módulo supervisor pudesse ser aplicado sobre este. Utilizando técnicas comuns de projeto de controladores PID, foi construído o controlador apresentado na Figura 5.1, que possui seus ganhos conforme apresentado na Equação (5.1).
Figura 5.1. Diagrama de Blocos do Controlador PID.
(5.1) Com estas constantes, pode-se calcular a FT do controlador, conforme apresentado na Equação (5.2), verificando os pólos do controlador, segundo a Equação (5.3).
(5.2) (5.3) Assim, o diagrama de blocos para o sistema com o módulo supervisor é apresentado na Figura 5.2, onde a estrutura básica do controlador foi detalhada, e um bloco foi usado para representar o processo.

Figura 5.2. Diagrama de blocos do controlador Supervisório, adaptado de Van Nauta Lemke e De-Zhao (1985).
O controlador inteligente, inserido no bloco de supervisão da Figura 5.2, tem como objetivo reforçar o sinal de controle através do aumento do valor das constantes do PID em uma dada situação de condição operacional definida na parametrização do controlador nebuloso. Esta condição operacional, por ser definida pela Base de Regras do comportamento do controlador nebuloso, ocorre de acordo com a parametrização escolhida pelo projetista. Por exemplo, para um dado processo não-linear, P(s), a saída do sistema, dada pela Equação (5.4), terá comportamento próximo ao linear desejado apenas se o sinal de controle u(T) for também não-linear e compensando este comportamento.
(5.4) O diagrama do controlador FPID, apresentado na Figura 5.3, é o ponto de partida para a especificação. A notação adotada para os sinais é a seguinte: e: erro; ie: integral do erro; ce: mudança no erro (proveniente do inglês change in error); x: erro relativo; ix: integral relativa do erro; cx: mudança relativa do erro.
Além disso, a saída do sistema são variações nas constantes, ∆P, ∆I e ∆D, que são somadas às constantes iniciais do sistema, P0, I0 e D0, de forma a compor a constante final que opera no sistema variando conforme o status corrente. Estas saídas do sistema possuem cada uma seus 
conjuntos nebulosos, conforme apresentado no Capítulo 4. Esta formulação apresentada anteriormente é encontrada na literatura citada rotulando este sistema nebuloso como sendo do tipo ‘Mamdani’.
Figura 5.3. Detalhamento do controlador FPID do Modelo Supervisório.
O controlador integrado e detalhado é apresentado na Figura 5.4, onde é possível notar o supervisor atuando diretamente sobre as constantes do controlador PID, respeitando o conceito de não-interferência direta no sinal de controle.
r r Figura 5.4. Diagrama de blocos do controlador FPID.
Através do diagrama completo da Figura 5.4 é possível identificar o cálculo para as variáveis de entrada, de forma que o erro e, a mudança no erro, ce, e a integral do erro, ie, são dadas respectivamente pelas Equações (5.5), (5.6) e (5.7).

(5.5) (5.6) (5.7) Da mesma forma, as saídas do supervisor, ou seja, as constantes P, I, e D, são dadas respectivamente pelas Equações (5.8), (5.9) e (5.10), e as entradas normalizadas x, cx e ix, dadas pelas equações (5.11), (5.12) e (5.13).
(5.8) (5.9) (5.10) (5.11) (5.12) (5.13) O sinal de controle resultante do modelo tem a mesma equação do controle PID, mas com a diferença de que os termos relativos aos ganhos possuem uma não-linearidade intrínseca, referentes aos termos ∆P, ∆I e ∆D, que podem ser modelados para atuar diferentemente com a variação dos componentes de erro. Estes por sua vez, representados pelas variáveis x, cx e ix, são classificados durante o processo de fuzzificação com uma pertinência dada pelos conjuntos nebulosos. Um exemplo de como a Lógica Nebulosa pode ser aplicada é apresentada na Figura 5.5, para um processo onde a entrada assume valores relativos no intervalo [-1,1] e a saída imprima variações de -100% até +100% no valor original da constante.

Na Figura 5.5 (a), é apresentada a função de pertinência modelada para as três variáveis de entrada, x, ix e cx, de forma que em torno do zero as variáveis assumem valores de pertinência nos conjuntos “Zero” (Z), “Pouco Negativo” (N) e “Pouco Positivo” (P) e, ao passo que vão aumentando ou diminuindo assumem pertinências maiores nestes últimos dois conjuntos até ativarem os conjuntos nebulosos “Muito Negativo” (N--) ou “Muito Positivo” (P++). Com isto, é possível criar regras distintas de acionamento das variáveis de saída para quando a resposta transiente estiver muito longe da estabilização (por exemplo, erro normalizado x “Muito Positivo” (P++) ou “Muito Negativo” (N--), ou uma combinação de erro x “Pouco Positivo” (P) com derivada “Muito Positiva” (P++) ou “Pouco Positiva” (P) e outras regras para alterar os valores das constantes P, I e D quando o sistema estiver perto da estabilização (por exemplo, 
quando o erro for “Zero” (Z), ou quando houver uma combinação de erro “Pouco Positivo” (P) com a derivada “Pouco Negativa” (N) ou com a Integral “Zero” (Z).
Já nos itens (b) e (c) da Figura 5.5, são apresentadas as funções de pertinência para as variáveis de saída, que são as variações percentuais impressas às constantes do controlador PID.
Neste caso, a construção dos conjuntos nebulosos para a variável de saída ∆P é diferente da construção das outras duas, possuindo o conjunto nebuloso “Zero” (Z) e os conjuntos nebulosos “Muito Positivo” (P++) e “Muito Negativo” (N--) mais estreitos. No caso do primeiro dos conjuntos, isso se faz necessário pois na composição do sinal de controle a contribuição do sinal de erro normalizado x torna-se muito pequena devido à redução do erro na estabilização, de forma que se faz necessário imprimir variações rápidas na constante P para obter-se um sinal de controle mais efetivo. Já na caso dos últimos dois conjuntos citados, isso ocorre pois nas saídas referentes aos ganhos D e I é interessante que haja um reforço maior nestas constantes devido a estas serem os valores ativos mais representativos no período de estabilização, de forma que a grande área dos conjuntos “Muito Negativo” (N--) e “Muito Positivo” (P++) destas variáveis influencia na ponderação dos conjuntos no processo de defuzzificação.
Finalmente, estes conceitos devem estar claros e definidos pela Base de Regras, de forma que percebe-se que a criação dos conjuntos nebulosos e a definição destas regras não são totalmente independentes, sendo construídas uma em função da outra, e ambas de acordo com o comportamento desejado para o controlador. Usualmente, poder-se-ia desejar um comportamento linear da saída, o que facilitaria a modelagem matemática e a avaliação de resultados. No entanto, o objetivo não é simplificar a álgebra do controlador e sua função de transferência, mas sim buscar o melhor resultado que se possa extrair do sistema.
No caso em questão, onde o objetivo é manter o nível da piscina do VASPS o mais próximo possível do valor de referência – um requisito claramente voltado para o desempenho do controlador, mantendo o valor de referência na saída – há algumas adaptações necessárias considerando os equipamentos usados em campo e os critérios de desempenho. O primeiro comportamento desejado diz respeito à atuação do controlador em momentos diferentes do regime transiente (a saber: início de um grande distúrbio versus período de estabilização), enquanto que o segundo diz respeito à restrição física de vazão sempre positiva, de forma que as seguintes melhorias podem ser incluídas na Base de Regras frente ao controlador PID puramente matemático: 
Caso 1) Reforçar o sinal de controle para pequenos valores de erro a fim de aumentar a taxa de correção próxima à estabilização; Caso 2) Eliminar contribuições negativas das componentes do erro na composição do sinal de controle, evitando que sejam necessários valores negativos de correção do sistema (que implicariam em saturação do controlador no sistema PID).
No primeiro caso, lembrando-se da composição do sinal de controle dada pela Equação (5.14), é possível reforçar o sinal de controle quando as componentes do erro, e(t), ie(t) e ce(t), assumirem valores de amplitude baixa (entrada igual a ‘Z’, ‘N’ ou ‘P’) devido à estabilização do sinal de resposta, através do aumento das constantes P, I e D.
(5.14) No segundo caso, o desempenho é melhorado apenas quando o atuador do sistema tem relevância em apenas um sentido, como por exemplo no VASPS, onde a BCS deve manter um dado nível, atuando apenas com vazão de saída positiva para níveis altos, ou simplesmente não atuando para níveis baixos. Além disso, eliminar contribuições negativas pode vir a ter um impacto significante quando o sistema sem a correção gera sinais de erro grandes o suficiente para saturar o atuador, atrasando a resposta e piorando o regime transiente. Com isso, para a efetivação de um sinal de controle apenas em um sentido, é realizado um acréscimo de um delta de -100% (saída igual a ‘N--’) quando os sinais de erro forem negativos (entrada igual à ‘N’ ou ‘N--’).
Embora o sistema proposto possua três entradas e três saídas, a Base de Regras é dividida em três matrizes correspondentes a cada variável de saída, de forma simplificar a verificação da saída. Assim, cada uma das saídas será função de apenas duas variáveis de entrada, colocadas na linha e na coluna da matriz.
Para melhor ilustrar a Base de Regras, segue-se a notação da Tabela 5.1, que apresenta um rótulo numérico para cada conjunto nebuloso das variáveis de saída Pf, If e Df. Estes rótulos apresentam também uma casa decimal, utilizada para representar o grau de ativação da regra, e cujo valor é o complemento do número apresentado nesta casa decimal.

Tabela 5.1. Representação dos conjuntos nebulosos para a base de regras.
Exemplificando, caso uma célula da matriz que representa a base de regras apresente o valor 4.0, se a variável de saída analisada corresponder à saída Pf, o conjunto nebuloso ativado será o ‘Z’. De outra forma, se corresponder às saídas Df ou If, o conjunto ativado será o ‘P’. Outro exemplo ocorre para o caso do valor ser 6.3, o que significa que a saída Pf será ativada com 70% de pertinência no ‘P+’ (6.0) e 30% no ‘P++’ (7.0).
Com isso, a Base de Regra para os dois casos anteriormente abordados pode ser observada na Tabela 5.2, onde é possível notar que o reforço para a constante Pf é aplicado quando o erro é pequeno, mas diferente de zero, pois quando o erro é pequeno e sua variação é nula, o sinal se estagnou naquele valor, devendo ser reforçado. Já o reforço das constantes If e Df ocorre quando tanto o erro quanto sua integral ou derivada se aproximam do zero, assumindo um valor ainda maior quando exatamente em zero.
Tabela 5.2. Base de regras do controlador supervisor FPID Na Tabela 5.2 é possível notar que o reforço para a constante Pf é dado quando o erro é pequeno, mas diferente de zero, pois quando o erro é pequeno e sua variação é nula, o sinal se estagnou naquele valor, devendo ser reforçado. Já o reforço das constantes If e Df ocorre quando tanto o erro quanto sua integral ou derivada se aproximam do zero, assumindo um valor ainda maior quando exatamente em zero.
Por sua vez, a Tabela 5.3 apresenta a Base de Regras para um sistema onde não se desejam contribuições negativas no sinal de controle, ou contribuições quaisquer quando o erro do sistema esteja abaixo de zero, indicando que este ainda não atingiu seu status operacional desejado.

Tabela 5.3. Base de regras do controlador supervisor FPID Variação do Erro Df N-- N Z P P++ N-- 1.0 1.0 1.0 1.0 1.0 N 1.0 1.0 1.0 1.0 1.0 Z 1.0 1.0 3.0 3.0 3.0 P 1.0 1.0 3.0 3.0 3.0 P++ 1.0 1.0 3.0 3.0 3.0 Estes modelos para a Base de Regra ilustram dois casos específicos gerados a partir de necessidades provenientes de um sistema. Outras necessidades poderiam ser identificadas a fim de gerar as regras adequadas a tratar com o problema. Por fim, os resultados para o modelo FPID são apresentados no Capítulo 6 e os modelos e resultados para modelos derivados do FPID são apresentados no Apêndice A.
5.2 Controle voltado à Minimização do Esforço Em face aos problemas onde o componente crítico do sistema é o atuador, normalmente devido ao seu elevado custo – que pode também ser traduzido como baixo tempo médio entre falhas (MTBF) – é desejável que este permaneça com o mínimo de utilização possível, ou com o mínimo de variações em sua condição de trabalho possíveis, permanecendo no ponto ótimo de operação. Isso acontece no sistema VASPS, onde o motor elétrico da BCS é acionado por um inversor que permite maior flexibilidade através do uso de uma gama de rotações diferentes, mas que acarreta em trabalho fora do ponto ótimo.
Visando a redução do esforço ao qual a bomba está submetida, foram desenvolvidos controladores especificamente voltados ao tratamento do sinal de controle, de forma que este permaneça com poucas alterações, e a saída do sistema oscile dentro da faixa de estabilidade prevista para o modelo dinâmico do processo, conforme definido na seção 3.1.2. Assim, o comportamento desejado para o sistema controlado é apresentado na Figura 5.6, e será o objetivo de controle usado no projeto dos controladores.

Figura 5.6. Comportamento desejado para o sistema voltado à redução do esforço de controle.
No VASPS a redução do esforço de controle pode prover um menor custo ao processo, uma vez que o atuador é o componente crítico, em detrimento do melhor desempenho possível para o sistema. Este compromisso entre desempenho e esforço de controle pode ser parametrizado de acordo com a faixa de estabilidade do processo físico controlado, respeitando seus limites operacionais e utilizando a resposta do sistema para avaliar parâmetros que indiquem quando a alteração no sinal de controle é realmente necessária. Serão tratados quatro diferentes modelos de controladores inteligentes, que permitem este tipo de inferência.
5.2.1 Monitoramento da Média Móvel Com o objetivo de avaliar a tendência do comportamento do sinal, este controlador realiza uma média móvel do erro de acordo com uma janela de tempo parametrizada pela variável n, de forma que o erro médio do processo, calculado pela Equação (5.15), faz o papel de ajustar o tempo de reação do sistema à taxa desejada de correção, em função da variação do sinal de saída.
Também é possível realizar o cálculo do sinal de média móvel pela ponderação do sinal de erro com um perfil diferente do uniforme, como, por exemplo, com uma média ponderando as leituras mais recentes com maior peso.
(5.15) 
Assim, em sistemas onde o sinal de controle deve permanecer com o mínimo de variações possível, a alteração do sinal de controle u(t) se dará apenas mediante uma mudança significativa da condição de operação, reduzindo a sensibilidade a oscilações curtas que podem não implicar na necessidade de alteração do sinal de controle. Uma alteração de comportamento será identificada, portanto, com a variação de magnitude da média móvel, que deve possuir baixa sensibilidade a oscilações bruscas, refletindo a tendência real do processo.
Para o conceito de média móvel funcionar no contexto de minimização do esforço de controle, é necessário que este esforço seja constante em torno de pontos de operação do sistema, de forma que a mudança do sinal de controle indique uma correção do sistema para operar em outro ponto. Assim, a leitura de erro médio é utilizada como entrada para um mecanismo de inferência nebulosa, um controlador nebuloso, que é encarregado de dividir os parâmetros de operação do processo em pontos de operação, criando regiões de trabalho onde a média possa oscilar com alguma liberdade. Ademais, faz-se necessária a manutenção da leitura do erro instantâneo, uma vez que este deve ser considerado como única alternativa de correção caso o sistema esteja exposto a oscilações bruscas que possam levar as condições de operação para uma região crítica que necessite de correção imediata. Esta alternativa é uma segurança contra falhas em sistemas de baixa constante de tempo. Assim, o diagrama de blocos para este controlador, aplicado ao sistema VASPS é apresentado na Figura 5.7.
Figura 5.7. Diagrama de blocos para o controlador Média Móvel aplicado ao VASPS.
As funções de pertinência do controlador nebuloso devem contemplar a região de trabalho, as regiões críticas de correção próximas aos limites da faixa de trabalho, e regiões de transição entre estas. Além disso, é recomendável que as entradas do mecanismo de inferência nebulosa sejam normalizadas em torno do zero, através do cálculo dado nas Equações (5.16) e (5.17), de forma a facilitar análises de sinal.
(5.16) 
(5.17) De forma a atender a faixa de estabilidade do VASPS proposta no início deste capítulo, será considerado que um erro de 25% em relação à referência de 30 metros (7,5 metros para mais e para menos) é uma margem segura de trabalho, de forma que fora deste intervalo a estabilidade não pode ser garantida. Assim, definindo a zona crítica de atuação a faixa entre o erro de 20% e o de 25%, a região de trabalho para a rotação ótima da bomba se dá na faixa de -10% a +10%. Com estes valores são construídos os conjuntos nebulosos da Figura 5.8, relacionando a rotulação das faixas de erro com os conjuntos nebulosos.
Figura 5.8. Funções de pertinência para o controlador Média Móvel aplicado ao VASPS.
Por fim, a base de regras para este controlador é do tipo Sugeno, usando a formulação do tipo ‘Constante’ para as funções de saída, como apresentado no Capítulo 4, ativando para a saída u(t) um valor de freqüência com que o inversor aciona a bomba. O valor final de saída é ponderado segundo o grau de ativação de cada regra ativa, µk. Assim, os valores das saídas para correspondente a cada regra são apresentados na Tabela 5.4.

Tabela 5.4. Base de regras do controlador Monitoramento da Média Móvel.
As regras representadas pela Tabela 5.4 não possuem associação entre as variáveis de entrada, sendo que cada regra ativa um valor de saída a ser computado através da formulação apresentada para regras do tipo Sugeno no Capítulo 4. Assim, este sistema apresenta 9 regras de acionamento da resposta, que ativam, cada uma, um valor constante para a variável de saída, que são então ponderadas pelo grau de ativação do conjunto nebuloso de entrada, µk. Considerando todas as regras com peso 1, são 4 regras para o erro instantâneo normalizado (regra 1 – saída 48 Hz, regra 2 – saída 50 Hz, regra 3 – saída 58 Hz e regra 4 – saída 60 Hz) e 5 regras para o erro médio normalizado (regra 5 – saída 48 Hz, regra 6 – saída 52 Hz, etc).
Como exemplo, considere a entrada de erro instantêneo normalizado, x(t), igual a -15%, e a )(tx , igual a -9%. A primeira condição ativa o erro entrada de erro médio normalizado, instantâneo no conjunto nebuloso RT, não acionando nenhuma regra, enquanto que a segunda condição aciona o erro médio nos conjuntos TRB e RT, acionando as regras 6 e 7. Assim, estas entradas geram as saídas apresentadas na Tabela 5.5.
Tabela 5.5. Aplicação da Base de Regras usando entradas associativas.
O sinal de controle pode então ser calculado pela ponderação das saídas ativas pelo grau de ativação: • 
5.2.2 Classificador de Regiões Com o intuito de uma melhor manipulação da região de trabalho, limitada acima e abaixo, este modelo trata o sinal de entrada com uma função de classificação que retorna uma pertinência relativa à distância entre o limite de estabilidade mais próximo (superior ou inferior) e o valor da referência. Esta abordagem permite uma livre variação do sinal de referência r(t) dentro da região de trabalho do controlador, de forma que as funções de classificação tomam novos coeficientes, que corrigem a distância entre os limites de estabilidade para o valor da nova referência. A Figura 5.9 ilustra a construção das funções de classificação de acordo com a referência, e a correção desta após a variação do set point ao longo do processo.
Figura 5.9. Ilustração da função utilizada pelo Classificador.
Este conceito permite a parametrização da região de trabalho, uma vez que a entrada é normalizada no intervalo [-1,1], e a manipulação do valor de set point, o que apresenta limitações no modelo Monitoramento da Média Móvel. Com a entrada normalizada, pode-se utilizar a idéia de valor de pertinência para esta, dada pela Equação (5.18), de forma que sua magnitude expresse a proximidade à instabilidade ou à referência. Além disso, a inclinação da função de classificação provê uma rápida transição desta pertinência entre estes dois casos.
(5.18) Isso posto, é possível também resolver o problema de minimização das variações no acionamento através da atuação restrita à proximidade da região crítica. Com isso em mente, é 
possível utilizar o classificador para monitorar os limites e estabilidade, e utilizar um mecanismo de inferência nebulosa, conforme proposto na Figura 5.10, para calcular a rotação nas proximidades da região crítica, realizando correções mais efetivas.
Figura 5.10. Diagrama de blocos para o controlador Classificador de Regiões aplicado ao VASPS.
O sinal de controle fora da região de estabilidade é configurado para o valor crítico factível pelo atuador, de forma a imprimir a maior correção. Ao adentrar a região de estabilidade, acionamentos sucessivos de freqüências paulatinamente menores permitem a transição suave para a rotação ótima até que certa distância do limite de estabilidade seja atingida. Essas sucessões de acionamento servem também para a aproximação da instabilidade.
Para a seleção das rotações na região próxima à instabilidade, uma série de conjuntos nebulosos é inserida nas faixas críticas, conforme apresentado na Figura 5.11. Neste exemplo, os conjuntos são rotulados de acordo com a intensidade alta ou baixa que a pertinência atinge, e o valor da saída pode ser definido para cada conjunto nebuloso, uma vez que também são do tipo Sugeno e com a formulação das funções de saída do tipo ‘Constante’.
Figura 5.11. Conjuntos nebulosos de entrada para o Classificador de Regiões.

Tomando o limite inferior para o nível, que causaria quebra na bomba, como LI de 20 metros, e o superior, que comprometeria a pressão de separação, como LS de 40 metros, pode-se definir a base de regras pela Tabela 5.6.
Tabela 5.6. Base de regras do controlador Classificador por Regiões.
A Tabela 5.6 pode ser utilizada da mesma forma que a Tabela 5.4, onde um exemplo é dado. A diferença reside no uso de apenas uma única variável de entrada.
5.2.3 Classificador com Média Considerando os dois modelos voltados à minimização do esforço de controle apresentados, cabe uma análise quanto às principais características encontradas: • Tempo de reação; • Avaliação de tendência; • Monitoração dos limites de estabilidade; • Oscilação na transição entre regiões de trabalho; • Insensibilidade a variações na referência; • Sensibilidade a oscilações bruscas.
Ambos os modelos apresentados anteriormente apresentam formas de manipulação do tempo de reação do sistema, uma vez que há a avaliação de tendência, seja pela média móvel realizada, que permite concluir sobre incrementos sustentados ou transientes, seja pela classificação da entrada em uma pertinência normalizada que indica a proximidade com a região crítica. No entanto, em algumas simulações que serão apresentadas no Capítulo 6, foram percebidos alguns efeitos colaterais que podem ser relevantes para um dado sistema.
O primeiro deles é a oscilação do sinal de controle entre duas regiões de trabalho, quando um distúrbio no sistema possui uma maior duração, o que pode não apresentar problemas em 
campo no caso de a constante de tempo do sistema ser muito alta ou da instrumentação apresentar rampas de aceleração para a mudança do ponto de trabalho do atuador. O segundo, diz respeito ao conceito de regiões de trabalho, que implica em uma menor manipulação do sistema através do sinal de referência. Ora, se o sistema pode variar livremente em torno da referência, é de esperar que este não acompanhe o sinal fielmente. A última consideração se dá em torno de distúrbios de maior amplitude, que afetam o sistema com média móvel devido à leitura da variável instantânea, bem como afetam também o sistema com classificador, fazendo a pertinência variar muito bruscamente. Estas condições, embora esperadas, podem apresentar riscos ao atuador, que deve ser capaz de atuar em seus limites, mas não deve ser exposto a uma mudança brusca de atuação.
Nesse contexto, é proposto um conceito de controlador que mescla ambos os conceitos apresentados anteriormente, de forma a reduzir o efeito de grandes distúrbios através da realização de uma média móvel sobre a pertinência classificada, como também limitar a faixa de estabilidade em regiões de trabalho que permitam acompanhar a ordem de grandeza do sinal de referência, ainda permitindo oscilação, mas em torno de mais pontos. Adicionalmente, uma vez que o controlador proposto é mais refinado, sendo também mais sensível às mudanças bruscas do sinal de controle – mudanças estas que são minimizadas com a estratégia adotada nesta versão – faz-se necessário adicionar um filtro de sinal entre o controlador e o atuador, simulando os efeitos de saturação de sinal, quantização e rampa máxima de acionamento, presentes no CLP industrial.
O diagrama de blocos para a malha de controle em questão é apresentado na Figura 5.12.
Figura 5.12. Diagrama de blocos para o controlador Classificador com Média.
O controlador nebuloso inserido na malha é o mecanismo que permite a definição de mais regiões de trabalho para o sinal, de forma a permitir certo grau de acompanhamento da referência.
No entanto, a leitura da pertinência instantânea ainda é mantida, novamente por segurança. As funções de pertinência são apresentadas na Figura 5.13.

Figura 5.13. Funções de pertinência para o controlador Classificador com Média.
A base de regras para o controlador classificador com média no caso do Sistema VASPS é apresentada na Tabela 5.7. Da mesma forma que os demais, as regras são do tipo Sugeno.
Tabela 5.7. Base de regras do controlador Classificador com Média adaptado ao VASPS.
O filtro de sinal inserido na malha tem o objetivo de simular as mínimas variações que são aplicadas ao sinal de controle antes que este seja aplicado aos terminais elétricos da bomba BCS, corrigindo picos de sinal e ruídos. Basicamente, o filtro é constituído de três elementos, ilustrados na Figura 5.14 e aplicados na seqüência a seguir: 
1. Saturador. Este elemento de segurança impede que o acionamento da bomba fique fora do intervalo estipulado como limites de funcionamento físico, limitando o universo de atuação das freqüências do inversor.
2. Limitador de rampa. Este dispositivo limita a derivada do sinal de controle a um valor máximo e a um valor mínimo, simulando as rampas de aceleração e desaceleração permitidas no sistema. Este limitador atua na malha de controle elétrico da bomba, que possui uma constante de tempo baixíssima, por vezes da ordem de milissegundos, de forma que as variações neste loop interno da bomba não se fazem perceptíveis no controle de nível. De qualquer forma, acionamentos repentinos na forma de ondas completamente quadradas são evitados.
3. Quantizador. O último componente do filtro aplica um segurador de ordem zero, ou filtro ZOH, ao acionamento do sinal de controle na bomba, evitando sua oscilação como sinal contínuo e portanto minimizando a oscilação do sinal nos terminais da bomba. Foram adotados neste projeto degraus de 0,5 Hz, de forma a realizar variações suaves no acionamento.
Figura 5.14. Detalhamento do filtro de sinal aplicado entre o controlador e o atuador.
As funções aplicadas ao sinal de controle são dadas pelas Equações (5.19), (5.20) e (5.21).
(5.19) (5.20) onde aéu' derivada ude (t) no tempo t.
S 
Com este filtro, caso haja qualquer problema com o cômputo do sinal de controle acionando a BCS indevidamente, o sinal mais crítico a ser aplicado à bomba é um sinal com variação de meio em meio hertz, com derivada limitada e valor absoluto limitado por mínimos e máximos, permanecendo dentro do universo desejado.
5.2.4 Histerese com Auto-ajuste Ainda com as melhorias apresentadas no modelo Classificador com Média, a transição entre conjuntos nebulosos apresenta a dificuldade de se manter na nova região de trabalho até que a correção seja plenamente estabelecida, o que leva a imaginar a aplicação do conceito de histerese para fixar a variação da saída até que o sistema retorne completamente à região de trabalho anterior por efeito do próprio comportamento do processo, e não apenas por correção do controlador. A histerese é inserida logo após o cálculo de pertinência média, de forma que o diagrama de blocos do sistema é dado pela Figura 5.15. Percebe-se que não há o controlador nebuloso na malha, uma vez que a histerese define as regiões de trabalho.
Figura 5.15. Diagrama de blocos do controlador Histerese com Auto-ajuste.
O comportamento da histerese é dado pelas Equações (5.22), (5.23), (5.24), (5.25) e (5.26), de forma que as regiões de trabalho podem ser identificadas na Figura 5.16. Os diferentes intervalos ilustrados na figura correspondem às regiões de trabalho que apresentam um valor constante de saída, fixando o sinal de controle enquanto o sistema permanecer na respectiva faixa de trabalho. A alternância entre as equações apresentadas depende das variações na variável avaliada - a pertinência média - cujo universo de trabalho é normalizado no intervalo [-1,1].

(5.22) (5.23) (5.24) (5.25) (5.26) A associação das funções uNB(µ), uNS(µ), uZ(µ), uPS(µ) e uPB(µ) constitui a função aplicada ao sinal de controle para gerar seu valor de saída. Este valor de saída por sua vez é dado pelas constantes uNB, uNS, uZ, uPS e uPB, dependendo do intervalo onde a pertinência média estiver localizada e dependendo também do sinal de derivada de seu valor absoluto, que indica se o valor está se afastando ou se aproximando de zero.
Por sua vez, os valores µ1, µ2 e seus opostos -µ1 e -µ2 são os valores de transição entre regiões de trabalho quando a derivada do módulo da pertinência média for positiva. Esta condição é chamada de histerese de subida. Por outro lado, caso o módulo da pertinência média estiver decrescendo, ou seja, caso a derivada de seu valor absoluto for negativa, é caracterizada a condição de histerese de descida, e neste caso o valor de transição entre as regiões de trabalho é deslocado em direção ao zero de um valor δ, chamado de intervalo de histerese. Assim, pode-se concluir que a transição entre regiões de operação na condição de histerese de descida é dada as pertinências usadas para os conjuntos nebulosos de entrada variam no intervalo [-1,1], o 
universo de trabalho da histerese também está compreendido neste intervalo normalizado, podendo ser visualizado na forma de porcentagens. A aplicação dos conceitos aqui apresentados será realizada no Capítulo 6, onde são apresentados os resultados.
Figura 5.16. Esquemático ilustrativo do comportamento da histerese.
A Figura 5.16 ilustra os conceitos de histerese de subida e de descida, bem como as regiões de trabalho rotuladas através do valor da respectiva constante de saída. Nesta, é possível verificar um curioso efeito da histerese sobre as regiões de trabalho, a saber: • Quando a região está ativa, o valor de transição para as regiões vizinhas é dado pelo maior delta dentre os valores de transição em seu entorno. Assim, pode-se dizer que o intervalo de trabalho é dado pela região expandida no entorno do valor médio da pertinência para aquela região.
• Quando a região não está ativa, para fins de transição de regiões, ela se afasta do zero de um valor igual ao intervalo de histerese. Dessa forma pode-se dizer que o intervalo de trabalho inativo total é dado pela região retraída fora do entorno do valor médio da pertinência.
Este efeito nos permite verificar que a soma das regiões de trabalho ativas é maior do que o intervalo de operação total de um valor igual à soma de todos os intervalos de histerese encontrados entre as fronteiras de operação. Esta maior região de trabalho real permite reduzir significativamente os acionamentos do atuador, zelando pela sua vida útil. Dessa forma, a Figura 5.16 ilustra a região expandida no entorno da pertinência média igual a zero. O valor da saída da 
histerese u(t), como dado no diagrama de blocos, é dado pela função uZ(µ), cujo valor de saída é uZ.
Neste ponto, é interessante retomar uma das considerações desenvolvidas na modelagem física do sistema VASPS – a dinâmica da variação da pressão. Havia sido considerado que o tempo de resposta da variação de pressão de gás era muito maior do que o do sistema de controle de nível, de forma que trabalhando no transiente do controle de nível, este não seria afetado pela dinâmica da pressão. Assim, embora os efeitos da variação da pressão não estejam claros na malha de controle de nível, caso seja avaliado um tempo muito grande de avaliação da dinâmica interna do VASPS, talvez a amplitude de variação da pressão influencie a tal ponto que os valores constantes de saída uNB, uNS, uZ, uPS e uPB não mais estejam adequados às regiões de trabalho definidas para estes. Ou ainda, considerando tempos maiores, a depleção do reservatório pode implicar na alimentação do sistema VASPS com uma pressão de admissão – ou uma vazão de líquido – declinante, causando o mesmo efeito.
Assim, considerando-se o problema de minimização de esforço de controle, e na tentativa de adaptar o controlador a condições dinâmicas de operação do sistema ao longo do tempo, foi desenvolvido um mecanismo de correção do valor do sinal de controle no equilíbrio, uZ, de forma que caso o sistema opere certa proporção de seu tempo fora da região de pertinência média igual a zero, o valor de uZ seja atualizado proporcionalmente. A importância desta correção é ilustrada por observações realizadas em simulação para um sistema dinamicamente variante no tempo, onde a faixa de erro nulo aplicando o sinal de controle u(t) invariante no valor de uZ, gerou atuações que não mantiveram o sistema em equilíbrio, sendo necessária a atuação da faixa de operação vizinha para corrigir o sinal de saída y(t) e retornar a minimizar o erro. Com isso, um diagrama esquemático para este controlador, ilustrando entradas e saídas dos parâmetros de cada bloco, pode ser representado pela Figura 5.17.

Figura 5.17. Diagrama esquemático do controlador Histerese com Auto-ajuste.
Para realizar o auto-ajuste, o regulador utiliza a média móvel do sinal de controle e a monitora até que esta atinja um valor entre uZ e uPS – por exemplo, 70% da distância entre os patamares – permanecendo ainda mais próximo do valor de equilíbrio, mas já indicando a tendência do sinal de controle se deslocar em direção a uma das extremidades da região de trabalho. Após este valor da média móvel ser atingido, uZ assume este valor, e o sistema passa a ser referenciado a partir daí, sendo este o novo ponto de equilíbrio.
Este controlador engloba todos os conceitos anteriormente propostos e apresenta adicionalmente conceitos de robustez e a histerese. Tendo sido idealizado para aplicações com uma grande constante de tempo, o controlador também apresenta ferramentas que o permite lidar com sistemas mais rápidos, dado o alto grau de informações que este utiliza para definir a política de controle. A formulação do controlador real pode ser também mais ou menos conservadora, uma vez que os parâmetros do sistema permitem definir os limites permitidos para a variável controlada e para a variável manipulada.
O mérito de minimizar o esforço de controle requer, como reforçado no início da discussão, uma flexibilidade operacional dos parâmetros de desempenho. Não obstante, as tentativas de minimizar o erro estacionário foram desenvolvidas de forma a contemplar tanto o sinal de controle, quanto de permitir brechas para que o compromisso com o desempenho fosse deixado para a decisão do projetista, podendo este dar um maior peso ao desempenho.

Capítulo 6 6 Resultados 6.1 Solução pelo Desempenho A aplicação do controle híbrido Fuzzy-PID segundo o controlador apresentado na seção 5.1.1 foi simulada para o sistema apresentado e pelas suas equações. Além disso, para fins de comparação, também foi aplicado um controle PID simples, cujos resultados são apresentados nas mesmas figuras dos resultados do controle FPID.
Então, em ambos os sistemas a variável manipulada, u(t), é a freqüência com a qual o inversor alimenta a BCS, cuja relação com a vazão de saída do sistema é direta, e a variável controlada, y(t), é o nível da ‘piscina’. A referência, r(t), é fixada no valor de 30 metros.
6.1.1 Fuzzy-PID Idealmente, o controle FPID do tipo supervisor que é apresentado na seção 5.1.1 representa uma melhoria para o sistema de controle do VASPS, devido a não-intrusão no processo, considerando que já havia um controle PID em campo operando. Diante desse fato, o sistema com supervisor não apresentaria pioras no controle, uma vez que o controlador original seria mantido, sofrendo apenas correções em seus ganhos.
Foram realizadas simulações que levaram em consideração uma partida do sistema com o nível do reservatório em seu valor mínimo de forma a avaliar o desempenho em um caso crítico e com leitura real abaixo da referência. Esta situação permite avaliar a resposta do sistema no enchimento, que é mais crítico que o esvaziamento, uma vez que a bomba deve ser acionada apenas após estar submersa, sendo estritamente necessário um comportamento controlado. A 
referência de nível para o sistema foi de 30 metros e as simulações foram realizadas com o sistema supervisório e sem este para efeito de comparação e mensuração da melhoria no desempenho.
Figura 6.1. Comparativo da resposta e do sinal de controle entre o PID e o FPID.
A situação crítica imposta permite a avaliação da resposta em regime transiente e seu estacionamento após este período. Este efeito está reproduzido na Figura 6.1, onde é apresentada a resposta do sistema com o controlador PID contra a resposta com o controlador FPID. Além da resposta do sistema, está sendo avaliado o sinal de controle que gerou a dada resposta.
Conforme apresentado na Figura 6.1, nota-se uma melhoria significativa no sobresinal e no tempo de estabilização do sistema, tão embora o sinal de controle seja muito similar.
Considerando que o módulo supervisor aumenta a constante D em torno do zero, é natural que a resposta possua menor sobressinal, dado que o amortecimento foi aumentado. Entretanto, há erro estacionário no sistema, causado pela saturação do efeito integral em valores negativos muito altos. Ambos estes efeitos podem ser observados na Figura 6.2, que apresenta o comportamento das constantes ao longo da simulação, bem como a decomposição do sinal de controle entre as contribuições individuais de cada constante.

Figura 6.2. Sinal de controle e comportamento das constantes entre o PID e o FPID.
Na Figura 6.2, o sinal de controle apresentado na Figura 6.1b é decomposto em suas componentes proporcional (Figura 6.2a), integral (Figura 6.2b) e derivativa (Figura 6.2c). Estes sinais são as contribuições de cada ganho na composição do sinal de controle total, verificando a saturação de sinal causada pelo efeito integral. Além disso, é apresentado nos gráficos inferiores o comportamento ao qual as constantes foram submetidas. Como exemplo, nota-se o reforço aplicado ao sinal derivativo na Figura 6.2c próximo à região onde o Nível cruzou com a referência, indicando erro pequeno. Comparando com a Figura 6.2f, há a indicação de que o reforço foi causado pelo aumento no valor da constante KD, com uma variação positiva de 90%, saindo de 100 e indo para 190, obtendo-se um sinal de controle mais expressivo, mesmo com o sinal cx, a variação relativa do erro, inalterado em relação ao controle PID.
Embora o sinal de controle proporcional apresentado na Figura 6.2a seja menor no sistema com supervisório, isso se deve ao fato de que o erro no sistema final é menor, conforme observado na Figura 6.1a. Ainda assim, há um aumento no valor da constante KP apresentada na Figura 6.2d, reforçando a ação. Dessa forma, observa-se uma melhoria geral na resposta causada por diversas ações pontuais combinadas. Além disso, o sinal de controle foi praticamente 
mantido, de forma que a energia de controle e a variação imposta ao atuador são as mesmas, viabilizando um projeto sobre um controlador que atendia o requisito de energia de controle. O desempenho obtido, que era o objeto de estudo do trabalho, foi alcançado sem perda de qualidade no sinal de controle e sem perda de estabilidade. Para os resultados dos modelos derivados do FPID, consultar o Apêndice A.
6.2 Soluções pelo Esforço de Controle Nesta seção, as variáveis controlada e manipulada continuam sendo as mesmas, dado o mesmo processo a controlar. Entretanto, o objetivo de controle é formulado com o intuito de minimizar alterações no sinal de controle de forma que o sistema permaneça com um sinal de controle u(t) próximo do constante, e a saída, y(t), oscilante. A saída, no entanto, representada pelo nível de líquido no VASPS, deve permanecer dentro da faixa estipulada para projeto, de forma que seria interessante conceber um sistema que evite muitas oscilações. Estas oscilações, por sua vez, são geradas pelo distúrbio proporcionado pelo gerador de golfadas e, nos projetos para minimização do esforço de controle, ao passo que bons resultados são adquiridos para o sinal de controle, o gerador de golfadas é substituído por um mais agressivo, que vá dificultar o controle, conforme apresentado anteriormente.
O VASPS em campo é um sistema com alta constante de tempo, conforme experimentado em seus projetos iniciais, de forma que variações no nível de líquido não sofrem oscilações tão bruscas quanto às simuladas para a validação dos controladores deste estudo. No entanto, utilizar um gerador de golfadas agressivo reforça o projeto computacional para futuras experimentações com o sistema.
6.2.1 Monitoramento da Média Móvel Com o controlador adaptado para o VASPS, foram realizadas simulações para testar o conceito proposto neste modelo, usando o primeiro gerador de golfadas. Os parâmetros manipulados nas simulações foram o nível inicial do reservatório e o número de pontos usado para o cálculo da média móvel, doravante referenciado por n. O nível inicial do reservatório seguiu a referência (30 metros) no primeiro conjunto de simulações, e foi variado para 60 metros posteriormente, ou seja, com o anular do VASPS completamente cheio. Este nível inicial é usado para as partidas do sistema com óleo diesel antes de abrir a entrada de fluido multifásico, e permite avaliar a resposta do sistema no regime transiente para uma condição de erro inicial muito grande. A média móvel por sua vez, assumiu os valores de 500, 2000 e 5000 pontos a uma 
taxa de amostragem de 0,1 segundos, cobrindo assim uma janela de tempo 10 vezes menor que o número de pontos.
Os resultados totalizaram seis simulações, cujas curvas são apresentadas separadamente em duas figuras. A Figura 6.3 apresenta a resposta para o nível inicial de 30 metros, com o nível nos gráficos superiores e o sinal de controle nos gráficos inferiores, tendo sido ordenados da esquerda para a direita os casos de n igual a 500, 2000 e 5000 pontos. O mesmo padrão foi adotado na Figura 6.4, que apresenta os resultados para o nível inicial de 60 metros.
As curvas permitem verificar o efeito de n. Quanto menor, mais próximo o nível médio está do instantâneo e, portanto, maiores são as variações no sinal de saída, uma vez que os picos estão refletidos no nível médio. Do contrário, quanto maior, mais lenta e gradual é a reação do controlador, o que permite picos mais distantes da referência. Em ambas as simulações, nota-se este comportamento de forma que para o valor intermediário de n, de 2000, não há picos destacados na resposta, como ocorre com o valor de 500 pontos, bem como há um comportamento mais descendente e ascendente do sinal de controle, ao invés de uma resposta retardada em relação à instantânea, como ocorre com o valor de 5000 pontos.

Figura 6.3. Curvas de resposta para o controlador Média Móvel, com nível inicial em 30 metros.
Pelas simulações percebe-se que o sinal de controle se comportou conforme esperado, apresentando poucas oscilações quando estabilizado. No entanto, a simulação realizada para 2000 segundos permitiu avaliar correções sobre o nível apenas no caso de nível inicial igual a 60 metros, com a média móvel usando 5000 pontos, caso no qual há oscilações devido à transição entre conjuntos nebulosos. Dessa forma já é possível notar qual será o efeito de um distúrbio prolongado tentando desestabilizar o sistema – erro estacionário pela duração do distúrbio e oscilações do sinal de controle na fronteira entra a faixa de estabilidade e a faixa de transição.

Figura 6.4. Curvas de resposta para o controlador Média Móvel, com nível inicial em 60 metros.
Finalmente, é possível afirmar que este controlador deve ser aplicado apenas a sistemas onde o sinal de referência não sofre muitas variações, ou quando for possível projetar a faixa de trabalho do controlador, considerando uma variação limitada na referência, de tal forma que a situação crítica continue dentro dos limites de estabilidade do sistema. Essas condições devem ser respeitadas como fatores determinantes da garantia de estabilidade do sistema. Essa formulação também é possível para o sistema VASPS.
6.2.2 Classificador por Regiões Este controlador foi realizado com o intuito de robustez máxima, uma vez que monitora a faixa de estabilidade e possui uma grande região de rotação constante no centro da faixa de pertinência. Dessa forma, foram tomadas medidas para checar tal característica. A primeira foi utilizar um sinal de referência variável para todas as simulações, avaliando se é possível perturbar a estabilidade do sinal de controle. Além disso, as constantes LI e LS foram simuladas para os valores de 20 e 40 metros, apresentadas nos gráficos à esquerda, e depois variadas para os valores 
24 e 38 metros, apresentadas nos gráficos à direita, de forma a avaliar o efeito causado por um controle mais rígido no processo.
A Figura 6.5 apresentada a simulação para o nível inicial de 30 metros. Este nível inicial representa a continuidade da operação do sistema para qualquer instante de tempo, sendo o valor operacional ideal do nível. É necessário verificar também como o sistema reage na transição, tendo sido realizadas as mesmas simulações para o nível inicial de 60 metros, conforme a Figura 6.6.
Figura 6.5. Resposta para o Classificador por Regiões para o nível inicial de 30 metros.

Figura 6.6. Resposta para o Classificador por Regiões para o nível inicial de 60 metros.
Conforme esperado, o controlador mostrou-se bastante robusto e teve a transição mais suave apresentada até agora. No entanto, o efeito colateral foi bastante prejudicial – o nível não acompanha nenhuma das variações da referência, pois não há ajuste na região de projeto, uma vez que na base de regras o valor do acionamento da bomba para todo o intervalo da região de estabilidade é único. Isso explica as oscilações, que ocorrem porque o nível se estabiliza próximo à região de transição, assim que adentra a região de estabilidade, não minimizando o erro.
6.2.3 Classificador com Média Este controlador apresentou um resultado bastante satisfatório, conforme apontado pelas simulações para níveis iniciais de 30 metros e 60 metros de altura, com o sinal de referência mantido constante, conforme a Figura 6.7, e para sinal de referência variável, conforme a Figura 6.8.

Figura 6.7. Resposta e Sinal de Controle para controlador Classificador com Média, com referência constante.

Figura 6.8. Resposta e Sinal de Controle para controlador Classificador com Média, com referência variável.
É possível notar nestas simulações que há algumas poucas oscilações curtas ao longo da operação do sistema, tão embora estas se apresentem bem menos freqüentes que nos modelos de controlador anterior. Além disso, percebe-se que o sinal acompanha as alterações do set point permitindo uma melhoria significativa de desempenho em relação aos outros modelos. Assim, devido ao bom resultado que este controlador apresentou usando o gerador de golfadas com freqüência de golfadas aleatória, foi realizado um novo teste, ainda com set point variável para um gerador de golfadas com amplitude de golfadas aleatórias, de acordo com a Figura 6.9.

