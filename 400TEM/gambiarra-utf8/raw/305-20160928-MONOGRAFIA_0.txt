TAISA BEATRIZ PACHECOCOMPARAÇÃO ENTRE AS FORMULAÇÕES IMPES, SEQUENCIAL ETOTALMENTE IMPLÍCITA NA SIMULAÇÃO DE ESCOAMENTOBIFÁSICO EM RESERVATÓRIOS APLICANDO O MÉTODO DOSVOLUMES FINITOS BASEADO EM ELEMENTOSEste Trabalho de Curso foi julgado adequado para a obtenção do título de EngenheiroMecânico e aprovado em sua forma ﬁnal pela Comissão examinadora e pelo Curso de Gra-duação em Engenharia Mecânica da Universidade Federal de Santa Catarina.
Prof. Carlos E. Niño Bohórquez, Dr.Eng.
Prof. Jonny Carlos da Silva, Dr. Eng.
Coordenador do CursoProfessor da DisciplinaComissão Examinadora:Prof. António Fábio C. da Silva, Dr. Eng.
OrientadorProf. Clovis R. Maliska, Ph.D.
Prof. Sérgio Peters, Dr. Eng.
Florianópolis2016Ao meu companheiro Ederson,aos meus pais Sérgio e Tâniae à minha irmã Carina.
AGRADECIMENTOSAgradeço primeiramente ao meu companheiro Ederson por todo carinho e por todosos ensinamentos – tanto no âmbito pessoal, quanto no proﬁssional – sem os quais este tra-balho não seria possível. Agradeço profundamente aos meus pais Sérgio e Tânia, por todoincentivo à educação e por estarem sempre presentes não obstante a distância. Também àminha irmã Carina, a qual sempre foi um exemplo pra mim e ao Rodrigo, o qual consideroum irmão.
Agradeço especialmente ao professor António Fábio Carvalho da Silva, não apenas porrealizar seus papeis de professsor e orientador com primazia, mas também por acreditarem mim no momento mais difícil, permitindo-me conﬁar em meu próprio potencial.
Ao professor Clovis Maliska pela oportunidade de trabalhar no laboratório SINMEC.
Aos amigos e colegas de trabalho Giovani e Gustavo, sempre presentes. Ao Fernando pelaatenção e prestatividade. À Tatiane e ao Axel pelo auxílio quanto às atividades cotidianasdo laboratório. Sobretudo à Tatiane, por sua amizade e por todas as risadas. A todos os in-tegrantes do SINMEC ainda não citados: Emílio, Conrado, Hermínio, Josiane, Rafael, VictorWagner, Maria, Riciêri, Victor Antonio, Fernando Eckstein, Gabriel, Gustavo Trentini, Hen-rique, Jurandir, Lara, Lucas, Róger e Ruan. Também a todos os amigos da universidade quenão foram citados.
À Universidade Federal de Santa Catarina e ao Departamento de Engenharia Mecânica,pela excelência do curso oferecido. Sobretudo, ao Laboratório de Simulação Numérica emMecânica dos Fluidos e Transferência de Calor – SINMEC – e ao Programa de RecursosHumanos da ANP pela estrutura disponibilizada, pelo apoio ﬁnanceiro e pelo excelenteambiente de trabalho.
“If you change the way you look at things,the things you look at change.”
Wayne DyerRESUMOEste trabalho apresenta resultados comparativos das formulações IMPES (IMplicit Pres-sure, Explicit Saturation), sequencial e totalmente implícita ou FIM (Fully Implicit Method)na simulação numérica de escoamento bifásico, isotérmico, imiscível e incompressível emreservatórios de petróleo utilizando malhas não-estruturadas e o método dos volumes ﬁ-nitos baseado em elementos (EbFVM). A implementação do simulador foi realizada pormeio de programação orientada a objetos aplicando a linguagem C ++. A metodologia IM-PES resolve de forma implícita a pressão e explícita, a saturação. Sua estabilidade está, pois,condicionada a uma restrição de passo de tempo, tendo em vista a aproximação explícitado cálculo do campo de saturação. Em decorrência de sua simplicidade, essa abordagempermite reduzir tanto o esforço computacional quanto a diﬁculdade relacionada à etapade implementação. Já a formulação sequencial consiste em um IMPES modiﬁcado com ointuito de atingir uma maior estabilidade. Por ﬁm, no método totalmente implícito tem-se a solução simultânea das equações de conservação por meio do método de Newton-Raphson. Essa formulação acarreta um sistema de equações maior e atrelado a diversasnão-linearidades. Não obstante as diﬁculdades numéricas e de implementação computa-cional desse esquema, trata-se de um método mais estável. Ademais, foi implementadauma estratégia de passo de tempo variável a ﬁm de reduzir o tempo computacional des-pendido na obtenção das soluções numéricas, a qual altera o passo de tempo de acordocom a variação do campo de saturação ao longo do transiente. Os resultados apresentam acomparação dos métodos IMPES sequencial e FIM em termos de estabilidade, custo com-putacional e precisão dos resultados.
Palavras-chave: simulação de reservatórios, escoamento bifásico, EbFVM, malhas não-estruturadas, IMPES, método sequencial, método totalmente implícito, método de New-ton.
ABSTRACTThis study presents comparative results of IMPES (IMplicit Pressure, Explicit Satura-tion), sequential, and fully implicit solution schemes for isothermal, immiscible, incom-pressible two-phase ﬂow reservoir simulation using unstructured grids and the Element-based Finite Volume Method (EbFVM). The implementation of the simulator was done th-rough object-oriented programming (OOP) in C ++. The IMPES method solves pressureimplicitly and saturation explicitly, as the acronym suggests. As a result of this explicit cal-culation its stability is subjected to a restriction of the time step. Nevertheless this approachreduces the computational effort and facilitates implementation. The sequential methodis a modiﬁed IMPES with the aim of improving the stability of explicit formulations. TheFully Implicit Method (FIM) or simultaneous approach solves the system of equations thatmodels the problem simultaneously employing the Newton-Raphson method. This formu-lation implies larger system of equations with many nonlinearities and thus higher com-putational cost. Regardless the difﬁculties related to the numerical scheme and its imple-mentation it is a more stable method. Furthermore, it is also presented a variable time stepstrategy in order to accelerate the performance of the methods. This strategy consists ba-sically in modifying the time step according to the current solution. In this paper, IMPES,sequential and fully implicit methods are compared in terms of stability, computationaltime and accuracy of its results.
Keywords: Reservoir simulations, two-phase ﬂow, EbFVM, unstructured grids, IMPES, se-quential method, fully implicit method, Newton method.
LISTA DE ILUSTRAÇÕES1.1 Etapas da simulação de reservatórios . . . . . . . . . . . . . . . . . . . . . . . . . . . .
231.2 Esquema ilustrativo de um reservatório sujeito à recuperação secundária .
242.1 Volume de controle em um meio poroso . . . . . . . . . . . . . . . . . . . . . . . . .
313.1 Potencial geométrico da malha não-estruturada . . . . . . . . . . . . . . . . . . .
373.2 Principais entidades de um elemento triangular . . . . . . . . . . . . . . . . . . . .
393.3 Construção do volume de controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
393.4 Mapeamento para um espaço transformado . . . . . . . . . . . . . . . . . . . . . .
403.5 Estêncil associado ao nó P . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
433.6 Método de Newton para funções de uma variável . . . . . . . . . . . . . . . . . . .
474.1 Classes responsáveis pela simulação pelo método IMPES . . . . . . . . . . . . .
514.2 Exemplo de estrutura da matriz do sistema linear da pressão . . . . . . . . . .
524.3 Classes responsáveis pela simulação pelo método FIM . . . . . . . . . . . . . . .
544.4 Esquema de interpolação upwind em elemento triangular . . . . . . . . . . . .
574.5 Volume de controle adjacente ao contorno . . . . . . . . . . . . . . . . . . . . . . .
604.6 Exemplo de estrutura da matriz jacobiana . . . . . . . . . . . . . . . . . . . . . . . .
624.7 Exemplo de etapa de montagem da matriz jacobiana . . . . . . . . . . . . . . . .
674.8 Fluxograma da estratégia de modiﬁcação do passo de tempo . . . . . . . . . .
725.1 Conﬁguração do problema de deslocamento unidimensional . . . . . . . . . .
745.2 Curvas de permeabilidade e ﬂuxo fracionário . . . . . . . . . . . . . . . . . . . . . .
765.3 Malhas não-estruturadas utilizadas na solução do problema de Buckley-Leverett . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
785.4 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo emuma malha de 430 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
795.5 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo emuma malha de 1961 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
795.6 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo emuma malha de 7392 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
805.7 Tempo computacional para os três métodos com passo de tempo ﬁxo . . .
805.8 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido depasso de tempo adaptativo em uma malha de 430 nós . . . . . . . . . . . . . . .
815.9 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido depasso de tempo adaptativo em uma malha de 1961 nós . . . . . . . . . . . . . .
815.10 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido depasso de tempo adaptativo em uma malha de 7392 nós . . . . . . . . . . . . . .
825.11 Tempo computacional para os três métodos com critério mais rígido depasso de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
825.12 Evolução do passo de tempo para a malha de 430 nós com critério maisrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
835.13 Evolução do passo de tempo para a malha de 1961 nós com critério maisrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
835.14 Evolução do passo de tempo para a malha de 7392 nós com critério maisrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
845.15 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido depasso de tempo adaptativo em uma malha de 430 nós . . . . . . . . . . . . . . .
845.16 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido depasso de tempo adaptativo em uma malha de 1961 nós . . . . . . . . . . . . . .
855.17 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido depasso de tempo adaptativo em uma malha de 7392 nós . . . . . . . . . . . . . .
855.18 Tempo computacional para os três métodos com critério menos rígido depasso de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
865.19 Evolução do passo de tempo para a malha de 430 nós com critério menosrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
865.20 Evolução do passo de tempo para a malha de 1961 nós com critério menosrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
875.21 Evolução do passo de tempo para a malha de 7392 nós com critério menosrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
875.22 Campos de saturação e pressão para os instantes de tempo 0,2, 0,3 0,4 e0,5 VPI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
885.23 Conﬁguração do problema de deslocamento bidimensional . . . . . . . . . . .
905.24 Malhas não-estruturadas utilizadas na solução do problema quarter ﬁve-spot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
915.25 Resultados obtidos para o deslocamento bidimensional com passo de tempoﬁxo e uma malha de 425 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
935.26 Resultados obtidos para o deslocamento bidimensional com passo de tempoadaptativo e uma malha de 425 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
945.27 Resultados obtidos para o deslocamento bidimensional com passo de tempoﬁxo e uma malha de 1483 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
955.28 Resultados obtidos para o deslocamento bidimensional com passo de tempoadaptativo e uma malha de 1483 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . .
965.29 Resultados obtidos para o deslocamento bidimensional com passo de tempoﬁxo e uma malha de 5985 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
975.30 Resultados obtidos para o deslocamento bidimensional com passo de tempoadaptativo e uma malha de 5985 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . .
985.31 Campos de pressão e saturação no instante de breakthrough . . . . . . . . . .
995.32 Campos de saturação para os instantes de tempo de 500, 1500, 3000 e 5000dias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
995.33 Tempos computacionais despendidos no caso de deslocamento bidimen-sional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1015.34 Resultados obtidos para o deslocamento bidimensional com o método to-talmente implícito . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1025.35 Conﬁguração do problema tridimensional . . . . . . . . . . . . . . . . . . . . . . . .
1045.36 Ilustração da malha cilíndrica ao redor dos poços . . . . . . . . . . . . . . . . . .
1055.37 Resultados obtidos para o deslocamento tridimensional em malha híbridacom os três métodos para 3000 dias de simulação . . . . . . . . . . . . . . . . . .
1075.38 Resultados obtidos para o deslocamento tridimensional em malha híbridacom o método totalmente implícito para 10000 dias de simulação . . . . . .
1085.39 Campo de saturação para quatro instantes de tempo . . . . . . . . . . . . . . . .
1095.40 Campo de pressão para quatro instantes de tempo . . . . . . . . . . . . . . . . . .
1095.41 Campos ﬁnais de pressão e saturação . . . . . . . . . . . . . . . . . . . . . . . . . . .
110LISTA DE TABELAS4.1 Parâmetros correspondentes ao critérios mais rígido de passo de tempoadaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
714.2 Parâmetros correspondentes ao critérios menos rígido de passo de tempoadaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
715.1 Dados do problema de deslocamento bifásico bidimensional . . . . . . . . . .
915.2 Tempo computacional – passo de tempo ﬁxo e malha de 425 nós . . . . . . .
935.3 Tempo computacional – passo de tempo adaptativo e malha de 425 nós . .
945.4 Tempo computacional – passo de tempo ﬁxo e malha de 1483 nós . . . . . .
955.5 Tempo computacional – passo de tempo adaptativo e malha de 1483 nós .
965.6 Tempo computacional – passo de tempo ﬁxo e malha de 5985 nós . . . . . .
975.7 Tempo computacional – passo de tempo adaptativo e malha de 5985 nós .
985.8 Tempo computacional despendido com o método FIM . . . . . . . . . . . . . .
1025.9 Dados do problema de deslocamento bifásico tridimensional . . . . . . . . . .
1055.10 Tempo computacional despendido . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107LISTA DE LISTAGENS4.1 Pseudocódigo da rotina que resolve o sistema linear da pressão . . . . . . . .
534.2 Pseudocódigo da rotina que resolve o sistema não linear . . . . . . . . . . . . .
554.3 Pseudocódigo da rotina que computa os resíduos . . . . . . . . . . . . . . . . . .
564.4 Pseudocódigo da rotina que adiciona o termo difusivo nos resíduos . . . . .
564.5 Pseudocódigo da rotina que adiciona o termo acumulativo nos resíduos . .
574.6 Pseudocódigo da rotina que adiciona o termo fonte nos resíduos . . . . . . .
594.7 Pseudocódigo da rotina que aplica as condições de contorno nos resíduos604.8 Pseudocódigo da rotina que monta a matriz jacobiana . . . . . . . . . . . . . . .
634.9 Pseudocódigo da rotina que adiciona o termo difusivo na matriz jacobiana654.10 Pseudocódigo da rotina que adiciona o termo acumulativo na matriz jaco-biana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
684.11 Pseudocódigo da rotina que aplica as condições de contorno na matriz ja-cobiana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
694.12 Pseudocódigo da rotina que aplica as condições de contorno na matriz ja-cobiana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70LISTA DE SÍMBOLOSSímbolosRomanos(x , y ) Coordenadas globais[m][m2]SVetor área∆Smax Diferença máxima de saturação especiﬁcada no critério de passo de tempo variável∆Smin Diferença mínima de saturação especiﬁcada no critério de passo de tempo variável[s]∆tPasso de tempo[m2]∆AfVetor área associado à face f[kg/s]˙m fFluxo de massa que atravessa uma face f do volume de controleˆSSaturação de água normalizadaNiFunção de forma associada ao i-ésimo vértice do elemento[m2]KTensor permeabilidade absoluta do meio(cid:69) P(cid:77) Malha(cid:78) e(cid:83) PConjunto dos elementos que compartilham o nó PConjunto dos nós associados ao elemento eEstêncil associado ao nó P[m/s2]gVetor gravidade[m/s]VpVelocidade da fase pξRazão adimensional entre espaço e tempoeii-ésimo elemento de uma malhaFTermo fonte[kg/(m3 s)]F pTaxa de geração ou extinção de massa fase p por unidade de volume[1/s]f pTaxa de geração ou extinção de volume da fase p por unidade de volumeFfFluxo fracionário[m2/s2]GFunção potencial gravitacionalJMatriz jacobiana−1D Operador gradiente discretoJk prPermeabilidade relativa da fase pn vNumero de vértices de um elemento[Pa]P pPressão da fase pR tResíduo associado à conservação da massa totalR wResíduo associado à conservação da massa da fase águaR eNúmero de ReynoldsS pSaturação da fase pS wma x Saturação máxima de águaS wmi nSaturação mínima de água[m/s]v TVelocidade total na direção x[m]XCoordenada axial x normalizadaAbreviações[m3]WIwell indexBTBreakthroughEbFVM Element-based Finite Volume MethodEOR Enhanced Oil RecoveryFIM Fully Implicit MethodIMPES IMplicit Pressure, Explicit SaturationVPIVolume poroso injetadoSímbolosGregos(ξ, η) Coordenadas locais[m][m3/s]αwacTermo de acumulação associado à equação do resíduo R wαaum Constante utilizada para aumentar o passo de tempo[m3/s]αtTermo difusivo associado à equação do resíduo R tdif[m3/s]αwdifTermo difusivo associado à equação do resíduo R w[m3/s]αtTermo fonte associado à equação do resíduo R tfon[m3/s]αwfonTermo fonte associado à equação do resíduo R wαredConstante utilizada para reduzir o passo de tempoΓCoeﬁciente difusivo[1/(Pas)]λpMobilidade da fase p[m3/s]θ pfPseudoﬂuxo da face p na face f[Pa s]µpViscosidade da fase pΩDomínio fechadoψP Média do valor de ψ em P∂ ΩFronteira do volume de controleφPorosidade do meio[Pa]ΦpPotencial da fase pψFunção deﬁnida nos nós de uma malhaVetor com os valores de ψ nos nós do elementoΨeτTempo adimensionalTolerância especiﬁcadaSobrescritoseSubscritosPNó da malhaeElementofFaceoÓleopFase prRelativotTotalwÁguaacAcumulativodifDifusivofonFontemax Máximomin MínimooldAntigopresc PrescritoSUMÁRIO1 Introdução221.1 Simulação de reservatórios . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
221.1.1 Etapas da simulação de reservatórios . . . . . . . . . . . . . . . . . . . . . .
231.1.2 O fenômeno físico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
231.2 O modelo bifásico imiscível . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251.3 O Método dos Volumes Finitos baseado em Elementos . . . . . . . . . . . . . . .
251.4 Revisão bibliográﬁca . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
261.4.1 Método IMPES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
261.4.2 Método sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271.4.3 Método totalmente implícito . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271.5 Objetivos e contribuições . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271.6 Organização do trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
282 Modelo Matemático302.1 A Lei de Darcy na forma de potenciais . . . . . . . . . . . . . . . . . . . . . . . . . . .
302.2 Equações fundamentais do modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
312.3 Propriedades físicas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
332.3.1 Propriedades dos ﬂuidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
332.3.2 Propriedades da rocha . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
342.3.3 Propriedades do conjunto rocha-ﬂuido . . . . . . . . . . . . . . . . . . . . .
353 Método Numérico363.1 Método dos Volumes Finitos Baseado em Elementos . . . . . . . . . . . . . . . .
363.1.1 Entidades geométricas da malha . . . . . . . . . . . . . . . . . . . . . . . . . .
383.1.2 Abordagem numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
393.1.3 Discretização de uma equação de conservação de uma variável ge-nérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
423.2 Equações discretizadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
443.3 Formulações impes e sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
453.4 Formulação totalmente implícita . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
463.4.1 Método de Newton . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
464 Implementação Computacional504.1 Métodos impes e sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
504.1.1 Estrutura geral do simulador . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
514.1.2 Cálculo implícito da pressão . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
514.1.3 Cálculo explícito da saturação . . . . . . . . . . . . . . . . . . . . . . . . . . . .
534.2 Método totalmente implícito . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
544.2.1 Estrutura geral do simulador . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
544.2.2 Cálculo dos resíduos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
554.2.3 Construção da matriz jacobiana . . . . . . . . . . . . . . . . . . . . . . . . . .
614.3 Passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
704.4 Especiﬁcação das tolerâncias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
735 Resultados745.1 Deslocamento unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
745.1.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
745.1.2 Solução analítica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
765.1.3 Resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
775.2 Deslocamento bidimensional em conﬁguração quarter ﬁve-spot . . . . . . .
905.2.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
905.2.2 Resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
915.3 Deslocamento tridimensional em malha híbrida . . . . . . . . . . . . . . . . . . .
1045.3.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1045.3.2 Resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1066 Conclusão1116.1 Sumário . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1116.2 Conclusões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1126.3 Sugestões para trabalhos futuros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
114Referências118221INTRODUÇÃO1.1 SIMULAÇÃO DE RESERVATÓRIOSAtribui-se o desígnio reservatório de petróleo a um meio poroso que contém hidrocar-bonetos. Tendo em vista a concentração de investimentos no setor petrolífero e os gran-des efeitos da produção de petróleo na economia global, ascendeu a necessidade de pre-ver e otimizar a performance dos reservatórios. A decisão de implantar um complexo deexplotação de petróleo envolve custos elevadíssimos e requer, por conseguinte, uma fun-damentação sólida de que será vantajosa. Isso envolve um estudo prévio de viabilidadeeconômica e operacional.
A análise experimental completa do reservatório não é viável, porquanto ocasionariaalém de altos investimentos, muitas diﬁculdades. Nesse contexto, a simulação de reser-vatórios desponta como uma potente ferramenta a ﬁm de prognosticar a performance doreservatório e encontrar meios para otimizar a recuperação de certos hidrocarbonetos sobdiferentes condições operacionais. Essa área envolve física, matemática, engenharia dereservatórios e programação computacional.
Ainda, a simulação de reservatórios é complexa devido, sobretudo, a dois fatores. O
primeiro, é a falta de contato direto com o fenômeno físico o qual se deseja simular. Sendoassim, há diﬁculdades no processo de caracterização física e, por conseguinte, da seleçãode modelos matemáticos adequados que o possam descrever com um grau satisfatório deacurácia. O segundo fator consiste na própria complexidade atrelada ao fenômeno físico,pois que envolve minúcias por vezes nem compreendidas ou extremamente enredado emoutros fenômenos, de forma que a dependência mútua das variáveis acarreta uma simu-lação numérica complicada e custosa.
A ﬁm de progredir na descrição dos fenômenos, a área de simulação de reservatóriostem caráter dinâmico, i.e., trata-se de uma área constantemente aprimorada e ampliada.
Dada a quantidade de novos modelos propostos destinados à simulação de efeitos pro-gressivamente mais complexos, faz-se interessante dominar, primeiramente, aqueles maisbásicos, os quais levam em conta os efeitos mais signiﬁcativos ao fenômeno físico. Aziz &Settari (1979) sugerem que, antes de partir à implementação de qualquer modelo mais so-ﬁsticado, é fundamental adquirir a compreensão do modelo bifásico. O presente trabalhoalmeja explorar esse modelo a ﬁm de analisar o desempenho de três esquemas de solução23distintos – IMPES, sequencial e totalmente implícito. O conhecimento do modelo maisadequado ao objetivo da simulação numérica é imprescindível à correta interpretação dosresultados obtidos, de forma que essa comparação se faz valiosa quanto à escolha do mé-todo a ser utilizado.
1.1.1 ETAPAS DA SIMULAÇÃO DE RESERVATÓRIOSO processo de simulação de reservatórios envolve quatro etapas de modelagem for-temente atreladas, as quais estão esquematizadas na ﬁgura 1.1. Primeiramente, há de sedesenvolver um modelo físico para o problema que incorpore os processos mais relevantesà caracterização do fenômeno. A seguir, o problema é modelado matematicamente atravésde um conjunto de equações diferenciais parciais acopladas e dependentes do tempo. É,
então, desenvolvido um método numérico através do qual pode-se implementar compu-tacionalmente a resolução do sistema de equações associados ao fenômeno físico (Chen,1962).
Figura 1.1: Etapas da simulação de reservatóriosFonte: do autor1.1.2 O FENÔMENO FÍSICOO fenômeno físico de interesse na simulação de reservatórios consiste no escoamentomultifásico multicomponentes em um meio poroso. Usualmente, coexistem três fases:água, óleo e gás (da Cunha, 1996). Além disso, essas fases podem conter mais de um com-ponente e estão impregnadas em micro poros rochosos como o arenito (Ewing, 1983).
Reservatórios de petróleo são, de fato, rochas-reservatório e, portanto, são considera-dos como um meio poroso no qual o escoamento pode ser modelado a partir da equações24de Darcy (Bejan, 2004). O petróleo é produzido na rocha geradora e migra, sobretudo porcapilaridade e forças de empuxo, para a rocha reservatório. Não se desloca para as cama-das mais próximas à superfície em virtude da presença de uma rocha capeadora, a qualo envolve superiormente e apresenta baixa permeabilidade. Esses tipos de rochas estãoilustrados, esquematicamente, na ﬁgura 1.2.
Figura 1.2: Esquema ilustrativo de um reservatório sujeito à recuperação secundáriaFonte: do autorNa maioria das vezes, o petróleo só pode ser retirado do meio poroso através da impo-sição de elevados gradientes de pressão oriundos de mecanismos físicos denominados deprocessos de recuperação(Cordazzo, 2006). Esses processos são divididos em três catego-rias, a saber (Dake, 2001):• Recuperação primária: dá-se a perfuração dos poços e a produção sem nenhumatentativa de elevar a produtividade por meio de injeção de ﬂuidos;• Recuperação secundária: adota-se uma estratégia de injeção de água ou gás no in-tuito de manter a pressão, parcialmente ou totalmente, e acelerar o deslocamento doóleo em direção aos poços produtores. A ﬁgura 1.2 ilustra esse processo;• Recuperação avançada (EOR – Enhanced Oil Recovery): utiliza técnicas mais soﬁsti-cadas a ﬁm de alterar as propriedades originais do óleo. As três principais variantesdesse processo envolvem fenomenos químicos, de alteração de miscibilidade e tér-micos.
251.2 O MODELO BIFÁSICO IMISCÍVELA simulação do processo de recuperação de hidrocarbonetos em reservatórios de pe-tróleo requer a modelagem numérica de escoamentos multifásicos de múltiplos compo-nentes. O modelo matemático pode levar em conta processos de transferência de calor emassa por advecção e difusão e, por vezes, reações químicas.
Tendo em vista a complexidade dos fenômenos físicos associados ao processo de extra-ção, os modelos devem ser simpliﬁcados a ﬁm de que sua solução seja viável. Entretanto,a simpliﬁcação deve ser realizada de forma que os resultados obtidos sejam aceitáveis, i.e.,
as hipóteses devem prover aproximações consistentes.
O modelo utilizado no presente trabalho se destina à simulação de processos de deslo-camento de duas fases ﬂuidas imiscíveis. Um exemplo característico desse processo é a re-cuperação secundária de petróleo de reservatórios mediante a injeção de água. Trata-se damodelagem mais simples de escoamentos multifásicos. Em comparação ao escoamentomonofásico, requer, pois, técnicas mais avançadas, dada a necessidade de lidar com umsistema acoplado de equações não lineares (Aziz, 1993).
Ademais, usualmente novas técnicas numéricas para modelos mais complexos são im-plementadas e avaliadas, inicialmente, com o modelo bifásico, o qual apresenta diﬁculda-des semelhantes em relação às questões geométricas (Hurtado, 2005).
1.3 O MÉTODO DOS VOLUMES FINITOS BASEADO EM ELEMEN-TOSOs primeiros simuladores utilizados na área de óleo e gás empregavam, inicialmente,apenas malhas cartesianas ortogonais. As diﬁculdades associadas à geometria complexados reservatórios motivaram a introdução de malhas cartesianas não-ortogonais, conhe-cidas como malhas corner-point. Esse tipo de malha estruturada ainda é largamente apli-cado em simuladores comerciais.
O Método dos Volumes Finitos baseado em Elementos (EbFVM) emprega malhas nãoestruturadas para uma representação ainda mais ﬂexível e acurada do domínio. Isto é,permite solucionar o problema em geometrias mais complexas, de forma que representao problema de forma mais ﬁdedigna. Trata-se de um método versátil e consistente, que26satisfaz a característica fundamental dos Métodos dos Volumes Finitos – conservação dapropriedade em níveis elementares (Maliska, 2004).
O EbFVM surgiu, inicialmente, para a solução das equações de Navier-Stokes em Ba-liga & Patankar (1983). Sua utilização na área de simulação de reservatórios de petróleoocorreu posteriormente, muito embora ainda seja pouco utilizado em simuladores comer-ciais. Uma descrição detalhada e completa sobre o EbFVM pode ser encontrada em Hur-tado (2011).
1.4 REVISÃO BIBLIOGRÁFICAAs equações provenientes da modelagem matemática de escoamentos multifásicoscompõem um sistema não linear acoplado. Dentre as metodologias utilizadas para resol-ver esse sistema, destacam-se os métodos IMPES e totalmente implícito (Chen, 1962). A
seguir, far-se-á uma breve revisão bibliográﬁca de ambos os métodos.
1.4.1 MÉTODO IMPESO método IMPES (IMplicit Pressure Explicit Saturation) foi originalmente desenvolvidopor Sheldon et al. (1959) e Stone & Garder (1961). A ideia fundamental dessa formulaçãoclássica é dividir o sistema de equações acoplado em sistemas de equações distintos parapressão e saturação, os quais são resolvidos de forma implícita e explícita, respectivamente.
O cálculo explícito da saturação acarreta maior simplicidade quanto à implementaçãodo método e menor custo computacional. Entretanto, sua estabilidade está atrelada à uti-lização de pequenos passos de tempo. (Chen, 1962) e Coats (1968) discutem a estabilidadedessa formulação.
Desenvolvimentos posteriores foram realizadas em Coats (1982), Watts (1985) e Young& Stephenson (1983) e outras metodologias baseadas no IMPES foram propostas em Bu-chwalter & Miller (1993),Coats et al. (1995) e Cao & Aziz (2002). Posteriormente, Chen &Li (2004) e Hurtado (2005) discutiram um IMPES modiﬁcado em que diferentes passos detempo para pressão e saturação foram aplicados.
271.4.2 MÉTODO SEQUENCIALA ﬁm de melhorar a estabilidade da formulação IMPES, MacDonald & Coats (1970) pro-puseram uma modiﬁcação na metodologia IMPES na qual após resolver a pressão implici-tamente e a saturação explciitamente, os coeﬁcientes da matriz correspondente ao sistemalinear da pressão são atualizados e os campos de pressão e saturação são calculados até queseus valores se alterem menos que uma tolerância especiﬁcada.
1.4.3 MÉTODO TOTALMENTE IMPLÍCITOO método totalmente implícito ou FIM (Fully Implicit Method) resolve pressão e sa-turação implicitamente e simultaneamente, de forma que ascende a necessidade de re-solver um sistema não linear de equações. A formulação é incondicionalmente estável eapresenta boa solução para diversos problemas numéricos, conforme descrito em Aziz &Settari (1979), Farnstrom & Ertekin (1987), Peaceman (1977) e Watts (1985).
1.5 OBJETIVOS E CONTRIBUIÇÕESDesde sua criação 1981, o SINMEC – Laboratório de Simulação Numérica em Mecâ-nica dos Fluidos e Transferência de Calor, do Departamento de Engenharia Mecânica daUniversidade Federal de Santa Catarina – tem como objetivo o desenvolvimento de me-todologias numéricas utilizando, sobretudo, o método dos volumes ﬁnitos para resolverproblemas que envolvem escoamento de ﬂuidos. A principal linha de pesquisa do labo-ratório consiste no desenvolvimento de algoritmos empregando malhas não estruturadascom o método dos volumes ﬁnitos baseado em elementos (EbFVM). Uma das aplicaçõesde engenharia precípuas nessa área de trabalho é a simulação numérica de escoamentosem reservatórios de petróleo.
Entre 2007 e 2010, o laboratório executou o projeto SIGER I, do qual resultou a biblio-teca EFVLib, dedicada ao gerenciamento da topologia e geometria de malhas não estrutu-radas para a discretização de equações diferenciais parciais pelo método de volumes ﬁnitosbaseado em elementos.
A principal contribuição deste trabalho consiste na implementação de um simuladorbifásico totalmente implícito na biblioteca EFVLib, a qual, anteriormente, não dispunha28de um solver não linear. Almeja-se assim, não apenas introduzir uma nova metologia nabiblioteca, mas também analisar seu desempenho na simulação de reservatórios de petró-leo. Ainda, tendo em vista o elevado custo computacional atrelado ao método totalmenteimplícito e ao emprego de malhas não-estruturadas, deseja-se implementar um esquemade passo de tempo adaptativo. Essa implementação tem como intuito veriﬁcar tanto a sen-sibilidade da solução numérica quanto a melhoria de desempenho.
Os objetivos deste trabalho são:1. Incorporar à EFVlib um método para resolver um sistema não-linear de equações;2. Desenvolver um simulador bifásico imiscível, isotérmico e incompressível para ma-lhas não-estruturadas aplicando o método dos volumes ﬁnitos baseado em elemen-tos;3. Implementar um esquema de passo de tempo adaptativo e veriﬁcar sua inﬂuêncianas soluções numéricas;4. Comparar o simulador totalmente implícito implementado aos métodos IMPES e se-quenciala;1.6 ORGANIZAÇÃO DO TRABALHONo capítulo 2 é apresentada a formulação matemática do problema. São expostos edescritos os conceitos fundamentais à caracterização do modelo, o conjunto de equaçõesdiferenciais que modelam o fenômeno físico e o tratamento das propriedades físicas, dosﬂuidos, da rocha e da interação entre ﬂuidos e rocha.
No capítulo 3 são realizadas as aproximações numéricas que permitem a obtenção dasolução do problema por meio de rotinas computacionais. São apresentados o método dosvolumes ﬁnitos baseado em elementos, as discretizações das equações conservativas e asformulações adotadas para resolver essas equações.
A seguir, no capítulo 4 tem-se a descrição da etapa de implementação computacionaldo modelo matemático e numérico descrito até então. É descrita a maneira com a qualo código em C ++ é implementado a ﬁm de resolver o problema proposto satisfazendo to-aO IMPES disponível na biblioteca – implementado em (Grein, 2015) – foi modiﬁcado para se ajustar àscomparações realizadas neste trabalho.
29dos os requerimentos já elucidados. Expõe-se também uma visão geral do código, a qualfacilita o entendimento do tratamento de dados e de suas relações hierárquicas.
O capítulo 5 se destina à validação do simulador implementado e à apresentação dosresultados obtidos por meio das formulações propostas.
Por ﬁm, no capítulo 6 estão dispostos um sumário, as conclusões e algumas sugestõespara trabalhos futuros.
302 MODELO MATEMÁTICOA obtenção da solução numérica de qualquer problema físico requer sua prévia mode-lagem matemática(Maliska, 2004). Nessa etapa, aspectos físicos e matemáticos são inte-grados a ﬁm de que um fenômeno natural possa ser descrito com um certo grau de acurá-cia, por meio de equações diferenciais. Ressalta-se a importâncias das hipóteses realizadasao longo da modelagem, pois que instituem o grau de proximidade entre a descrição e ofenômeno em si.
Ao longo deste capítulo, apresentar-se-á a modelagem matemática do deslocamentobifásico imiscível. Considerando-se, sobretudo, o escoamento no reservatório, será apre-sentado o conjunto de equações diferenciais que modelam o problema e as variáveis en-volvidas em sua descrição.
Para isso, será apresentada a lei de Darcy na forma de potenciais. A seguir, será de-duzida a equação de conservação da massa de um componente genérico em escoamentomultifásico. Essa equação será, então, adequada às hipóteses e simpliﬁcações do modeloimplementado. Por ﬁm, descrever-se-á o tratamento das propriedades físicas do ﬂuido eda rocha que apresentam dependência em relação às variáveis primárias do problema.
2.1 A LEI DE DARCY NA FORMA DE POTENCIAISNa mecânica dos ﬂuidos em meios porosos, as equações de Navier-Stokes dão lugar àsobservações experimentais expressas matematicamente por meio da Lei de Darcy (Bejan,2004). Essas observações foram relatadas em Darcy (1856), sugerindo que a velocidademédia de um ﬂuido newtoniano escoando em um dado meio poroso sob regime laminar éproporcional ao gradiente de pressão e inversamente proporcional à viscosidade do ﬂuido.
Assumindo-se que o escoamento da fase p no reservatório se dê na presença do campogravitacional e em regime de Stokes (R e ≤ 1), i.e., em baixas velocidades, de forma queas forças viscosas sejam dominantes, a Lei de Darcy para a determinação do campo develocidades up da fase p é dada porK·∇P p − ρp g,up =−k prµp(2.1)
em que K é o tensor permeabilidade absoluta do meio e µp , P p e k pr são, respectivamente31a viscosidade, a pressão e a permeabilidade relativa associadas à fase p (Kaviany, 1995).
Para a formulação numérica, a qual será detalhada posteriormente, faz-se mais con-veniente o emprego da Lei de Darcy na forma de potenciais. Para isso, deﬁne-se a funçãopotencial da fase p comoΦp ≡ P p − ρpG ,(2.2)
em que G é a função potencial gravitacional, dada porG = x· g,(2.3)
sendo x o vetor posição e g, o vetor aceleração da gravidade. Dado isso, o gradiente dopotencial da fase p é∇Φp =∇P p − ρp g.
(2.4)
Substituindo a equação (2.4) na equação (2.1), tem-se a Lei de Darcy modiﬁcada, es-crita na forma de potenciais:up =−k pK·∇Φp .
rµp(2.5)
2.2 EQUAÇÕES FUNDAMENTAIS DO MODELOA ﬁgura 2.1 representa um volume de controle Ω, de volume V , ﬁxo no espaço, extraídode um meio poroso. O vetor área é representado por dS e a fronteira do volume, por ∂ Ω.
Figura 2.1: Volume de controle em um meio porosoFonte: modiﬁcado de (Hurtado, 2005)Uma vez que o modelo é imiscível, o balanço de massa de um componente coincidecom o balanço de massa da fase associada a esse componente. Sendo assim, pode-se efe-tuar o balanço de massa de uma fase p do escoamento multifásico através desse volume32(cid:90)(cid:90)de controle, o qual é dado porρp u p · dS =∂ M p∂ t+F p dV ,(2.6)
∂ ΩVem que F p é a taxa de geração ou extinção de massa da fase p por unidade de volume.
Tendo em vista que a porosidade φ é a razão entre o volume poroso e o volume total domeio e a saturação da fase p é a razão entre o volume ocupado pela fase p e volume porosodo meio, isto é,φ = VφVS p = VpVφe,(2.7)
(cid:90)(cid:90)(cid:90)ρp u p · dS =(cid:90)pode-se escrever∂∂ tρpS p φdV +F p dV .
(2.8)
∂ ΩVV(cid:90)(cid:90)Aplicando-se o Teorema da Divergência de Gauss e a condição de escoamento incompres-sível, tem-seρp∇· u p dV =∂∂ tρpS p φdV +ρp f p dV ,(2.9)
VVVem quef p = F pρp .
(2.10)
Uma vez que o volume de controle é ﬁxo no espaço e o escoamento é incompressível, pode-(cid:90) ∂S p φ +∇· u p − f pS p φ +∇· u p − f p = 0.
se reescrever a equação na formadV = 0.
(2.11)
∂ tVJá que a equação (2.11) deve ser válida para qualquer volume V , deve-se ter∂∂ t(2.12)
A velocidade da fase p pode ser substituída pela Lei de Darcy na forma de potenciais dadaS p φ +∇· (−λp K∇Φp ) − f p = 0,na equação (2.5). A equação da conservação da massa para a fase p é, então:∂∂ t(2.13)
em que λp é a mobilidade da fase p , dada porλp = k pµp .
r(2.14)
Assim, as equações de conservação da massa das fase água e óleo são dadas, respectiva-33S w φ +∇· (−λw K∇Φw ) − f w = 0,S o φ +∇· (−λo K∇Φo ) − f o = 0.
mente, por∂∂ t∂∂ t(2.15)
(2.16)
O modelo bifásico é completado pela equação de restrição volumétricaS w + S o = 1.
(2.17)
Ainda, assumindo-se que os efeitos de pressão capilar são poucos signiﬁcativos, considera-se uma única pressão P . Utilizando a equação∇Φp =∇P − ρp g,(2.18)
a pressão pode ser obtida por meio de um pós processamento tendo em vista que assumiu-se escoamento incompressível. Tem-se, assim, três equações – (2.15), (2.16) e (2.17) – e trêsincógnitas – S w , S o e P .
2.3 PROPRIEDADES FÍSICASNos estudos de um reservatório de petróleo, é de caráter essencial o conhecimento daspropriedades básicas da rocha e dos ﬂuidos nela contidos. São essas propriedades quedeterminam as quantidades dos ﬂuidos existentes no meio poroso, sua distribuição, seucomportamento. É evidente que têm forte inﬂuência sobre a quantidade de ﬂuido quepode ser extraída e, portanto, se fazem muito importantes no contexto de exploração depetróleo (Thomas, 2001).
Esta seção se destina à descrição da obtenção e tratamento das propriedades físicasabarcadas no modelo matemático apresentado. Primeiramente, serão descritas as propri-edades do ﬂuido; posteriormente, da rocha. Por ﬁm, as propriedades associadas ao con-junto rocha-ﬂuido.
2.3.1 PROPRIEDADES DOS FLUIDOS• Viscosidades:A viscosidade é uma medida da resistência do ﬂuido em relação ao escoamento. Estárelacionada diretamente ao tipo e ao tamanho de suas moléculas. Trata-se de um34parâmetro presente em qualquer equação que descreve movimentos de ﬂuidos (Mc-Cain Jr, 1990). A viscosidade é função da pressão e da temperatura. Sua variação emvirtude da temperatura será desconsiderada, pois que o modelo matemático é desti-nado a um escoamento isotérmico. Quanto à pressão, a viscosidade é crescente coma pressão para um reservatório subsaturado; decrescente, para saturado (Trangens-tein & Bell, 1989). Neste trabalho, contudo, as viscosidades da água e do óleo foramconsideradas constantes.
• Densidades:A densidade é a relação entre a massa e o volume da fase. Uma vez que o modeloconsiderado é incompressível, as densidades da água e do óleo permanecem cons-tantes.
2.3.2 PROPRIEDADES DA ROCHA• Porosidade:A porosidade é a razão entre o volume poroso e o volume total da rocha. Neste tra-balho, a rocha reservatório é considerada incompressível.
• Permeabilidade absoluta:A propriedade permeabilidade absoluta da rocha, presente na Lei de Darcy –equação(2.5)–, é a medida de sua capacidade de permitir o ﬂuxo de ﬂuidos. Neste trabalho, apermeabilidade absoluta é representada na forma de um tensor de segunda ordem.
Tal tensor é simétrico, contendo nove componentes Kaviany (1995). A representaçãoé ortotrópica, considerando as direções principais de permeabilidade alinhadas comos eixos de coordenadas x , y , z . Dessa forma, o tensor K é uma matriz puramentediagonal dada por K x x00K =(2.19)
0K y y000Kz z352.3.3 PROPRIEDADES DO CONJUNTO ROCHA-FLUIDO• Permabilidade relativa:No escoamento multifásico em meio poroso, faz-se necessário introduzir a permea-bilidade relativa na Lei de Darcy no intuito de considerar as interações entre os ﬂui-dos (Peaceman, 1977). Permeabilidade relativa é um conceito utilizado para relaci-onar a permeabilidade absoluta (de um ﬂuido único e saturado) à permeabilidadeefetiva do ﬂuido no escoamento multifásico, quando esse ocupa uma fração do vo-lume poroso. Foi observado, experimentalmente, que a permeabilidade relativa éfunção das saturações – seu valor decresce com a diminuição da saturação da fase(Archer & Wall, 1986). Ou seja, essa propriedade associada ao conjunto rocha-ﬂuidointroduz a forma segundo a qual o escoamento é afetado em virtude da presença deoutras fases e da matriz porosa. Trangenstein & Bell (1989) aﬁrmam que a permeabi-lidade relativa depende do volume ocupado por cada fase, da rocha, do histórico doescoamento e da tensão interfacial entre as fases. Essas interações complexas aindanão são totalmente entendidas e dominadas. Pode-se aﬁrmar, contudo, que a mo-vimentação de uma fase também tende à zero conforme sua saturação tende à zero.
Ainda, sabe-se que a fase deve alcançar o estado imóvel antes que sua saturação sejanula (Trangenstein & Bell, 1989).
Optou-se por calcular as permeabilidades relativas da água e do óleo por meio domodelo proposto em Corey et al. (1956). Para caracterizá-lo, deﬁnem-se S pmi n,as saturações máxima e mínima, respectivamente, da fase p . A permeabilidade rela-ma x e S p= αw ˆSn w= αo1− ˆSn o S w − S w− S wtiva desta fase é dada pork wr,(2.20)
k or,(2.21)
em que o parâmetro αp e o expoente n p são constantes conhecidas dependentes dainteração entre a fase e a rocha e a saturação ˆS normalizada é calculada porˆS =mi n.
(2.22)
S wma xmi n363 MÉTODO NUMÉRICOO conjunto de equações que constitui o modelo numérico associado à simulação deum reservatório é, quase sempre, demasiadamente complexo para que o problema físicopossa ser solucionado analiticamente. Advém disso a necessidade de introduzir aproxi-mações à formulação numérica, as quais permitam escrever as equações em um formatopossível de ser resolvido por rotinas computacionais (Aziz & Settari, 1979).
Maliska (2004) aﬁrma que a tarefa do método numérico é resolver um conjunto deequações diferenciais, substituindo as derivadas por expressões algébricas que envolvama função incógnita. Nesse procedimento, obtém-se a solução do problema para um nú-mero discreto de pontos, com um determinado erro. Se o método adotado for consistente,quanto maior o número de pontos, mais perto da solução exata estará a solução aproxi-mada.
Este capítulo é dedicado à apresentação dos método numéricos adotados na soluçãodo modelo bifásico implementado. Serão apresentados o método dos volumes ﬁnitos ba-seado em elementos, as discretizações das equações conservativas e as formulações ado-tadas para resolver o conjunto de equações.
3.1 MÉTODO DOS VOLUMES FINITOS BASEADO EM ELEMENTOSAtribui-se o desígnio de Método dos Volumes Finitos (FVM) a qualquer método numé-rico que satisfaz a conservação da propriedade em níveis elementares no processo de ob-tenção das equações aproximadas (Maliska, 2004).
A abordagem frequentemente adotada para deduzir as equações conservativas con-siste em realizar um balanço de uma determinada propriedade em um volume de controlepertencente ao domínio do problema. O procedimento de fazer esse volume tender a zerofornece as equações diferenciais. Ao invés de utilizá-las diretamente, o Método dos Volu-mes Finitos emprega as equações prévias de balanço. Isso assegura o caráter conservativodo método.
Ressalta-se que muitos dos balanços não são facilmente deduzidos – e.g. para volumesde controle irregulares. Disso provém a preferência por obter as equações discretizadasatravés da integração das equações diferenciais, visto que integrar a forma conservativa ou37divergente da equação diferencial e fazer um balanço da propriedade são procedimentosequivalentes (Maliska, 2004).
O Método dos Volumes Finitos baseado em Elementos (EbFVM) é um Método dos Volu-mes Finitos que explora alguns conceitos provenientes do Método dos Elementos Finitos(FEM) a ﬁm de prover maior ﬂexibilidade geométrica e possibilidade de reﬁnos localiza-dos de malha. Por conseguinte, consegue-se alcançar elevada acurácia de representaçãodo domínio mantendo a característica fundamental do método dos volumes ﬁnitos – o ca-ráter conservativo (Hurtado, 2011). A formulação adotada permite empregar triângulos equadriláteros em malhas bidimensionais; hexaedros, tetraedros, prismas e pirâmides, emmalhas tridimensionais. Essas malhas são não-estruturadas, o que signiﬁca que não há umpadrão que possa descrever a conﬁguração dos vizinhos de um dado elemento (Maliska,2004). O potencial de discretização geométrica de malhas não-estruradas está ilustrada naﬁgura 3.1, a qual ilustra uma malha de 36950 elementos no formato aproximado do terri-tório brasileiro.
Figura 3.1: Potencial geométrico da malha não-estruturadaFonte: do autor383.1.1 ENTIDADES GEOMÉTRICAS DA MALHAA ﬁm de caracterizar completamente uma malha associada a um determinado domí-nio, deve-se deﬁnir o que é uma malha e descrever as entidades que a compõem. Umamalha(cid:77) é a coleção de elementos ei tais que para um domínio fechado Ω tem-seΩ = (cid:91) =(cid:11)Inte je∈(cid:77) e .
(3.1)
Int(ei )(cid:92)Cada e deve possui um interior não vazio. Ainda, deve-se satisfazer∀ i (cid:54)= j.
(3.2)
Isto é, a interseção dos interiores dos elementos deve ser um conjunto vazio (Hurtado,2011). De forma mais simples, pode-se aﬁrmar que os elementos devem cobrir comple-tamente o domínio sem que ocorra superposição ou espaços vazios.
As superfícies que delimitam os elementos são chamadas de facetas. Tratam-se dearestas em elementos 2D e superfícies, em 3D. Cada faceta que não esteja no contornodo domínio é necessariamente compartilhada por dois elementos. Isso signiﬁca que não épossível contato parcial entre as facetas e por conseguinte, a malha é conforme (Hurtado,2011).
As faces dos elementos bidimensionais são deﬁnidas como os segmentos que conec-tam os pontos médios das arestas ao centroide do elemento. A deﬁnição para o caso tri-dimensional é análoga. Essas faces subdividem o elemento em porções denominadas su-belementos, os quais estão associados a duas das faces do elemento – com exceção do ele-mento tridimensional pirâmide, no qual cada subelemento pode estar associado a quatrofaces do elemento.
O campo de uma variável do modelo diferencial é aproximado no EbFVM pelos valo-res discretos em locais coincidentes com os vértices dos elementos da malha, denomina-dos nós. A ﬁgura 3.2 ilustra as principais entidades de uma malha para o elemento maissimples: o triângulo. As deﬁnições para os demais elementos são similares e podem serencontradas em (Hurtado, 2011).
A construção do volume de controle se dá a partir dos elementos dispostos ao redordos nós, conforme ilustrado na ﬁgura 3.3. Logo, a superfície de controle é composta porfaces de elementos.
39Figura 3.2: Principais entidades de um elemento triangularFonte: do autorEm virtude da disposição geométrica, é conveniente que propriedades físicas tais comoporosidade e permeabilidade sejam homogêneas no domínio de um elemento. Assim, nãoascende necessidade de adotar qualquer esquema de interpolação a ﬁm de avaliá-los nasuperfície do volume de controle (Cordazzo, 2006).
Figura 3.3: Construção do volume de controleFonte: do autor3.1.2 ABORDAGEM NUMÉRICAA estratégia adotada a ﬁm de lidar com a distorção geométrica dos elementos contidosem uma malha não estruturada é uma transformação denominada mapeamento. Trata-sede uma função bijetora por meio da qual os pontos no espaço físico são representados naforma de elementos regulares em espaços transformados (Hurtado, 2011).
40Nesse procedimento, um ponto deﬁnido em coordenadas globais – (x , y ) no caso bi-dimensional – passa a ser descrito em termos de coordenadas locais – (ξ, η). A ﬁgura 3.4
ilustra o mapeamento de um elemento triangular para o espaço transformado. Conformeserá veriﬁcado posteriormente, essa transformação facilita a discretizações das equaçõesmodelo.
Figura 3.4: Mapeamento para um espaço transformadoFonte: do autorO mapeamento das coordenadas locais para as globais é realizado empregando fun-ções de forma de primeira ordem oriundas do Método dos Elementos Finitos. Para cadavértice i pertencente a um elemento, há uma função de forma Ni , a qual assume valor 1em i e 0 em todos os outros vértices. Sendo assim, cada ponto p = (x , y , z ) pode ser repre-sentado segundo a expressãonv(cid:88)p =Ni (ξ, η, ζ) pi ,(3.3)
i =1em que pi , i = 1,...,nv , representam os vértices dos elementos; nv , o número de vértices e(ξ, η, ζ), as coordenadas locais de P .
As funções de forma devem ser contínuas, diferenciáveis e partições da unidade, denv(cid:88)forma que sejam valores positivos e satisfaçam a equaçãoNi (ξ, η, ζ) = 1.
(3.4)
i =1para qualquer ponto (ξ, η, ζ) no sistema local de coordenadas Zienkiewicz & Taylor (2000).
Seja ψ uma função deﬁnida nos nós de uma malha. O EbFVM propõe que o valor de ψnv(cid:88)dentro do elemento seja dado pela relaçãoψ(x , y , z ) =Ni (ξ, η, ζ) ψi .
(3.5)
i =1Portanto, o valor de ψ dentro do elemento é uma média ponderada de seus valores nos41vértices do elemento e o peso dessa média é dado pela função de forma.
Uma vez que funções de forma são diferenciáveis, o gradiente de ψ no sistema de co-∂x Ni ψi Ψe ,ordenadas global pode ser expresso conforme∇ψ =∇ nv(cid:88)nv(cid:88)=Ni (ξ, η, ζ) ψi∂y Ni∂z Ni··· ∂x Nnv··· ∂y Nnv··· ∂z NnvTi =1i =1∂x N1 ∂x N2Ψe =⇒∇ψ =∂y N1 ∂y N2∂z N2∂z N1(3.6)
em que... ψnvψ1 ψ2(3.7)
é um vetor com os valores de ψ nos nós do elemento.
As funções de forma, contudo, são usualmente dadas em termos das coordenadas lo-cais e, por conseguinte, utilizar as derivadas de Ni com respeito às coordenadas globais éinconveniente. Aplicando a regra da cadeia:∂ξNi =∂ξx∂ξx∂ξN1 ∂ξN2∂x Ni.
∂ξ y∂ξz∂ηNi∂ζNi∂ηx ∂η y∂ηz∂y Ni∂z Ni(3.8)
∂ζ y∂ζx∂ζzA matriz J dada por∂ξ y∂ξzJ =∂ηx ∂η y∂ηz(3.9)
∂ζx∂ζ y∂ζzé a matriz Jacobiana. Seu cômputo pode ser realizado através da equação (3.3) Hurtado,(2011). Deﬁnindo a matriz··· ∂ξNnv··· ∂ηNnv··· ∂ζNnvD ≡∂ηN1 ∂ηN2∂ζN1 ∂ζN2(3.10)
42pode-se elucidar a equação (3.6) no formato∇ψ = J−1D Ψe .
(3.11)
−1D pode ser considerada como um operador gradiente discreto (Grein, 2015).
A matrix J3.1.3 DISCRETIZAÇÃO DE UMA EQUAÇÃO DE CONSERVAÇÃO DE UMA VARIÁ-VEL GENÉRICAMaliska (2004), propõe que a equação de conservação de uma propriedade genérica ψρψ +∇·ρuψ =∇·Γ∇ψ + F,associada a um escoamento seja escrita na forma∂∂ t(3.12)
em que ρ é a massa especíﬁca, u é a velocidade do ﬂuido, Γ é um coeﬁciente difusivo e F ,um termo fonte associado à propriedade conservada. Na equação (3.12), o primeiro termoé o de acumulação; o segundo, advectivo; o terceiro, difusivo; o quarto, o termo fonte.
A ﬁm de realizar discretização da equação (3.12), realiza-se uma integração dessa equa-ção para cada volume de controle. Almejando a clareza dos procedimentos, cada termoapresentado na equação (3.12) será discretizado separadamente. Considera-se um volumede controle arbitrário P – vide ﬁgura 3.3 – e uma malha ﬁxa.
A discretização do termo de acumulação se dá utilizando a formulação totalmente im-(cid:90)(cid:90)ρψ dV =MPψPMPψP≈ ∂,plícita (Maliska, 2004):∂∂ t∂∂ t∂∂ tρψ dV =(3.13)
∂ tPPem que MP é massa contida no volume P e ψP é média do valor de ψ em P. Essa média é,no Método dos Volumes Finitos, aproximada pelo valor da propriedade no nó. Essa apro-ximação é razoável, pois que o nó se localiza, geralmente, próximo ao centro do volume decontrole.
(cid:90)A discretização do termo fonte é similar:F dV ≈ FPVP,(3.14)
PO termo de transporte advectivo é discretizado por meio da aplicação do Teorema da43(cid:90)(cid:90)(ρu· ˆn)ψ dA ≈(cid:88) ψf =(cid:88)∇·ρuψ dV =ρu· ∆AfDivergência de Gauss:˙m f ψf ,(3.15)
ff∂ PPem que o índice f representa a face do volume de controle; ∂ P , seu contorno; ∆Af o vetorárea associado à face f e ˙m f o ﬂuxo de massa que a atravessa. O valor da propriedade ψfna face no centro da face é calculado a partir de algum método de iterpolação, como CDSou UDS.
Por ﬁm, parte-se à discretização do termo difusivo – o último termo da equação (3.12).
A discretização desse termo é similar àquela realizada para o termo advectivo. Novamente,lança-se mão do Teorema da Divergência de Gauss e da deﬁnição do operador gradiente(cid:90)(cid:90)(Γ∇ψ)· ˆn dA ≈(cid:88)∇·Γ∇ψ dV =(Γ∇ψ)f · ∆Af =Γ J· ∆Af .
discreto – equação (3.11) – para obter−1D Ψe(3.16)
f∂ PPInfere-se das equações discretizadas que as equações discretizadas envolvem, além dopróprio nó associado a P, os nós que compartilham um elemento com o nó P. Sendo assim,esse é o estêncil associado ao EbFVM.
Matematicamente, se(cid:69) P é o conjunto dos elementos que compartilham o nó P e(cid:78) e ,o conjunto dos nós associados ao elemento e , então o estêncil(cid:83) P é dado por(cid:83) P = (cid:91)(cid:78) e .
(3.17)
e∈(cid:69) PGraﬁcamente, a ﬁgura 3.5 exibe em preto os nós, os quais em conjunto, compõem oestêncil associado ao nó P.
Figura 3.5: Estêncil associado ao nó PFonte: adaptado de (Grein, 2015)443.2 EQUAÇÕES DISCRETIZADASEmpregando o procedimento de discretização exposto anteriormente, obtém-se a equa-ção de conservação da massa das fases água e óleo para um dado volume de controle P damalha, as quais sãoold +(cid:88)old +(cid:88)−S w−S o−λw KJ−λo KJ· ∆Af = q w· ∆Af = q o−1D ΦeφP∆VP∆VP,S wP(3.18)
∆te∈(cid:69) PPP−1D ΦeφP∆VP∆VP,S oP(3.19)
∆te∈(cid:69) PPPem que o índice superior old indica o valor da propriedade no passo de tempo anterior, Φeé um vetor com os valores de Φ nos nós do elemento e e(cid:69) P é o conjunto de elementos quecompartilham o nó P.
Em conjunto com a equação de restrição volumétrica equação (2.17) tem-se três equa-ções para as três variáveis primárias: P , S w e S o .
Esse conjunto de equações pode ser, ainda, manipulado algebricamente para que osistema de equações seja resolvido de forma mais conveniente. Somando a equação (3.18)
(cid:88)−λt KJ· ∆Af = q tq t =q w + q oà equação (3.19) e substituindo a equação (2.17) chega-se à conservação da massa global,dada por−1D Φe∆VP,(3.20)
e∈(cid:69) PPem queλt = (λw + λo )e(3.21)
são, respectivamente, mobilidade e termo fonte totais.
As equações a serem resolvidas são as equações de conservação da massa da água –equação (3.18)– e a equação de conservação da massa global – equação (3.20). Assim, háduas equações para duas variáveis primárias – S w e P . A pressão pode ser obtida a partirdo potencial por meio da expressãoΦ = P − ρG .
(3.22)
Já a saturação do óleo pode ser calculada por meio da equação (2.17). Em virtude de sua re-lação estreita com a implementação computacional, a construção do sistema de equaçõesserá explicado apenas no capítulo subsequente.
453.3 FORMULAÇÕES IMPES E SEQUENCIALO método IMPES (IMplicit Pressure Explicit Saturation), em sua formulação clássica,fundamenta-se na divisão do sistema acoplado de equações em sistemas de equações dis-tintos para pressão e saturação, os quais são resolvidos de forma implícita e explícita, res-pectivamente. O cálculo explícito da saturação acarreta menor custo computacional, eestabilidade condicionada a pequenos passos de tempo (Chen, 1962).
(cid:88)old +−λt KJ−1D Φe(cid:88)· ∆Af = q t−λw KJAs equações associadas ao cálculo implícito de P e explícito de S w são, respectiva-mente:∆VP,=S w· ∆Af − ∆t q w(3.23)
e∈(cid:69) PP−1D Φe∆tPφPS wP.
(3.24)
φP∆VPe∈(cid:69) PPO procedimento iterativo para determinar as variáveis primárias do problema atravésdo IMPES clássico é:1. Especiﬁcar os valores inciais das variáveis primárias – P e S w – em todos os volumesde controle da malha;2. Calcular as mobilidades em todos os volumes de controle da malha;3. Interpolar as mobilidades nas faces dos elementos;4. Resolver o sistema linear da equação da pressão – equação (3.23);5. A partir da solução obtida para a pressão, calcular a saturação da água explicitamente– equação (3.24)
6. Avançar a solução no tempo e retornar ao item 2 até atingir a simulação do tempototal desejado.
O método sequencial calcula as variáveis primárias de modo similar. Neste caso, con-tudo, após o passo 5, retorna-se ao 2 até que os campos de pressão e saturação mudemmenos que uma dada tolerância.
463.4 FORMULAÇÃO TOTALMENTE IMPLÍCITANo método totalmente implícito ou FIM (Fully Implicit Method) as váriaveis são re-solvidas de maneira concomitante. Trata-se da formulação mais estável e robusta para asimulação de reservatórios. Apresenta limitações de passo de tempo menos restritivas emrelação aos esquemas que linearizam o acoplamento entre pressão e saturação, como éfeito no método IMPES (IMplicit Pressure, Explicit Saturation). (Chen, 1962).
3.4.1 MÉTODO DE NewtonQuanto à aplicação do FIM, faz-se necessário o emprego de um solver não linear paraa resolução do sistema de equações. No intuito de resolver esse sistema, foi adotado ométodo de Newton contido na biblioteca PETSc (Portable, Extensible Toolkit for ScientiﬁcComputation). As rotinas implementadas nessa biblioteca são eﬁcientes e têm suportepara a resolução dos problemas em paralelo (Balay et al., 2009). Antes de utilizar a PETSc,contudo, as equações devem ser preparadas à aplicação do método de Newton.
A ideia fundamental desse método é mais simples de ser entendida no caso unidimen-sional, no qual deseja-se determinar, de forma iterativa, as raízes de uma função a partir deuma estimativa inicial. Calcula-se a reta tangente à função no ponto associado à estima-tiva. Determina-se, então, a interseção dessa reta tangente com o eixo das abcissas a ﬁmde encontrar uma melhor aproximação para a raiz. Repetindo esse procedimento, tem-seum método iterativo que pode ser utilizado para estimar a raíz de uma função. Matemati-camente, o método de Newton para funções de uma variável é representado porxn+1 = xn − f (xn)f (cid:48)(xn),(3.25)
(cid:48)(xn) é a derivada da função f em xn. Esse procedi-em que n indica a n-ésima iteração e fmento iterativo está ilustrado e descrito na ﬁgura 3.6.
47Figura 3.6: Método de Newton para funções de uma variávelFonte: do autorNo caso de funções de múltiplas variáveis – caso deste trabalho –, o método de New-ton apresentado para uma única variável deve ser expandido a uma forma mais genérica.
Nessa, são resolvidas, simultaneamente, raízes de várias funções, as quais são denomina-das resíduos. As equações resíduo associadas às equações de conservação discretizadassãoold +(cid:88)−S wR t =(cid:88)−λt KJ−λw KJ· ∆Af − q t· ∆Af − q w−1D ΦeφP∆VPR w =∆VP,S wP(3.26)
∆te∈(cid:69) PPP−1D Φe∆VP,(3.27)
e∈(cid:69) PPuma vez que as raízes dessas funções consistem na solução do sistema de equações. Nasequações 3.26 e 3.27 o símbolo R w denota o resíduo associado à conservação da massa daágua e R t , da conservação da massa total. Ambos os resíduos são funções da saturação daágua S w e da pressão P , as quais constituem as variáveis primárias do problema.
48O procedimento iterativo utilizado no intuito de determinar essas variáveis primáriasestá listado a seguir:1. Construir um vetor X com as estimativas das variáveis primárias – P e S w – em todosos volumes de controle da malha;2. Calcular as propriedades e as mobilidades em todos os volumes de controle da ma-lha;3. Interpolar as mobilidades nas faces dos elementos;4. Computar os resíduos de cada equação – R w e R t – em todos os volumes de controleda malha;5. Computar as derivadas parciais dos resíduos em cada nó através da expansão emsérie de Taylor truncadaa= R i (X + dX )− R i (X )∂ R i∂ X;(3.28)
dX6. Resolver o sistema linearJ ∆X =−R;(3.29)
em que J é a matriz jacobiana, contendo todas as derivadas parciais dos resíduos emtodos os volumes; ∆X, o vetor com as correções a serem aplicadas às estimativas e R,o vetor contendo os resíduos correspondentes às estimativas;7. Corrigir o valor das variáveis contidas em X por meio da equaçãoXk+1 = Xk + ∆X;(3.30)
8. Retornar ao item 2 e iterar até que seja atingida a convergência;9. Retornar ao item 2 e avançar a solução no tempo até a simulação do tempo totaldesejado.
Assim, todas as variáveis são resolvidas de forma implícita, e, portanto, podem ser uti-lizados passos de tempo signiﬁcativamente maiores àqueles utilizados em métodos queapresentam algum caráter explícito Aziz & Settari (1979).
aRessalta-se que os resíduos são funções de S w e P , de forma que a derivada numérica em relação a Xdeve levar em conta a contribuição dessas duas variáveis. A forma por meio da qual essas contribuições sãoconsideradas serão detalhadas posteriormente.
49No capitulo ulterior, destinado ao tema implementação computacional, procedimen-tos tais como a construção da matriz jacobiana serão mais bem detalhados.
504IMPLEMENTAÇÃO COMPUTACIONALConquanto as fases de modelagem matemática e numérica detenham papeis funda-mentais à acurácia com a qual o fenômeno físico é representado, é por meio da implemen-tação computacional que se obtêm os resultados concretos através da simulação numéricado problema. Maliska (2004) aﬁrma que o desenvolvimento de um bom programa com-putacional requer a harmonia entre o uso das ferramentas computacionais disponíveis, aestratégia de depuração dos erros e a ulterior interpretação correta dos resultados.
Este capítulo se destina à descrição de alguns aspectos relacionados à implementaçãocomputacional. Também proporciona uma visão geral do simulador do ponto de vista deprogramação. Isso facilita o entendimento da forma por meio da qual o conjunto de dadosfísicos foi tratado e da inter-relação entre cada módulo implementado. A possibilidadede adquirir essa visão é importante, pois que estreita o caminho entre a percepção de umfenômeno físico e a capacidade de obter algum resultado a partir das equações abstratasque o modelam.
Primeiramente, as metodologias IMPES e totalmente implícita serão explicadas do pontode vista de implementação. Posteriormente, será explicado um esquema de passo de tempoadaptativo implementado a ﬁm de reduzir o esforço computacional de ambas as formula-ções.
4.1 MÉTODOS IMPES E SEQUENCIALO método IMPES, conforme já discutido anteriormente, é mais simples e direto doponto de vista de implementação, quando comparado ao método totalmente implícito.
Esta seção de destina ao esclarecimento da abordagem computacional utilizada para ob-ter a solução do problema. Primeiramente, será exposta a estrutura geral do simulador.
A seguir, serão brevemente descritos os procedimentos de cálculo implícito da pressão eexplícito da saturação. Para mais detalhes quanto ao tratamento numérico do modelo pormeio do método dos volumes ﬁnitos baseado em elementos, consultar Hurtado (2011).
514.1.1 ESTRUTURA GERAL DO SIMULADORA simulação do escoamento bifásico por meio da formulação IMPES é fundamentadoem uma classe denominada Simulator. Essa classe é responsável por administrar a reso-lução implícita da pressão por meio da classe TwoPhasePressureComputer e pelo cálculoexplícito da saturação, por meio da classe WaterSaturationComputer. Ainda há classesderivadas das classes abstratas Event e Controller, as quais são, respectivamente, desti-nadas à execução de eventos – e.g. avanço no tempo e exportação de dados – e controle dasimulação – e.g. veriﬁcar convergência e chegada ao tempo ﬁnal de simulação. A relaçãoentre essas classes está ilustrada esquematicamente na ﬁgura 4.1.
Figura 4.1: Classes responsáveis pela simulação pelo método IMPESFonte: do autor4.1.2 CÁLCULO IMPLÍCITO DA PRESSÃOO cálculo implícito da pressão consiste em resolver o sistema linear constituído pelasequações de conservação da massa total para cada nó da malha. A equação para o nó P édada por(cid:88)−λt KJ· ∆Af = q t−1D Φe∆VP.
(4.1)
e∈(cid:69) PPA ﬁm de adicionar os termos da equação (4.1) à matriz do sistema linear da pressão semexecutar procedimentos duplicados, procede-se conforme o pseudocódigo representadona listagem 4.1. A estrutura ﬁnal da matriz do sistema linear está ilustrada, para uma malhabidimensional simples, na ﬁgura 4.2.
52Figura 4.2: Exemplo de estrutura da matriz do sistema linear da pressãoFonte: modiﬁcado de (Hurtado, 2011)53Listagem 4.1: Pseudocódigo da rotina que resolve o sistema linear da pressão1 PARA todos os elementos da malhaPARA todas as faces do elemento2PARA todos os nós do elemento3calcular contribuição do nó no ﬂuxo difusivo4adicionar contribuição às equações referentes aos nós atrás ...
5... e à frente da face6FIM PARA7FIM PARA89 FIM PARAJá o termo do lado direito da equação (4.1) é adicionado diretamente ao termo inde-pendente, por meio de uma varredura dos nós do poço ou da fronteira com condição decontorno do tipo Neumann. Caso a condição de contorno seja do tipo Dirichlet as linhasda equação dos nós da fronteira são zeradas, exceto a entrada da diagonal principal, à qualé atribuído o valor 1. Ao termo independente é, então, atribuído o valor prescrito. Dadasas montagens da matriz e do termo independente, tem-se o sistema linear, do qual sãocalculadas as pressões para um determinado passo de tempo.
4.1.3 CÁLCULO EXPLÍCITO DA SATURAÇÃOO cálculo explícito da saturação é dado a partir dos valores de pressão calculados im-(cid:88)· ∆Af − ∆t q w−λw KJ=S wold +plicitamente para o passo de tempo em questão. A equação resolvida explicitamente é−1D Φe∆tPφPS wP.
(4.2)
φP∆VPe∈(cid:69) PPA maneira de construir a equação explícita é análoga àquela relativa ao sistema linear.
Nesse caso, contudo, não há necessidade de montar a matriz com essas contribuições, poisque os valores de pressão são conhecidos e pode-se efetuar o somatório presente na equa-ção (4.2) diretamente.
544.2 MÉTODO TOTALMENTE IMPLÍCITOO método totalmente implícito é mais laborioso tanto do ponto de vista de formulaçãoquanto de implementação. Há de se atentar para diversos detalhes referentes não somenteao método numérico em si, mas também aos aspectos computacionais envolvidos em suaconcepção. Esta seção se destina ao esclarecimento da abordagem computacional utili-zada para obter a solução do problema. Primeiramente, será exposta a estrutura geral dosimulador. A seguir, serão detalhados os procedimentos de cálculo dos resíduos e contru-ção da matriz jacobiana.
4.2.1 ESTRUTURA GERAL DO SIMULADORA simulação do escoamento bifásico por meio da formulação totalmente implícita éfundamentado em uma classe denominada TwoPhaseFlowComputer. Essa classe é res-ponsável por administrar a resolução do sistema não linear, a qual é efetuada com o su-porte da biblioteca PETSc (Balay et al., 2013). Para isso, a TwoPhaseFlowComputer pos-sui classes responsáveis por calcular as mobilidades (MobilityCalculator); montar osresíduos (ResidualsAssembler); montar a matriz jacobiana (JacobianAssembler) eexportar a solução numérica de forma que essa possa ser visualizada convenientemente(TwoPhaseFlowExporter). A relação entre essas classes está ilustrada esquematicamentena ﬁgura 4.3.
Figura 4.3: Classes responsáveis pela simulação pelo método FIMFonte: do autorA classe TwoPhaseFlowComputer contém a função responsável pela resolução do sis-tema não linear, a qual está representada em pseudocódigo na listagem 4.2. As opera-55ções executadas nas linhas 2 e 3 da listagem são executadas, respectivamente, pelas classesResidualsAssembler e JacobianAssembler. A linha 6, por sua vez, se refere ao passode tempo adaptativo já explicado anteriormente.
Listagem 4.2: Pseudocódigo da rotina que resolve o sistema não linear1 Alocar memória para o vetor de resíduos2 Alocar memória para a matriz jacobiana3 REPETIRResolver o sistema não linear utilizando a PETSc ...
4...( informando à biblioteca a implementação própria das funções ...
5... de montagem do vetor de resíduos e da matriz jacobiana)6SE convergência atingida e saturação consistente ENTÃO7Ajustar passo de tempo8Avançar a solução no tempo9SE NÃO10Ajustar passo de tempo11FIM SE1213 ENQUANTO tempo ﬁnal atingido4.2.2 CÁLCULO DOS RESÍDUOSA ﬁm de facilitar a indexação das variáveis, optou-se por dispô-las de forma que a sa-turação e a pressão de um dado volume de controle consistam em entradas adjacentes dovetor de resíduos. A classe ResidualsAssembler dispõe de uma função que calcula osresíduos R w e R t e já os adiciona nas posições corretas do vetor resíduo. Essa adição é feitapor etapas nas quais são calculados os termos difusivo, acumulativo e fonte denotados,respectivamente, por αdif, αac e αfon nas equações a seguir:(cid:125)(cid:124)(cid:123)old+(cid:122)(cid:122)(cid:88)(cid:125)(cid:124)−λw KJ−1D Φe(cid:123)(cid:122) (cid:125)(cid:124) (cid:123)· ∆Af − αw−S wαwacαwdiffonφP∆VPR w =∆VP .
S wPq wP(4.3)
∆te∈(cid:69) PP56(cid:122)(cid:88)(cid:125)(cid:124)−λt KJ−1D Φe(cid:123)(cid:122) (cid:125)(cid:124) (cid:123)· ∆Af − αtαtdiffonR t =∆VP,q tP(4.4)
e∈(cid:69) PA função responsável por esses cálculos está representada em pseudocódigo na listagem4.8. As quatro subrotinas chamadas na listagem 4.8 serão explicadas nos itens a seguir.
Listagem 4.3: Pseudocódigo da rotina que computa os resíduos1 CHAMA função que adiciona o termo difusivo2 CHAMA função que adiciona o termo acumulativo3 CHAMA função que adiciona termo fonte4 CHAMA função que aplica condições de contornoADIÇÃO DO TERMO DIFUSIVO A adição dos termo difusivos correspondentes às equações=(cid:88)=(cid:88)−λw KJ−λw KJ· ∆Af· ∆Af ,de conservação da massa da água e global,−1D Φe−1D Φeαwdifαte(4.5)
e∈(cid:69) Pe∈(cid:69) Pdiffoi implementada de forma que não fossem realizados cálculos e procedimentos duplica-dos. A listagem 4.4 contém o pseudocódigo da função que executa essa operação.
Listagem 4.4: Pseudocódigo da rotina que adiciona o termo difusivo nos resíduos1 PARA todos os elementos da malhaPARA todas as faces do elemento2calcular ﬂuxo difusivo de água3calcular ﬂuxo difusivo total4adicionar ﬂuxos nas equações referentes aos volumes de controle ...
5... separados pela face6FIM PARA78 FIM PARA57Ressalta-se que as mobilidades λw e λt devem ser avaliadas nas faces. Tendo em vistaque a mobilidade é função de variáveis primárias armazenadas nos nós, essas são primei-ramente avaliadas nos nós. Posteriormente, esses valores são interpolados a ﬁm de deter-minar as mobilidades na face do volume de controle. Essa interpolação foi realizada peloesquema upwind, o qual tem relação direta com o termo parabólico da equação, i.e., o valorda função na interface é igual ao valor do volume de controle a montante (Maliska, 2004).
 λpMatematicamente, tem-sese Vp · ∆Af (cid:190) 0 ;se Vp · ∆Af < 0 ,=nBλpnFλpf(4.6)
onde nB e nF indicam os nós atrás e a frente da face, conforme mostrado na ﬁgura 4.4.
Figura 4.4: Esquema de interpolação upwind em elemento triangularFonte: do autorADIÇÃO DO TERMO ACUMULATIVO A função que adiciona o termo acumulativo da equa-old−S wção da conservação da massa da água,φP∆VP=αwacS wP,(4.7)
∆tPpor sua vez, é mais direta e está representada na listagem 4.5. Tendo em vista que essetermo não necessita interpolações e cálculos envolvendo outras entidades além dos nós,pode-se varrer os nós da malha diretamente. Ressalta-se, pois, que esse termo deve seradicionado apenas à equação da conservação da massa da água, porquanto a equação derestrição volumétrica cancela esse termo na equação de conservação da massa totala.
aEssa simpliﬁcação só se aplica em caso de escoamento incompressível.
58Listagem 4.5: Pseudocódigo da rotina que adiciona o termo acumulativo nos resíduos1 PARA todos os nós da malhacalcular termo acumulativo2adicionar termo na equação de conservação da massa da água34 FIM PARAADIÇÃO DO TERMO FONTE A função que adiciona os termos fontes correspondentes àsequações de conservação da massa da água e global,= q w= q tP,αwfonαte(4.8)
Pfonveriﬁca os poços localizados ao longo da malha, e, a partir da informação sobre sua ope-ração – pressão constante ou vazão constante – adiciona o valor adequado ao resíduo dasequações associadas aos volumes de controle nos quais os poços se encontram. Tendo emvista que esse termo não necessita interpolações e cálculos envolvendo outras entidadesalém dos nós, pode-se varrer os nós da malha diretamente e adicionar os termos fonte. A
função responsável por adicioná-los aos resíduos está representada em pseudocódigo nalistagem 4.6.
qpoço = λp WIPP− Ppoço,A vazão nos poços cuja condição de operação é pressão prescrita é calculada por meioda equação(4.9)
em que qpoço é a vazão da fase p no sentido reservatório-poço, WI é o well index ou índicede poço, PP é a pressão no nó P do reservatório e Ppoço é a pressão de fundo de poço. Nestetrabalho, o índice de poço foi calculado realizando uma adaptação do modelo de Peace-man (1978), utilizando a expressão req,WI = 2πKh(4.10)
lnrpoçoem que h é o comprimento do poço, rpoço é o raio do poço e req é o raio equivalente, o qualnesse trabalho foi calculado como metade do diâmetro hidráulico do volume de controleassociado ao poço por meio da equaçãoreq = Volume do volume de controle associado ao poçoÁrea da superfície de controle associada ao poço.
(4.11)
59Listagem 4.6: Pseudocódigo da rotina que adiciona o termo fonte nos resíduos1 PARA todos os poços da malhaSE poço opera com pressão constante2calcula vazão no poço a partir de sua pressão de operação3adiciona vazão às equações dos volumes de controle do poço4FIM SE5SE poço opera com vazão constante6adiciona vazão às equações dos volumes de controle do poço7FIM SE89 FIM PARAAPLICAÇÃO DAS CONDIÇÕES DE CONTORNO Quanto à imposição das condições de con-torno, optou-se por considerar condições de Neumann e Dirichlet. Quanto à imposição deﬂuxo prescrito – condição de contorno de Neumann – preferiu-se prescrever velocidade, aﬁm de que o problema a ser resolvido ﬁcasse independente da malha utilizada.
Ressalta-se que em malhas não estruturadas tanto a face quanto o nó nos quais sãoprescritas condições de Neumann e Dirichlet, respectivamente, estão localizados sobre ocontorno. Essa conﬁguração geométrica pode ser visualizada na ﬁgura 4.5, em que estáilustrado um volume de controle adjacente ao contorno. É importante ressaltar que o vo-lume de controle associado ao nó P é interior ao domínio, ao passo que o nó está sobre afronteira.
A condição de Neumann é imposta diretamente fazendo, nas equações (4.3) e (4.4),
= q w= q tP,αwfonαte(4.12)
Pfon= (cid:88)= (cid:88)em que q wP e q tP são as vazões volumétricas de água e total, obtidas através de(V w + V o )∆Abf,V w ∆Abfq wPq tPe(4.13)
bf∈ (cid:70)bbf∈ (cid:70)bPPem que (cid:70)bP é o conjunto de faces que formam a parte da superfície de controle associadaao nó P que está localizada sobre a fronteira e bf são as faces contidas nesse conjunto. Já
V w e V t são as velocidades de água e total prescritas, respectivamente.
No caso de condição de contorno de Dirichlet, elimina-se a equação da variável co-60Figura 4.5: Volume de controle adjacente ao contornoFonte: modiﬁcado de (Maliska et al., 2015)nhecida e, em seu lugar, insere-se apenas o valor unitário na diagonal principal da matrizjacobiana. O resíduo, por sua vez, recebe o valor zero.
O pseudocódigo da função destinada à aplicação das condições de contorno está re-presentada por meio de pseudocódigo na listagem 4.7. A face de contorno mencionadano algoritmo é uma entidade da fronteira, a qual está ilustrada na ﬁgura 4.5 juntamente àsoutras entidades das fronteiras da malha.
Listagem 4.7: Pseudocódigo da rotina que aplica as condições de contorno nos resíduos1 PARA todas as fronteiras com condição de contorno do tipo NeumannPARA todos os elementos da fronteira2PARA todas as faces do elemento3adicionar ﬂuxo prescrito na equação do nó associado ...
4... à face de contorno5FIM PARA6FIM PARA78 FIM PARA9 PARA todas as fronteiras com condição de contorno do tipo DirichletPARA todos os nós da fronteira10adicionar zero nas equações do nó11FIM PARA1213 FIM PARA614.2.3 CONSTRUÇÃO DA MATRIZ JACOBIANAO cálculo da matriz jacobiana é a parte mais custosa e complexa dos algoritmos desolução de sistemas não lineares. Ainda, sua construção é diferenciada em se tratando dométodo dos volumes ﬁnitos baseado em elementos, pois que esse método se fundamentaem varreduras nos elementos da malha computacional.
Um aspecto relevante do processo de montagem da matriz jacobiana é sua estrutura,a qual deve ser compativel àquela associada ao vetor resíduo. Uma vez que a indexação devariáveis se deu de forma que as equações de conservação da massa da água e total de umdeterminado volume de controle fossem adjacentes, tem-se:∂ R w1∂ S1∂ R t1∂ S1...
∂ R wn∂ S1∂ R tn∂ S1∂ R w1∂ P1∂ R t1∂ P1...
∂ R wn∂ P1∂ R tn∂ P1∂ R w1∂ Sn∂ R t1∂ Sn...
∂ R wn∂ Sn∂ R tn∂ Sn∂ R w1∂ Pn∂ R t1∂ Pn...
∂ R wn∂ Pn∂ R tn∂ Pn∆S1∆P1...
R w1R t1...
...
=−...
...
,(4.14)
∆SnR wn...
∆PnR tn...
= RP(x j + ∆x j )− RP(x j )em que∂ RP∂ x j.
(4.15)
∆x jNa equação (4.15), P é o volume de controle em que se deseja calcular a derivada e RPé o resíduo, o qual pode ser associado à equação de conservação da massa da água ou totaldo nó P. Já x j é a variável em relação à qual a derivada é calculada. Ressalta-se que x j éum componente do vetor solução, o qual possui tanto S w quanto P em suas entradas, i.e.,
a variável x j representada na equação (4.15) pode ser tanto saturação quanto pressão.
Quanto à estrutura da matriz, pode-se veriﬁcar que cada linha é composta pelas deri-vadas de uma única equação do resíduo, ao passo que cada coluna contém as derivadas emrelação a uma única variável. Ademais, a equação (4.14) consiste na equação (3.29) com oscoeﬁcientes explicitados.
Na ﬁgura 4.6 pode-se visualizar um exemplo de estrutura da matriz jacobiana. É inte-ressante notar que a estrutura da matriz do sistema linear da pressão no método IMPES,representada na ﬁgura 4.2 é semelhante àquela associada à matriz jacobiana e exposta naﬁgura 4.6. Esta última, contudo, é composta por blocos – matrizes 2x2 nas quais estão62dispostas as derivadas numéricas de R w e R t em relação à S w e P , conforme ilustrado naﬁgura.
Figura 4.6: Exemplo de estrutura da matriz jacobianaFonte: modiﬁcado de (Maliska et al., 2015)A ﬁm de efetuar o cálculo das derivadas numéricas que compõem a matriz jacobianade forma mais conveniente e eﬁcaz, as equações resíduo podem ser escritas na formaR w = αwac+ αwdif+ αwfonR t = αtac+ αtdif+ αtefon.
(4.16)
63αwαw = = = =Assim, as derivadas numéricas associadas ao resíduo R w são dadas por∂ αwdif∂ Sj∂ αwfon∂ Sj∂ αwac∂ Sj∂ R wP∂ Sj∂∂ Sj++=+ αwdif+ αwfon,(4.17)
ac∂ αwac∂ Pj∂ αwdif∂ Pj∂ αwfon∂ Pj∂ R wP∂ Pj∂∂ Pj++=+ αwdif+ αwfon,(4.18)
acαtαte as derivadas numéricas associadas ao resíduo R t , por∂ αtfon∂ Sj∂ αtdif∂ Sj∂ R tP∂ Sj∂∂ Sj+ αt=+,(4.19)
diffon∂ αtfon∂ Pj∂ αtdif∂ Pj∂ R tP∂ Pj∂∂ Pj=++ αt.
(4.20)
diffonDado isso, infere-se que a montagem da matriz jacobiana pode ser realizada conside-rando separadamente as contribuições devidas aos termos difusivo, acumulativo e fonte.
A classe JacobianAssembler dispõe de uma função responsável por calcular cada umadessas contribuições e adicioná-las à matriz jacobiana. Essa função é semelhante àqueladestinada a calcular os resíduos. Seu pseudocódigo está contido na listagem 4.8. As quatrosubrotinas chamadas na listagem 4.8 serão explicadas nos itens a seguir.
Listagem 4.8: Pseudocódigo da rotina que monta a matriz jacobiana1 CHAMA função que adiciona o termo difusivo2 CHAMA função que adiciona o termo acumulativo3 CHAMA função que adiciona termo fonte4 CHAMA função que aplica condições de contornoADIÇÃO DO TERMO DIFUSIVO Quanto à função que adiciona a contribuição do termo di-fusivo à matriz jacobiana, procurou-se efetuar a implementação computacional de formaa tentar minimizar procedimentos repetidos. Essa preocupação se deu, sobretudo, em re-lação às varreduras das entidades da malha.
Lembrando que termos difusivos são dados conforme a equação (4.5), as derivadasnuméricas do termo difusivo podem ser calculadas por64j ,Pj )− αw+ ∆S w(S wjj ,Pj + ∆Pj )− αt(S w∆Pjj ,Pj )− αw(S w+ ∆S wjj ,Pj + ∆Pj )− αt(S w(S wj ,Pj )αwdif∂ αwdif∂ Sj∂ αwdif∂ Pj∂ αtdif∂ Sj∂ αtdif∂ Pj=dif,(4.21)
∆S wjj ,Pj )(S wαwdif=dif,(4.22)
(S wj ,Pj )αt=difdif,(4.23)
∆S wj(S wj ,Pj )αt=difdif,(4.24)
∆Pjj é uma perturbação na saturação e ∆Pj , na pressão do nó j . Isto é, as deriva-em que ∆S wdas parciais dos resíduos calculadas numericamente consistem em subtrair o ﬂuxo difusivoperturbado do ﬂuxo difusivo não perturbado e dividir esse valor pela perturbação. Optou-se por armazenar o ﬂuxo não perturbado já na etapa da construção dos resíduos. Sendoassim, a função da classe JacobianAssembler, cujo intuito é adicionar os termos difu-sivos à matriz jacobiana, deve calcular o ﬂuxo perturbado, para então calcular a derivadanumérica e adicioná-la à matriz.
A ﬁm de realizar esse cálculo, dá-se primeiro a perturbação da saturação; depois, dapressão. Para o primeiro caso, faz-se a varredura dos elementos da malha e para cada nódo elemento, perturba-se a saturação, calcula-se os ﬂuxos nas faces e adiciona-se esse valorà matriz jacobiana.
O mesmo procedimento é realizado para a perturbação da pressão. Contudo, nestecaso pode-se ocasionar uma mudança no sentido dos ﬂuxos e, por conseguinte, nas mobi-lidades nas faces, interpoladas por upwind. Para simpliﬁcar o cálculo dessas mobilidades,=−KJ· ∆Af.
deﬁne-se o pseudoﬂuxo na face f , dado por−1D Φeθ pf(4.25)
Esse pseudoﬂuxo, apesar de não apresentar o valor correto do ﬂuxo difusivo, contém a in-formação referente a seu sentido, e pode, portanto, ser utilizado para determinar os valorescorretos de mobilidade.
Os procedimentos de perturbação da saturação e da pressão para a montagem da ma-triz jacobiana estão representados de forma mais detalhada na listagem 4.9.
65Listagem 4.9: Pseudocódigo da rotina que adiciona o termo difusivo na matriz jacobiana{Perturbação da saturação}12 PARA todos os elementos da malhaPARA todos os vértices do elemento3perturbar saturação do vértice4calcular mobilidade do vértice perturbado5PARA todas as faces do elemento6PARA todos os vértices do elemento7calcular contribuição do nó no ﬂuxo perturbado da face8adicionar contribuição ao ﬂuxo perturbado da face9FIM PARA10adicionar ﬂuxo perturbado dividido pela perturbação à matriz ...
11... nas equações dos nós nF e nB da face12subtrair ﬂuxo perturbado dividido pela perturbação à matriz ...
13... nas equações dos nós nF e nB da face14FIM PARA15FIM PARA1617 FIM PARA18{Perturbação da pressão}1920 PARA todos os elementos da malhaPARA todos os vértices do elemento21perturbar pressão do vértice22calcular pseudoﬂuxo23calcular mobilidade do vértice perturbado24PARA todas as faces do elemento25PARA todos os vértices do elemento26calcular contribuição do nó no ﬂuxo perturbado da face27adicionar contribuição ao ﬂuxo perturbado da face28FIM PARA29adicionar ﬂuxo perturbado dividido pela perturbação à matriz ...
30... nas equações dos nós nF e nB da face31subtrair ﬂuxo perturbado dividido pela perturbação à matriz ...
32... nas equações dos nós nF e nB da face33FIM PARA34FIM PARA3536 FIM PARA66No intuito de prover uma visualização menos abstrata da função responsável por mon-tar a matriz jacobiana, ilustrou-se um exemplo na ﬁgura 4.7. Nela, considera-se uma malhacomposta por um único elemento triangular. Admite-se, também, que está sendo realizadaa etapa de perturbação da saturação. Dá-se, então, a perturbação da saturação do nó cujoíndice é 0.
Uma vez que a perturbação é da variável correspondente à primeira equação do sis-tema, esse procedimento proverá as contribuições do termo difusivo à primeira coluna damatriz. Dada a perturbação da saturação e o cálculo das mobilidades perturbadas nas facesdo elemento, parte-se à varredura das faces. Para cada face, varre-se os nós do elementocalculando a contribuição do nó aos ﬂuxos difusivos perturbados de água e total. Faz-se,então, o cálculo da derivada numérica a partir dos valores de ﬂuxos perturbado, não per-turbado e perturbação. Essa derivada é, pois, adicionada às equações dos nós associados aessa face. Por exemplo, à face f0, estão associados os nós 0 e 1. Sendo assim, são calculadasas seguintes derivadas:∂αw∂αt∂αw∂αtdif∂ S0dif∂ S0dif∂ S0dif∂ S00011,,,.
(4.26)
Esses coeﬁcientes são relacionados às equações 0, 1, 2 e 3, respectivamente, i.e. conserva-ção da massa da água do nó 0, conservação da massa total do nó 0, conservação da massada água do nó 1 e conservação da massa total do nó 1. Constituem, portanto, contribui-ções às entradas (0,0), (1,0), (2,0) e (3,0) da matriz jacobiana. A ﬁgura 4.7 ainda apresentaa sequência do processo de varredura das faces do elemento, ilustrando as contribuiçõesdos ﬂuxos através das faces f1 e f2.
Para continuar a montagem da matriz, ter-se-ia de realizar o mesmo procedimentoincrementando as saturações dos nós 1 e 2, processo do qual seriam calculadas as colunas2 e 4 da matriz – referentes às equações de conservação da massa da água dos nós 1 e 2.
Por ﬁm, o mesmo procedimento seria feito incrementando as pressões dos nós 0, 1 e2, procedimento do qual seriam determinadas as colunas 1, 3 e 5, referentes às equaçõesde conservação da massa total dos nós 0, 1 e 2. Conforme já explicitado, a única diferençaentre esse processo de perturbação de pressão é a necessidade de calcular o pseudoﬂuxonas faces do elemento.
67Figura 4.7: Exemplo de etapa de montagem da matriz jacobianaFonte: do autor68ADIÇÃO DO TERMO ACUMULATIVO Adicionar o termo acumulativo à matriz jacobiana émuito mais simples que adicionar o termo difusivo. Isso porque só há termo de acumula-ção na equação da conservação da massa da água e, além disso, o resíduo desse termo éold−S wfunção exclusiva e linear da saturação:φP∆VP=αwacS wP.
(4.27)
∆tPA derivada parcial, pois, consiste em um valor constante e que pode ser calculado direta-mente para cada nó da malha:∂ αwac∂ S wφP∆VP=.
(4.28)
∆tA listagem 4.10 representa o pseudocódigo da função que adiciona esse termo à jacobiana.
Listagem 4.10: Pseudocódigo da rotina que adiciona o termo acumulativo na matriz jacobiana1 PARA todos os nós da malhacalcular derivada do termo acumulativo2adicionar derivada à matriz jacobiana na equação de conservação da ...
3... massa da água do nó45 FIM PARAADIÇÃO DO TERMO FONTE A função que adiciona o termo fonte veriﬁca os poços locali-zados ao longo da malha, e, a partir da informação sobre sua operação – pressão constanteou vazão constante – adiciona o valor adequado à matriz jacobiana. Os termos fonte devi-dos aos poços são= q w= q tP.
αwfonαte(4.29)
PfonAssim, se o poço opera com vazão constante, a derivada numérica é nula, logo não épreciso varrer os poços que operam sob essa condição. Já para os poços de pressão cons-= λp WIPP− Ppoço= λt WIPP− Ppoço.
tante tem-seαwfonαte(4.30)
fonPortanto, os termos fonte correspondentes aos poços que operam sob a condição depressão constante são funções de S w e P . São necessárias, então, as perturbações da satu-69ração e da pressão de forma a calcular suas contribuições à matriz jacobiana. Essa funçãoestá representada em pseudocódigo na listagem 4.11
Listagem 4.11: Pseudocódigo da rotina que aplica as condições de contorno na matriz jacobiana{Perturbação da saturação}12 PARA todos os poços da malhaSE poço opera com pressão constante3PARA cada vértice contido no poço4perturbar saturação do nó5calcular mobilidade perturbada6calcular ﬂuxo perturbadocalcular derivada e adicioná−la à matriz nas equações de ...
78... conservação do nó9FIM PARA10FIM SE1112 FIM PARA{Perturbação da pressão}1314 PARA todos os poços da malhaSE poço opera com pressão constante15PARA cada vértice contido no poço16perturbar pressão do nó17calcular mobilidade perturbada18calcular ﬂuxo perturbadocalcular derivada e adicioná−la à matriz nas equações de ...
1920... conservação do nó21FIM PARA22FIM SE2324 FIM PARAAPLICAÇÃO DAS CONDIÇÕES DE CONTORNOSe a fronteira apresentar condição de con-torno do tipo Neumann, a derivada numérica de sua contribuição é nula. Apenas ascende,pois, a necessidade de varrer as fronteiras cuja condição de contorno é do tipo Dirichlet. A
imposição dessa condição é bastante simples – basta zerar as linha referentes às equações70dos nós da fronteira e atribuir o valor unitário às entradas da diagonal principal. A funçãoresponsável pela aplicação das condições de contorno à matriz jacobiana está represen-tada por meio de pseudocódigo na listagem 4.12.
Listagem 4.12: Pseudocódigo da rotina que aplica as condições de contorno na matriz jacobiana1 PARA todas as fronteiras com condição de contorno do tipo DirichletPARA todos os nós da fronteira2zerar as entradas das linhas associadas às equações do nó3setar valor unitário na diagonal principal dessas linhas4FIM PARA56 FIM PARA4.3 PASSO DE TEMPO ADAPTATIVOAlmejando poupar esforço computacional demasiado e, simultaneamente, prevenir aespeciﬁcação de passos de tempo excessivamente altos, foi implementado um esquemade modiﬁcação do passo de tempo inicialmente especiﬁcado na simulação a partir da di-ferença do campo de saturação calculado em relação ao campo de saturação antigo, i.e.,
associado ao passo de tempo anterior. O funcionamento desse esquema está esquemati-zado por meio de um ﬂuxograma na ﬁgura 4.8.
Devem ser especiﬁcados pelo usuário cinco parâmetros de entrada: o passo de tempoinicial ∆t , a diferença máxima de saturação ∆Smax, a diferença mínima de saturação ∆Smine as duas constantes αaum e αred. A ideia central do esquema de passo de tempo adaptativoé ajustar o passo de tempo de acordo com a magnitude da variação do campo de saturaçãoa partir da especiﬁcação de um valor de αaum superior ao valor unitário e de αred, inferior.
Dessa forma, caso a diferença entre a saturação atual e a saturação antiga exceda ∆Smax emalgum volume de controle, o passo de tempo é reduzido por meio da expressão∆t = αred∆t .
(4.31)
e a solução no nível de tempo em questão é recalculada. Por outro lado, se essa diferençafor inferior a ∆Smin em todos os volumes de controle, permite-se um aumento do passo de71tempo calculando-o por meio de∆t = αaum∆t .
(4.32)
Almejando dispor de mais indicativos quanto à adequação do valor do passo de tempo,também são efetuadas veriﬁcações quanto à convergência da solução. Se ocorrer diver-gência de algum sistema linear, ou até mesmo do sistema não-linear no caso do métodototalmente implícito, o passo de tempo é reduzido utilizando a equação (4.31) e não se dáo avanço no tempo, mas sim calcula-se a solução novamente com um passo de tempo devalor mais baixo. Considera-se também como divergência o caso em que o método se-quencial efetua o número máximo de iterações em um mesmo passo de tempo sem atingira tolerância requerida.
Ademais, ainda é veriﬁcado se o campo de saturação é ﬁsicamente consistente iden-tiﬁcando se as saturações de todos os volumes de controle possuem valores entre 0 e 1−6. Se essa condição não ocorrer, procede-se como no caso dadivergência, reduzindo o passo de tempo e resolvendo novamente os campos de pressão ecom uma tolerância de 10saturação associados àquele mesmo nível temporal.
Neste trabalho optou-se por utilizar dois conjuntos de parâmetros especiﬁcados ao es-quema de passo de tempo adaptativo. O primeiro, e mais rígido, tem os valores de seusparâmetros listados na tabela 4.1; O segundo, e menos rígido, na tabela 4.2.
Tabela 4.1: Parâmetros correspondentes ao critérios mais rígido de passo de tempo adaptativo∆Smax ∆Smin αaum αred0,10,50,051,01Tabela 4.2: Parâmetros correspondentes ao critérios menos rígido de passo de tempo adaptativo∆Smax ∆Smin αaum αred0,20,50,051,172Figura 4.8: Fluxograma da estratégia de modiﬁcação do passo de tempoFonte: do autor734.4 ESPECIFICAÇÃO DAS TOLERÂNCIASO método totalmente implícito requer a especiﬁcação de duas tolerâncias. A primeiracorresponde ao sistema linear composto pela matriz jacobiana e pelo vetor de resíduos.
Tendo em vista que o termo independente é o resíduo, optou-se por utilizar a tolerânciaabsoluta da biblioteca PETSc para esse caso a ﬁm de que não fosse especiﬁcado um critérioexcessivamente apertado. Assim, o critério de convergência do solver linear é(cid:107)R(cid:107) < ,(4.33)
em que R é o vetor resíduo e  é a tolerância especiﬁcada. O valor de  atribuído para−5. Outra tolerância que necessitaresolver os problemas apresentados neste trabalho foi 10ser especiﬁcada no método totalmente implícito corresponde ao sistema não linear. Nessecaso, optou-se por utilizar a norma da mudança da solução ao longo dos passos de tempo(cid:107)∆X(cid:107)(cid:107)X(cid:107) < ,(4.34)
em que X é a solução e ∆X é a diferença entre a solução atual em relação à iteração anterior−8do solver não linear. Para resolver os problemas desta trabalho, especiﬁcou-se valor 10para essa tolerância.
Quanto ao método IMPES, a única tolerância a ser especiﬁcada diz respeito ao sistemalinear de cálculo da pressão. Atribuiu-se, nesse caso, o mesmo critério do solver não li-near do método totalmente implícito. Ao método sequencial também atribuiu-se o mesmocriério de convergência. Neste último, contudo, após resolver o sistema linear da pressão,segue-se a atualização das mobilidades e nova resolução do sistema linear até que a solu-ção mude menos que uma tolerância. Para isso, utilizou-se como critério a razão entre anorma inﬁnita do campo de pressão atual e a norma inﬁnita do campo de pressão obtidono passo na iteração anterior, i.e., utlizou-se a expressão(cid:107)Patual− Panterior(cid:107)∞(cid:107)Panterior(cid:107)∞< ,(4.35)
−6. Também optou-se por determinarem que a tolerância  foi especiﬁcada com o valor 1050 como o número máximo de iterações em um mesmo passo de tempo. Esse limite sepresta a impedir que o programa continue sendo executado indeﬁnidamente nos casos dedivergência. Conforme explicado na seção anterior, caso isso ocorra a solução correspon-dente a esse mesmo nível de tempo é recalculada com um passo de tempo inferior.
745RESULTADOSNeste capítulo, serão apresentados os resultados provenientes da simulação numéricado modelo descrito. Primeiramente, será apresentada a validação do simulador implemen-tado lançando-se mão de um caso de deslocamento unidimensional em que há soluçãoanalítica disponível – o caso de Buckley-Leverett. A seguir, serão expostos os resultados ob-tidos para a simulação do deslocamento bidimensional em um reservatório que apresentaa conﬁguração conhecida como quarter ﬁve-spot. Por ﬁm, serão apresentados os resulta-dos provenientes da simulação do deslocamento tridimensional em uma malha híbrida.
5.1 DESLOCAMENTO UNIDIMENSIONAL5.1.1 DESCRIÇÃO DO PROBLEMAConsidera-se uma amostra de rocha homogênea inicialmente embebida em óleo naqual injeta-se água a uma vazão constante através de uma de suas fronteiras, conformeilustrado na ﬁgura 5.1. Se a vazão de água for suﬁcientemente alta, a inﬂuência da pressãocapilar diminui de tal forma que o problema pode ser modelado como um processo dedeslocamento unidimensional do tipo que permite uma solução analítica (Hurtado, 2005).
Figura 5.1: Conﬁguração do problema de deslocamento unidimensionalFonte: modiﬁcado de (Maliska et al., 2015)A equação que modela o escoamento na direção do eixo x é dada por (Maliska et al.,
752015):∂ Ff∂ x∂ S∂ t+ v T= 0,φ(5.1)
em que Ff é o ﬂuxo fracionário deﬁnido pork wrµw+ k orµoFf =.
(5.2)
k wrµwÉ possível mostrar que a solução analítica para essa problema depende do ﬂuxo fracio-nário, o qual, por sua vez, é determinado pelas curvas de permeabilidade relativa e pelarelação entre as viscosidades (Maliska et al., 2015).
Para os exemplos apresentados nesta seção foram empregadas as curvas de permea-= ˆS2 ,=1− ˆS2.
 S w − S w− S wblidade descritas dadas pelo modelo de Corey – descrito no capítulo 2 – com coeﬁcienteunitário e expoente 2, isto é,k wr(5.3)
k or(5.4)
A saturação ˆS normalizada é calculada porˆS =mi n,(5.5)
S wma xmi nem que as saturações mínimas e máximas de água foram tomadas como 0 e 1, respectiva-mente. Já a relação entre as viscosidades é dada, neste problema, porµoµw= 4.
(5.6)
À porosidade foi atribuído o valor unitário. As curvas de permeabilidade relativa e ﬂuxofracionário podem ser visualizadas na ﬁgura 5.2.
Outro parâmetro presente na equação (5.1) é a velocidade total v T , que consiste nasoma das velocidades das duas fases na direção x . Pois que nesse caso a equação de con-∇·vT = 0,servação é simpliﬁcada para(5.7)
e a velocidade prescrita na fronteira x = 0 é constante, pode-se aﬁrmar que essa velocidadeé constante ao longo do domínio (Hurtado, 2005).
76Figura 5.2: Curvas de permeabilidade e ﬂuxo fracionário(a) Curvas de permeabilidade relativa(b) Fluxo fracionário em função da saturaçãoFonte: do autor5.1.2 SOLUÇÃO ANALÍTICAA ﬁm de obter a solução analítica, as variáveis do problema são adimensionalizadas. As
versões adimensionais da coordenada axial do domínio e do tempo são, respectivementeτ = v T tφLX = xLe.
(5.8)
Dado isso, a equação (5.1) pode ser escrita na forma∂ Ff∂ X∂ S∂ τ+= 0.
(5.9)
Deﬁnindo, ainda, o parâmetroξ = Xτ ,(5.10)
− ξdFa equação (5.9) se torna uma equação diferencial ordinária:dSdξ= 0(5.11)
dS ξ = FA solução analítica dessa equação é (Dullien, 1979):se 0≤ ξ≤ D ,se D ≤ ξ≤∞,(Sf ) = Ff (Sf )− Ff (Si )(cid:48)(S)fS = Siem que(cid:48)Sf − SiD = Ff,(5.12)
77Si é a saturação inicial do domínio e Sf , a saturação da frente de água. Essa solução analíticaé conhecida como solução de Buckley-Leverett.
5.1.3 RESULTADOS OBTIDOSA ﬁm de comparar resultados numéricos à solução analítica, especiﬁcou-se como con-dição inicialS(x ,0) = 0, para 0≤ x ≤ L,P (x ,0) = 0, para 0≤ x ≤ L,(5.13)
(5.14)
i.e., o domínio está, inicialmente, embebido com óleo. A condição de contorno para afronteira x = 0 é de Neumann. A velocidade de água foi prescrita com valor unitário; doóleo, nulo. Já para a fronteira x = L prescreveu-se os mesmos valores de pressão e satu-ração iniciais. Devido ao caráter hiperbólico da equação e sabendo-se que o ﬂuido estádeixando essa fronteira, nenhuma condição de saturação precisaria ser prescrita (Maliskaet al., 2015). Por motivos computacionais, foi prescrito o mesmo valor das condições inici-ais e faz-se uma veriﬁcação para identiﬁcar se a frente de água ainda não chegou a x = L.
Não obstante se trate de um problema unidimensional, utilizou-se um domínio bidi-mensional e exportou-se as soluções de todos os nós da malha. Os quatro perﬁs mostradosnos resultados são correspondentes aos instantes de tempo 0,2, 0,3, 0,4 e 0,5 VPI – equiva-lentes a 0,8, 1,2, 1,6 e 2,0 segundos. O VPI pode ser interpretado como um tempo adimen-(cid:82) t(cid:82)sional em um problema de deslocamento é o volume poroso injetado e é dado por(Ql )entdtφdVVPI = Volume de ﬂuido injetadovolume poroso disponível=0,(5.15)
Vem que (Ql )ent é a vazão injetada no meio poroso.
As soluções analíticas correspondentes a esses tempos foram comparadas às soluçõesnuméricas advindas dos métodos IMplicit pressure, Explicit Saturation, sequencial e to-talmente implícito, identiﬁcados nos gráﬁcos, respectivamente, pelas siglas FIM, IMPESe SEQ. Os resultados numéricos foram obtidos empregando três malhas com diferentesgraus de reﬁno, todas compostas por elementos triangulares. A mais grosseira possui 430nós; a mediana, 1961; a mais reﬁnada, 7392. Essas malhas podem ser visualizadas na ﬁ-gura 5.3. Os resultados numéricos apresentados a seguir foram obtidos considerando-se−3 segundos.
um passo de tempo inicial de 1078Figura 5.3: Malhas não-estruturadas utilizadas na solução do problema de Buckley-LeverettFonte: do autorOs resultados obtidos com passo de tempo ﬁxo estão dispostos nas ﬁguras 5.4, 5.5 e
5.6 para malhas de 430, 1961 e 7392 nós, respectivamente. O tempo computacional des-pendido para 0,5 VPI por meio dos três métodos pode ser visualizado na ﬁgura 5.7. Nesses−3s.
casos, o passo de tempo foi mantido em seu valor inicial de 10Já os resultados obtidos para o critério mais rígido de passo de tempo estão dispostosnas ﬁguras 5.8, 5.9 e 5.10 para malhas de 430, 1961 e 7392 nós, respectivamente. O tempocomputacional despendido para 0,5 VPI por meio dos três métodos pode ser visualizadona ﬁgura 5.11. A evolução dos passos de tempo estão dispostas nas ﬁguras 5.12, 5.13 e 5.14.
Por ﬁm, os resultados obtidos para o critério menos rígido de passo de tempo estão dis-postos nas ﬁguras 5.15, 5.16 e 5.17 para malhas de 430, 1961 e 7392 nós, respectivamente.
O tempo computacional despendido para 0,5 VPI por meio dos três métodos pode ser vi-sualizado na ﬁgura 5.18. A evolução dos passos de tempo estão dispostas nas ﬁguras 5.19,
5.20 e 5.21.
Ainda, os campos de saturação e pressão obtidos por meio do método totalmente im-plícito com o critério mais rígido de passo de tempo adaptativo e na malha mais reﬁnadaestão ilustrados na ﬁgura 5.22 para 0,2, 0,3, 0,4 e 0,5 VPI. Os resultados são associados àscurvas correspondentes ao método FIM na ﬁgura 5.10.
79Figura 5.4: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malhade 430 nósFonte: do autorFigura 5.5: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malhade 1961 nósFonte: do autor80Figura 5.6: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malhade 7392 nósFonte: do autorFigura 5.7: Tempo computacional para os três métodos com passo de tempo ﬁxoFonte: do autor81Figura 5.8: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempoadaptativo em uma malha de 430 nósFonte: do autorFigura 5.9: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempoadaptativo em uma malha de 1961 nósFonte: do autor82Figura 5.10: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempoadaptativo em uma malha de 7392 nósFonte: do autorFigura 5.11: Tempo computacional para os três métodos com critério mais rígido de passo de tempoadaptativoFonte: do autor83Figura 5.12: Evolução do passo de tempo para a malha de 430 nós com critério mais rígido de passode tempo adaptativoFonte: do autorFigura 5.13: Evolução do passo de tempo para a malha de 1961 nós com critério mais rígido de passode tempo adaptativoFonte: do autor84Figura 5.14: Evolução do passo de tempo para a malha de 7392 nós com critério mais rígido de passode tempo adaptativoFonte: do autorFigura 5.15: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo detempo adaptativo em uma malha de 430 nósFonte: do autor85Figura 5.16: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo detempo adaptativo em uma malha de 1961 nósFonte: do autorFigura 5.17: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo detempo adaptativo em uma malha de 7392 nósFonte: do autor86Figura 5.18: Tempo computacional para os três métodos com critério menos rígido de passo detempo adaptativoFonte: do autorFigura 5.19: Evolução do passo de tempo para a malha de 430 nós com critério menos rígido depasso de tempo adaptativoFonte: do autor87Figura 5.20: Evolução do passo de tempo para a malha de 1961 nós com critério menos rígido depasso de tempo adaptativoFonte: do autorFigura 5.21: Evolução do passo de tempo para a malha de 7392 nós com critério menos rígido depasso de tempo adaptativoFonte: do autor88Figura 5.22: Campos de saturação e pressão para os instantes de tempo 0,2, 0,3 0,4 e 0,5 VPIFonte: do autorPara todos os critérios de passo de tempo adaptativo, as soluções numéricas apresen-tam o comportamento esperado, i.e., os perﬁs numéricos de saturação se aproximam aoperﬁl correspondente à solução analítica à medida que a malha é reﬁnada. Entretanto, atémesmo na malha mais reﬁnada há considerável presença de difusão numérica, a qual é res-ponsável pela suavização da discontinuidade dos perﬁs. Hurtado (2005) aﬁrma que esseé o preço que deve ser pago pela garantia de soluções ﬁsicamente coerentes e que, nestecaso, a difusão numérica advém da interpolação de primeira ordem utilizada nos termosadvectivos.
Quanto à evolução do passo de tempo, infere-se que o esquema de passo de tempoadaptativo pode ser responsável por considerável redução do tempo computacional, poisque permite-se um acréscimo de seu valor até que isso não afete a obtenção de uma soluçãoestável. Além disso, conforme esperado, o passo de tempo deve ser reduzido à medida quea malha é reﬁnada, conforme expõem as ﬁguras 5.12, 5.13, 5.14, 5.19, 5.20 e 5.21.
89Entretanto, observa-se que a utilização de um esquema de passo de tempo adaptativopode inﬂuenciar na qualidade da solução numérica obtida. Quando esse esquema não éaplicado as soluções determinadas pelos três métodos praticamente coincidem – 5.4, 5.5 e
5.6. A solução obtida por meio do método totalmente implícito não é afetada signiﬁcativa-mente quando os criérios mais e menos rígido de passo de tempo adaptativo são emprega-dos. O método sequencial, contudo, apresenta alguns pontos distantes da curva quandoo critério menos rígido de passo de tempo adaptativo é empregado – 5.15, e 5.17. Já o mé-todo IMPES apresenta uma solução mais próxima da analítica quando o critério de passode tempo adaptativo é aplicado. Isso se deve, possivelmente, a uma condição mais próximadaquela na qual essse método fornece a solução analítica para o caso de Buckley-Leverett.
Essa condição é apresentada no apêndice A para o caso de uma malha unidimensional.
Também é explicado que o método FIM, não obstante a estabilidade incondicional, apre-senta difusão numérica para quaisquer combinações de malha e parâmetros do problema.
Os resultados obtidos neste trabalho sugerem que esse comportamento se mantém no casode uma malha não estruturada bidimensional. Nesse caso, entretanto, as condições quepermitem ao IMPES apresentar a solução analítica não podem ser obtidas de forma direta.
Mesmo se essas condições pudessem ser determinadas, ter-se-ia de especiﬁcar um passode tempo ﬁxo, logo não seria possível satisfazê-la com o esquema de passo adaptativo.
Quanto ao tempo computacional despendido em cada simulação, infere-se que o passode tempo adaptativo é interessante sobretudo ao método totalmente implícito, o qual per-mite uma redução do custo computacional sem que a solução seja signiﬁcativamente al-terada. O método sequencial, muito embora tenha fornecido soluções mais rapidamenteque o FIM para alguns casos, apresentou certa sensibilidade em relação ao uso de um passode tempo adaptativo, de forma que deve-se ter cautela a aplicar essa condição para tal mé-todo. Já o método IMPES clássico se comportou bem quanto à utilização do passo de tempoadaptativo. Contudo, conforme já explicado, isso pode ser devido a um caráter particulardo problema unidimensional de Buckley-Leverett.
905.2 DESLOCAMENTO BIDIMENSIONAL EM CONFIGURAÇÃO QUAR-TER FIVE-SPOT5.2.1 DESCRIÇÃO DO PROBLEMAConsidera-se uma amostra de rocha quadrada, homogênea, inicialmente embebidaem óleo e na qual injeta-se água a uma vazão constante através de um poço injetor e produz-se óleo a partir de um poço produtor que opera com pressão constante, conforme ilustradona ﬁgura 5.23.
Figura 5.23: Conﬁguração do problema de deslocamento bidimensionalFonte: modiﬁcado de (Maliska et al., 2015)A conﬁguração desse problema é conhecida como quarter ﬁve-spot, pois que repre-senta um quarto de um domínio quadrado em que há quatro poços produtores nos vérti-ces e um poço injetor no centro (Aziz & Settari, 1979). Os dados de entrada utilizados noproblema estão listados na tabela 5.1. A injeção de água ao longo do tempo especiﬁcadocorresponde a cerca de 48% do volume poroso injetado. O modelo de permeabilidade re-= ˆS2 ,=1− ˆS2.
lativa considerado foi o modelo de Corey com coeﬁciente unitário e expoente quadrático,ou seja,k wr(5.16)
k or(5.17)
As saturações mínima e máxima de água e óleo foram especiﬁcadas como 0 e 1, respecti-vamente e o campo de pressão inicial é nulo.
91Tabela 5.1: Dados do problema de deslocamento bifásico bidimensionalAtributoValor90000 m2−3 Pa.s
10−2 Pa.s
10−11 m2100,2−5 m3/s5000Área do reservatórioViscosidade da águaViscosidade do óleoPermeabilidade absolutaPorosidadeVazão de água injetadaDias de simulação2.10
Fonte: do autor5.2.2 RESULTADOS OBTIDOSA seguir serão apresentados alguns resultados obtidos para o problema descrito. Os re-sultados numéricos advindos de cada método – IMPES, totalmente implícito e sequencial– serão apresentados e comparados entre si. Foram empregadas três malhas computacio-nais com diferentes graus de reﬁno – 425, 1483 e 5985 nós – compostas apenas de elemen-tos triangulares. Essas malhas podem ser visualizadas na ﬁgura 5.24. Os valores de índice−11 m3 para as−11 m3 e 6,18471.10
−11 m3, 3,25968.10
de poço utilizados foram 2,85208.10
malhas de 425, 1483 e 5985 nós, respectivamente.
Figura 5.24: Malhas não-estruturadas utilizadas na solução do problema quarter ﬁve-spotFonte: do autorOs critérios de convergência e as tolerâncias utilizadas foram idênticos àqueles espe-ciﬁcados no caso de deslocamento unidimensional. Neste caso utilizou-se apenas o es-quema mais rídido de passo de tempo, o qual tem seus parâmetros listados na tabela 4.1.
92Os resultados obtidos para a malha mais grossa – de 425 nós – sem e com a utilizaçãodo passo de tempo adaptativo podem ser visualizados, respectivamente, nas ﬁguras 5.25 e5.26. No caso de passo de tempo ﬁxo, seu valor foi mantido constante e igual a 1 dia. No
caso em que é utilizado o esquema de passo de tempo adaptativo, esse valor correspondeao passo de tempo inicial. As primeiras curvas expostas são a pressão média ao longo dotempo e a taxa de produção de óleo. A terceira curva corresponde ao corte de água – razãoentre a vazão de água e a vazão total no poço. A quarta curva correlaciona o volume po-roso injetado à eﬁciência de varrido horizontal – razão entre o volume de óleo produzido eo volume injetável. Quando se dispõem de curvas de eﬁciência de varrido horizontal, parase obterem os valores reais para um determinado reservatório basta multiplicar os valoresadimensionais que podem ser lidos na ﬁgura pelo volume deslocável do meio poroso emestudo (Rosa et al., 2006). Em decorrência de sua deﬁnição, essa curva é idêntica à de satu-ração média no domínio. Por ﬁm, a última curva apresenta a evolução do passo de tempoda simulação. Os tempos computacionais despendidos sem e com a utilização do passode tempo adaptativo estão listados, respectivamente, nas tabelas 5.2 e 5.3.
Os mesmos resultados também foram obtidos para uma malha de 1483 nós e estão dis-postos, sem e com a utilização do passo de tempo adaptativo, respectivamente, nas ﬁguras5.27 e 5.28. Para esse caso, o passo de tempo inicial especiﬁcado foi de 0,5 dia quandoutilizado o esquema de passo de tempo adaptativo. Quando não utilizado, seu valor foimantido em 0,5 dia. Os tempos computacionais despendidos sem e com a utilização dopasso de tempo adaptativo estão listados, respectivamente, nas tabelas 5.4 e 5.5.
Por ﬁm, também foram calculados os mesmos resultados para a malha mais reﬁnada– de 5985 nós. Esses resultados estão dispostos, sem e com a utilização do passo de tempoadaptativo, respectivamente, nas ﬁguras 5.29 e 5.30. Para essa conﬁguração, o passo detempo foi mantido em 0,05 dia quando não utilizada a estratégia de passo de tempo adap-tativo. Quando utilizada, esse foi o valor especiﬁcado como passo de tempo inicial. Os
tempos computacionais despendidos sem e com a utilização do passo de tempo adapta-tivo estão listados, respectivamente, nas tabelas 5.6 e 5.7.
Ademais, os campos de saturação e pressão no instante de breakthrough estão ilustra-dos na ﬁgura 5.31. A partir desse instante, o poço produtor passa a produzir não apenasóleo, mas também água (Rosa et al., 2006). Já a ﬁgura 5.32 exibe os campos de saturaçãoobtidos pelo método totalmente implícito, com passo de tempo ﬁxo e com a malha maisreﬁnada para os instantes de tempo de 500, 1500, 3000 e 5000 dias.
93Figura 5.25: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e umamalha de 425 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.2: Tempo computacional – passo de tempo ﬁxo e malha de 425 nósFIMIMPES46,7706 sSEQ481,315 s206,893 sFonte: do autor94Figura 5.26: Resultados obtidos para o deslocamento bidimensional com passo de tempo adapta-tivo e uma malha de 425 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.3: Tempo computacional – passo de tempo adaptativo e malha de 425 nósFIMIMPES13,8850 sSEQ49,8253 s57,2920 sFonte: do autor95Figura 5.27: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e umamalha de 1483 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.4: Tempo computacional – passo de tempo ﬁxo e malha de 1483 nósFIMIMPES453,339 sSEQ4259,28 s822,232 sFonte: do autor96Figura 5.28: Resultados obtidos para o deslocamento bidimensional com passo de tempo adapta-tivo e uma malha de 1483 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.5: Tempo computacional – passo de tempo adaptativo e malha de 1483 nósFIMIMPES108,822 sSEQ219,840 s306,970 sFonte: do autor97Figura 5.29: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e umamalha de 5985 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.6: Tempo computacional – passo de tempo ﬁxo e malha de 5985 nósFIMIMPESSEQ115135 s13.097,2 s28.003,0 sFonte: do autor98Figura 5.30: Resultados obtidos para o deslocamento bidimensional com passo de tempo adapta-tivo e uma malha de 5985 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.7: Tempo computacional – passo de tempo adaptativo e malha de 5985 nósFIMIMPESSEQ1.315,89 s1.048,18 s4.625,63 sFonte: do autor99Figura 5.31: Campos de pressão e saturação no instante de breakthroughFonte: do autorFigura 5.32: Campos de saturação para os instantes de tempo de 500, 1500, 3000 e 5000 diasFonte: do autor100Observa-se que a curva de eﬁciência de varrido horizontal apresenta dois trechos dis-tintos – uma reta correspondente à função identidade e uma curva tendendo a se tornarhorizontal. O tempo associado à transição entre esses dois trechos é o instante de breakth-rough (BT).
Quanto à curva de pressão, veriﬁca-se que seu valor máximo não ocorre quando a ro-cha está saturada de óleo. Tem-se uma curva de pressão média crescente até atingir seuvalor máximo e, a partir de então, a curva passa a ser decrescente. Esse comportamentodecorre da utilização de um modelo de permeabilidade relativa quadrático, pois que comesse modelo o mínimo valor de mobilidade total ocorre quando a saturação de óleo é me-nor que a unidade.
Pode-se inferir dos resultados que o métodos IMPES apresenta instabilidades na solu-ção numérica correspondente após o breakthrough. Essas instabilidades ocorrem porqueesse esquema não itera na não linearidade existente entre pressão e saturação, de modoque o valor da saturação utilizada para calcular a vazão de ﬂuido produzida é o do tempoanterior. Isso pode levar a inconsistências físicas no instante de tempo em que se passa aproduzir água. Nesse instante, os volumes de controle ao redor do poço produtor apresen-tam saturação de água relativamente elevada, levando a uma vazão de água entrando novolume de controle do poço também relativamente alta. Porém, a vazão de água produzidano poço ainda é baixa, pois a saturação de água nesse volume é a do instante anterior, queé pequena. Ou seja, a diferença entre as vazões entrando e saindo do volume de controleé alta. Caso passos de tempo grandes sejam utilizados, a variação da saturação será tam-bém relativamente alta (e possivelmente não física). No próximo passo de tempo ter-se-ia,pois, mobilidade da água com valor elevado, levando a uma produção de água excessiva,que leva a uma redução demasiada da saturação. Desse modo, a saturação de água novolume de controle do poço ﬁca instável, alternando entre valores altos e baixos. Essasinstabilidades podem ser reduzidas substancialmente modiﬁcando o IMPES clássico parao método sequencial. Contudo, isso se dá às custas da necessidade um maior tempo decomputação.
Já o método totalmente implícito apresenta soluções estáveis não obstante a utilizaçãodo esquema de passo de tempo adaptativo. Ademais, essa estratégia permitiu uma reduçãosigniﬁcativa do custo computacional correspondente ao método FIM, que com passo detempo ﬁxo era o que mais demandava tempo computacional e com passo de tempo adap-tativo ﬁcou menos custoso que o método sequencial. Ressalta-se que embora o IMPEStenha sido o método menos custoso em todos os casos, sua solução só apresentou estabi-101lidade em casos de passo de tempo ﬁxo. Além disso, o custo computacional de utilizar ométodo totalmente implícito com passo de tempo adaptativo ﬁcou da mesma ordem docusto correspondente à utilização da formulação IMPES sem o passo de tempo adaptativoe ambos os métodos apresentaram soluções estáveis e consistentes. Portanto, foi possíveltirar proveito da robustez do FIM no intuito de utilizar passos de tempo mais elevados epor conseguinte reduzir o tempo despendido na simulação numérica. Os tempos compu-tacionais despendidos estão sumarizados por meio de gráﬁcos na ﬁgura 5.33.
Figura 5.33: Tempos computacionais despendidos no caso de deslocamento bidimensional(a) Malha de 425 nós(b) Malha de 1483 nós(c) Malha de 5985 nósFonte: do autorAlmejando analisar mais pormenorizadamente a inﬂuência do esquema de passo detempo adaptativo na solução numérica obtida por meio do método totalmente implícito,foram comparados os resultados advindos de três tratamentos distintos do passo de tempo– passo de tempo ﬁxo, critério mais rígido e critério menos rígido. Os parâmetros associ-ados a esses critérios já foram explicados e podem ser encontrados nas tabelas 4.1 e 4.2.
Para realizar essa comparação, optou-se por utilizar a malha mais grossa, a qual possui425 nós. Os resultados obtidos estão expostos na ﬁgura 5.34. Os tempos computacionaisdespendidos na obtenção de tais soluções estão listados na tabela 5.8.
102Figura 5.34: Resultados obtidos para o deslocamento bidimensional com o método totalmente im-plícito(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.8: Tempo computacional despendido com o método FIMFixoMais rígido Menos rígido481,315 s49,825 s10,6337 sFonte: do autor103Pode-se inferir dos resultados obtidos que o emprego do passo de tempo adaptativoreduziu o tempo computacional em uma ordem. Além disso, do critério mais rígido para omenos rígido veriﬁcou-se uma redução de cinco vezes nesse tempo despendido. Não obs-tante essa redução esteja inevitavelmente em conjunto com uma maior difusão numéricae por conseguinte menor capacidade de capturar gradientes elevados, todas as soluçõesapresentadas são ﬁsicamente consistentes. Logo, é evidente que a escolha do esquema depasso de tempo adaptativo a ser utilizado está fortemente relacionado com a precisão coma qual se deseja solucionar o problema.
1045.3 DESLOCAMENTO TRIDIMENSIONAL EM MALHA HÍBRIDA5.3.1 DESCRIÇÃO DO PROBLEMAO problema de deslocamento bifásico tridimensional será simulado em uma malhanão-estruturada híbrida com o formato aproximado do território brasileiro. Trata-se deum processo de recuperação secundária de óleo em um reservatório tridimensional noqual há três poços injetores e dois produtores, conforme esquematizado na ﬁgura 5.35.
Figura 5.35: Conﬁguração do problema tridimensionalFonte: do autorOs três poços injetores são verticais e atravessam integralmente a espessura do reser-vatório. Os dois poços produtores, por sua vez, são direcionais. Em torno de cada um dospoços a malha tem formato cilíndrico acompanhando a trajetória da linha que representao poço, conforme ilustrado na ﬁgura 5.36. Todas as fronteiras do reservatório são imper-meáveis. Tanto as informações relacionadas à malha quanto os dados de entrada estãolistados na tabela 5.9.
O modelo de permeabilidade relativa é o mesmo que aquele utilizado nos casos an-teriores, i.e., modelo de Corey com expoente quadrático e coeﬁciente unitário. Ainda, oproblema foi resolvido em termos de potenciais. A ﬁm de obter o campo de pressão poder-105Figura 5.36: Ilustração da malha cilíndrica ao redor dos poçosFonte: modiﬁcado de Maliska et al. (2012)Tabela 5.9: Dados do problema de deslocamento bifásico tridimensionalAtributoValor200 m200 m130 mComprimento máximo do reservatórioLargura máxima do reservatórioEspessura máxima do reservatórioVolume do reservatórioNúmero de nósNúmero de tetraetrosNúmero de hexaedrosNúmero de prismasNúmero de pirâmidesNúmero de poços injetoresNúmero de poços produtoresViscosidade da águaViscosidade do óleoPermeabilidade absolutaPorosidadeVazão de água injetada pelo poço injetor 1Vazão de água injetada pelo poço injetor 2Vazão de água injetada pelo poço injetor 3Dias de simulação1,02249.106 m380733528654454457632−3 Pa.s
10−2 Pa.s
10−14 m2100,1−4 m3/s−5 m3/s−5 m3/s30001,1.10
9.10
8.10
se-ia fazer um pós processamento a partir dos dados de densidades das fases e aceleraçãodevida à gravidade. As saturações mínima e máxima de água e óleo foram especiﬁcadascomo 0 e 1, respectivamente e os campos inciais de pressão e saturação são nulos. Os cri-térios de convergência e as tolerâncias especiﬁcadas para este problema também foramiguais àqueles utilizados nos problemas anteriores. Já os valores de índice de poço utiliza-−13 m3 e 3,92357.10
−13 m3.
dos para os poços 1 e 2 foram, respectivamente, 3,05816.10
1065.3.2 RESULTADOS OBTIDOSA seguir, os resultados numéricos advindos de cada método – IMPES, totalmente implí-cito e sequencial – serão apresentados e comparados entre si. Uma vez que foi observado,a partir dos resultados obtidos para o deslocamento bidimensional, que o método IMPESé signiﬁcativamente sensível ao esquema de passo de tempo adaptativo implementado,optou-se por utilizar passo de tempo ﬁxo quando este método for empregado. Quantoao método sequencial, veriﬁcou-se que sua limitação quanto ao passo de tempo utilizadoapós o instante de breakthrough é severa a ponto de ser mais vantajoso especiﬁcar passode tempo ﬁxo. Sendo assim, apenas para o método FIM foi empregado o esquema de passode tempo variável mais rígido, cujos parâmetros estão listados na tabela 4.1.
Os resultados obtidos para 3000 dias de simulação podem ser visualizados na ﬁgura5.37. As primeiras curvas expostas são a pressão e saturação média ao longo do tempo. As
terceira e quarta curvas correspondem à produção de óleo e ao corte de água, respectiva-mente. A quinta curva correlaciona o volume injetado adimensional injetado à eﬁciênciade varrido horizontal. Já a última curva apresenta a evolução do passo de tempo da simu-lação. Por ﬁm, os tempos computacionais despendidos estão listados na tabela 5.10.
Quanto à solução numérica, infere-se que os três métodos apresentam soluções coe-rentes e quase coincidentes. O método FIM, contudo, apresenta expressiva vantagem emrelação ao tempo computacional necessário à simulação do problema, tendo em vista quedespendeu apenas 7,69% do tempo computacional gasto pelo método IMPES e 2,96%, dosequencial. É interessante veriﬁcar que em nenhum momento foi necessária uma reduçãodo passo de tempo adaptativo quando se empregou a formulação totalmente implícita.
A ﬁm de explorar ainda mais as potencialidades do método totalmente implícito, foramobtidos resultados para 10000 dias de simulação apenas com esse método, os quais podemser visualizados na ﬁgura 5.38. As ﬁguras ﬁgura 5.39 e ﬁgura 5.40 ilustram, respectivamente,os campos de saturação e pressão para seis instantes de tempo – 496, 997, 3010 e 5000, 7013e 10000 dias. Em ambas as ﬁguras foi realizado um corte na malha a ﬁm de prover uma me-lhor visualização da região próxima aos poços injetores. Os campos ﬁnais de saturação epressão – para 10000 dias – podem ser visualizados na ﬁgura 5.41. O tempo computaci-onal despendido nesse caso foi de 18909,8 segundos, apenas cerca de 12% a mais que otempo necessário para simular 3000 dias. Percebe-se, assim, que lançando-se mão de umesquema de passo de tempo adaptativo foi possível utilizar-se da robustez da formulaçãototalmente implícita a ﬁm de prover uma simulação menos custosa.
107Figura 5.37: Resultados obtidos para o deslocamento tridimensional em malha híbrida com os trêsmétodos para 3000 dias de simulação(a) Curva de pressão média(b) Curva de produção de óleo acumulada(d) Curva de eﬁciência de varrido horizontal(c) Curva de corte de água(e) Curva de passo de tempoFonte: do autorTabela 5.10: Tempo computacional despendidoFIMIMPES219.877 sSEQ16.914,3 s571.286 sFonte: do autor108Figura 5.38: Resultados obtidos para o deslocamento tridimensional em malha híbrida com o mé-todo totalmente implícito para 10000 dias de simulação(a) Curva de pressão média(b) Curva de produção de óleo acumulada(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autor109Figura 5.39: Campo de saturação para quatro instantes de tempoFonte: do autorFigura 5.40: Campo de pressão para quatro instantes de tempoFonte: do autor110Figura 5.41: Campos ﬁnais de pressão e saturaçãoFonte: do autor1116CONCLUSÃO6.1 SUMÁRIONeste trabalho foram expostos o estudo e a implementação de um simulador bifásico,imiscível, isotérmico e incompressível destinado à simulação numérica do deslocamentode ﬂuidos em reservatórios de petróleo. Foram apresentadas e comparadas três formu-lações distintas – método totalmente implícito, IMPES clássico e sequencial – em termosde estabilidade, acuracidade e tempo computacional. Utilizou-se o método dos volumesﬁnitos baseado em elementos, o qual proporciona uma maior ﬂexibilidade para a repre-sentação geométrica de reservatórios. Ainda, foi implementado um esquema de passo detempo adaptativo a ﬁm de veriﬁcar tanto a sensibilidade de cada método em relação a esseesquema quanto a capacidade de reduzir os tempos computacionais despendidos nas si-mulações.
Os métodos IMPES clássico e sequencial foram adaptados a partir do código desen-volvido em (Grein, 2015) e disponibilizado na EFVLib. Nessas formulações, a pressão éresolvida de forma implícita; a saturação, explícita. A diferença entre ambos é que o mé-todo sequencial atualiza os coeﬁcientes do sistema linear da pressão e resolve novamenteos campos de pressão e saturação até que a alteração de seus valores seja inferior a umatolerância especiﬁcada.
O método totalmente implícito ou FIM (Fully implicit method) foi implementado in-tegralmente. Nessa formulação, as variáveis são resolvidas simultaneamente. Para isso,fez-se necessária a integração de um método capaz de resolver um sistema não-linear deequações à EFVLib. A implementação desse solver não-linear na EFVLib consistiu em umadas grandes contribuições deste trabalho. Foi adotado o método de Newton-Raphson, oqual foi implementado com o suporte da biblioteca PETSc (Balay et al., 2013). A utilizaçãodo método disponível na biblioteca, contudo não foi direta. Foram construidos e infor-mados, manualmente, o vetor resíduo e a matriz jacobiana. O algoritmo de montagemda matriz jacobiana consiste na parte mais custosa e complexa do código computacional.
Além disso, o procedimento realizado para calcular corretamente as derivadas numéricasque compõem essa matriz demandou um estudo especial em se tratando do método dosvolumes ﬁnitos baseado em elementos, o qual se fundamenta em varreduras de elementosda malha computacional.
112As três metodologias abordadas foram analisadas por meio de três exemplos de apli-cação. O primeiro foi destinado à validação do simulador. Trata-se de um caso de desloca-mento unidimensional em uma amostra de rocha no qual é possível calcular uma soluçãoanalítica – a solução de Buckley-Leverett. O segundo exemplo de aplicação foi o desloca-mento bidimensional em conﬁguração ﬁve-spot, a qual é amplamente empregada em es-tudos relacionados à simulação numérica de reservatórios de petróleo. Já o ultimo casoanalisado foi o deslocamento tridimensional em uma malha híbrida.
6.2 CONCLUSÕESO primeiro caso avaliado, de deslocamento unidimensional através de um meio po-roso, possibilitou a veriﬁcação das três metologias utilizadas. As soluções numéricas apre-sentaram o comportamento esperado quanto ao reﬁno de malha, i.e., os perﬁs numéricosde saturação se aproximaram do perﬁl correspondente à solução analítica à medida quea malha foi reﬁnada. Entretanto, até mesmo na malha mais reﬁnada há considerável pre-sença de difusão numérica, a qual é responsável pela suavização da discontinuidade dosperﬁs. Quanto à evolução do passo de tempo, inferiu-se que o esquema de passo de tempoadaptativo pode ser responsável por signiﬁcativa redução do tempo computacional. Alémdisso, conforme esperado, o passo de tempo deve ser reduzido à medida que a malha éreﬁnada. Veriﬁcou-se, também, que sua utilização pode inﬂuenciar demasiadamente aqualidade da solução numérica obtida. Quando esse esquema não foi adotado, as solu-ções determinadas por meio dos três métodos praticamente coincidiram. A solução ob-tida por meio do método totalmente implícito não foi afetada signiﬁcativamente quandoos critérios de passo de tempo adaptativo foram empregados. O método sequencial, con-tudo, apresentou sensibilidade ao critério menos rígido. Já o método IMPES apresentouuma solução mais próxima da analítica quando o critério de passo de tempo adaptativo foiaplicado. Isso se deve, possivelmente, a uma condição mais próxima daquela na qual es-sse método fornece a solução analítica para o caso de Buckley-Leverett. Quanto ao tempocomputacional despendido em cada simulação, infere-se que o passo de tempo adapta-tivo é interessante sobretudo ao método totalmente implícito, o qual é capaz de resolver oproblema mais rapidamente sob essa condição sem que a solução seja demasiadamentealterada. O método sequencial, muito embora tenha fornecido soluções mais rapidamenteque o FIM para alguns casos, apresentou certa sensibilidade em relação ao uso de um passode tempo adaptativo, de forma que deve-se ter cautela a aplicar essa condição para tal mé-113todo. Já o método IMPES clássico se comportou bem quanto à utilização do passo de tempoadaptativo. Contudo, isso pode ser devido a um caráter particular do problema unidimen-sional de Buckley-Leverett.
O segundo caso analisado, de deslocamento em conﬁguração quarter ﬁve-spot, foi uti-lizado a ﬁm de comparar os três métodos quanto ao desempenho e à sensibilidade em re-lação ao esquema de passo de tempo adaptativo em um problema bidimensional. Quandoempregado o esquema de passo de tempo adaptativo, o método IMPES apresentou insta-bilidades na solução numérica após o instante de breakthrough. Essa instabilidade podeser reduzida substancialmente modiﬁcando o IMPES clássico para o método sequencial.
Contudo, isso se dá às custas da necessidade um maior tempo de computação. O métodototalmente implícito, por sua vez, não apresentou tamanha sensibilidade em relação à esseesquema, provendo soluções consistentes tanto com passo de tempo ﬁxo, quanto variável.
Ainda, o tempo computacional despendido por esse método foi aproximadamente dez ve-zes inferior quando utilizou-se o critétio de passo de tempo adaptativo proposto. Alémdisso, a utlização dessa estratégia permitiu que o método FIM, que demandava o maiorcusto computacional com passo de tempo ﬁxo, chegasse a um custo menor que aqueledespendido pelo método sequencial quando foi utilizado o passo de tempo adaptativo.
Ressalta-se ainda que os tempos de simulação correspondentes ao método totalmente im-plícito com passo de tempo adaptativo ﬁcaram da mesma ordem daqueles corresponden-tes à utilização da formulação IMPES com passo de tempo ﬁxo e ambos os métodos apre-sentaram soluções estáveis e consistentes. Portanto, conseguiu-se tirar proveito da robus-tez do FIM no intuito de utilizar passos de tempo mais elevados e, assim, reduzir o tempodemandado pela simulação numérica.
O terceiro caso analisado, de deslocamento tridimensional em uma malha híbrida,possibilitou a veriﬁcação de que, no caso de um problema tridimensional, os métodos IM-PES e sequencial são severamente limitados quanto ao máximo passo de tempo que podeser utilizado, sobretudo em decorrência de um maior grau de reﬁno nas regiões próximasaos poços. À luz dos resultados previamente obtidos, optou-se, nesse caso, por especiﬁcarum passo de tempo ﬁxo aos métodos IMPES e sequencial a ﬁm de evitar instabilidades nassoluções numéricas e utilizar o esquema de passo de tempo adaptativo no caso do mé-todo totalmente implícito no intuito de reduzir o tempo computacional consumido poressa formulação. Os resultados obtidos praticamente coincidiram para os três métodos. O
FIM, contudo, foi capaz de prover as soluções com um custo computacional muito infe-rior em relação aos outros métodos – apenas 7,69% do tempo despendido pela formulaçãoIMPES e 2,96%, do método sequencial. Certamente, esses resultados podem servir a enco-114rajar futuros desenvolvimentos que utilizem o método totalmente implícito em conjuntocom o método dos volumes ﬁnitos baseado em elementos.
6.3 SUGESTÕES PARA TRABALHOS FUTUROSPara estudo subsequentes quanto ao tema abordado neste trabalho recomenda-se:• Estudar esquemas de passo de tempo adaptativo a ﬁm de reduzir a sensibilidade dosmétodos IMPES clássico e sequencial à sua utilização;• Paralelizar o simulador implementado a ﬁm de melhorar seu desempenho quantoao tempo computacional empregado nas simulações;• Introduzir um modelo físico mais complexo no simulador;• Incluir a equação da energia no modelo proposto;• Acoplar modelos de geomecânica ao modelo proposto;115REFERÊNCIASARCHER, J. S., WALL, C. G. Petroleum Engineering – Principles and Practice. Springer,1986.
AZIZ, K. Reservoir Simulation Grids: Opportunities and Problems. Jornal of PetroleumTechnology, v. 45, n. 7, pp. 658–663, Julho, 1993.
AZIZ, K., SETTARI, A. Petroleum Reservoir Simulation. Applied Science Publishers, 1979.
BALAY, S., BUSCHELMAN, K., GROPP, W. D., KAUSHIK, D., KNEPLEY, M. G., MCINNES,L. C., SMITH, B. F., ZHANG, H., 2009. PETSc Web page. http://www.mcs.anl.gov/petsc.
BALAY, S., BROWN, J., BUSCHELMAN, K., GROPP, W. D., KAUSHIK, D., KNEPLEY, M. G.,
MCINNES, L. C., SMITH, B. F., ZHANG, H. PETSc (Portable, Extensible Toolkit for Scien-tiﬁc Computation). http://www.mcs.anl.gov/petsc, 2013.
BALIGA, B. R., PATANKAR, S. V. A. A control-volume ﬁnite-element method for two-dimensional ﬂuid ﬂow and heat transfer. Numerical Heat Transfer, 1983.
BEJAN, A. Convection Heat Transfer, 3ª. John Wiley & Sons, Durham, North Carolina,2004.
BUCHWALTER, J. L., MILLER, C. A. Compositional and Black Oil Reservoir Simulation.
SPE Rocky Mountain Regional/Low Permeability reservoir symposium, Abril, 1993.
CAO, H., AZIZ, K. Performance of IMPSAT and IMPSAT-AIM models in compositionalsimulation. SPE Annual Technical conference and Exhibition, Setembro, 2002.
CHEN, Z. Reservoir Simulation – Mathematical Techniques in Oil Recovery. SIAM, 1962.
CHEN, Z., HUAN, G., MA, Y. Computational Methods for Multiphase Flows in Porous Me-dia. Computational Science and Engineering. Society for Industrial and Applied Mathe-matics (SIAM, 3600 Market Street, Floor 6, Philadelphia, PA 19104), 2006.
CHEN, Z. H., LI, B. An improved IMPES method for two-phase ﬂow in porous media.
Transport in Porous Media,, v. 54, pp. 361–376, 2004.
COATS, K. H. IMPES stability: selection of stable time steps. SPE Reservoir SimulationSymposium, Fevereiro, 1968.
116COATS, K. H. Reservoir simulation: State of art. SPE, Agosto, 1982.
COATS, K. H., THOMAS, L. K., R.G., P. A new simpliﬁed compositional simulator. SPE -Society of Petroleum Engineers, 1995.
CORDAZZO, J. Simulação de reservatórios de petróleo utilizando o método EbFVM eMultigrid algébrico. Master’s Thesis, Universidade Federal de Santa Catarina, 2006.
COREY, A. T., RATHJENS, C. H., HENDERSON, J. H., WYLLIE, M. R. Three-phase relativepermeability. SPE - AIME, 1956.
DA CUNHA, A. R. Uma metodologia para simulação numérica tridimensional de re-servatórios de petróleo utilizando modelo black-oil e formulação em frações mássicas.
Master’s Thesis, Universidade Federal de Santa Catarina - UFSC, 1996.
DAKE, L. P. The Practice of Reservoir Engineering, revised edition. Eselvier, Netherlands,2001.
DARCY, H. Les Fontaines Publiques de la Ville de Dijon. 1856.
DULLIEN, F. A. L. Porous media. Fluid transport and pore structure. Academic Press,1979.
EWING, R. The Mathematics of Reservoir Simulation. SIAM, 1983.
FARNSTROM, K. L., ERTEKIN, T. A versatile, fully implicit, black oil simulator with vari-able bubble-point option. SPE California Regional Meeting, 1987.
GREIN, E. A. Aplicação da computação paralela na simulação de reservatórios de petró-leo. Master’s Thesis, Universidade Federal de Santa Catarina, 2015.
HURTADO, F. S. V. Uma formulação de volumes ﬁnitos baseada em elementos para asimulação do deslocamento bifásico imiscível em meios porosos. Master’s Thesis, Uni-versidade Federal de Santa Catarina, 2005.
HURTADO, F. S. V. Formulação tridimensional de volumes ﬁnitos para simulação de re-servatórios de petróleo com malhas não-estruturadas híbridas. Tese de doutorado, De-partamento de Engenharia Mecânica, Universidade Federal de Santa Catarina, Florianó-polis, Brasil, 2011.
KAVIANY, M. Principles of Heat Transfer in Porous Media. Springer, Ann Arbor, Michigan,1171995.
MACDONALD, R. C., COATS, K. H. Methods for Numerical Simulation of Water and GasConing. SPE, n. 10, pp. 425–436, 1970.
MALISKA, C. R. Transferência de Calor e Mecânica dos Fluidos Computacional. LTC Edi-tora, Rio de Janeiro, RJ, 2004.
MALISKA, C. R., DA SILVA, A. F. C., HURTADO, F. S. V., RIBEIRO, G. G., JR, A. A. V. B. P.,
GREIN, E. A., CERBATO, G. Introdução às malhas poliédricas e ao método baseado na re-construção explícita do gradiente, Relatório Técnico SINMEC/SiGeR 01. Technical report01, SINMEC/EMC/UFSC, Florianópolis, SC, 2012.
MALISKA, C. R., DA SILVA, A. F. C., HURTADO, F. S. V., RIBEIRO, G. G., CERBATO, G. De-senvolvimento de um esquema para a aproximação dos ﬂuxos na interface entre malhasestruturadas e não estruturadas, Relatório Técnico SINMEC/SiGeR 03. Technical report01, SINMEC/EMC/UFSC, Florianópolis, SC, 2015.
MCCAIN JR, W. The propreties of Petroleum Fluids. PennWell Publishing Company, Tulsa,Oklahoma, 1990.
PEACEMAN, D. W. Fundamentals of numerical reservoir simulation. Elsevier ScientiﬁcPublishing Company, Houston, Texas, 1977.
PEACEMAN, D. W. Interpretation of Well-Block Pressures in Numerical Reservoir Simu-lation. SPE journal, v. 18, n. 3, pp. 183–194, Junho, 1978.
ROSA, A. J., CARVALHO, R. S., XAVIER, J. A. Engenharia de reservatórios de petróleo. Edi-tora Interciência, 2006.
SHELDON, J. W., ZONDEK, B., CARDWELL, W. T. One Dimensional, Incompressible, Non-capillary, Two-Phase Fluid Flow in a Porous Medium. AIME, v. 216, pp. 290–296, 1959.
STONE, H. L., GARDER, A. O. Analysis of gas-cap or dissolved-gas reservoir. SPE AIME, v.
222, pp. 94–104, 1961.
THOMAS, J. E. Fundamentos de Engenharia de Petróleo. Editora Interciência, Rio deJaneiro, RJ, 2001.
TRANGENSTEIN, J. A., BELL, J. B. Mathematical Structure Of The Black-Oil Model For Pe-118troleum Reservoir Simulation. SIAM Journal on Applied Mathematics, v. Vol. 49, pp. 749–783, 1989.
WATTS, J. W. A compositional formulation of the pressure and saturation equations. SPE,1985.
YOUNG, L. C., STEPHENSON, E. R. A generalized compositional approach for reservoirsimulation. SPEJ, 1983.
ZIENKIEWICZ, O. C., TAYLOR, R. L. The Finite Element Method, ﬁfth, vol. 1. Butterworth-Heinemann, 2000.
119APÊNDICE A – DIFUSÃO NUMÉRICA NO PROBLEMA DEBUCKLEY-LEVERETTMétodos explícitos requerem que a restrição de Courant-Friedrichs-Lewy (CFL) sejasatisfeita, ao passo que métodos implícitos são incondicionalmente estáveis (Chen et al.,
2006). Esses métodos aprentam não apenas estabilidades diferentes, mas também com-portamentos distintos quanto ao custo computacional e à difusão numérica.
No caso especíﬁco do problema unidimensional de Buckley-Leverett, pode-se elucidarque há uma condição especíﬁca em que o método IMPES fornece a solução analítica e quenão é possível obtê-la por meio do método totalmente implícito. A equação modelo doproblema é∂ S∂ τ∂ F∂ X+= 0.
(A.1)
Trata-se de uma equação hiperbólica na qual tem-se a propagação unidirecional de umaonda (Chen et al., 2006).
A discretização dessa equação por meio do método dos volumes ﬁnitos e do esquemaupwind para uma malha unidimensional éSi − S oSi − Si−1(cid:48)= 0.
+ Fii(A.2)
∆τ∆Xem que i é o índice do volume de controle da equação e o superíndice o representa umavariável associada ao passo de tempo anterior.
S o = 0.
Para o método explícito tem-se(cid:48)Si − S o− S oi−1∆τFi∆X+(A.3)
iiIdentiﬁcando o coeﬁciente que multiplica o termo entre parênteses como o CFL e denotando-o por α, pode-se escreverSi − (1− α)S o− αS oi−1= 0.
(A.4)
iPode-se observar que a equação (A.4) é numéricamente estável para α ≤ 1. Além disso,TAISA BEATRIZ PACHECOCOMPARAÇÃO ENTRE AS FORMULAÇÕES IMPES, SEQUENCIAL ETOTALMENTE IMPLÍCITA NA SIMULAÇÃO DE ESCOAMENTOBIFÁSICO EM RESERVATÓRIOS APLICANDO O MÉTODO DOSVOLUMES FINITOS BASEADO EM ELEMENTOSEste Trabalho de Curso foi julgado adequado para a obtenção do título de EngenheiroMecânico e aprovado em sua forma ﬁnal pela Comissão examinadora e pelo Curso de Gra-duação em Engenharia Mecânica da Universidade Federal de Santa Catarina.
Prof. Carlos E. Niño Bohórquez, Dr.Eng.
Prof. Jonny Carlos da Silva, Dr. Eng.
Coordenador do CursoProfessor da DisciplinaComissão Examinadora:Prof. António Fábio C. da Silva, Dr. Eng.
OrientadorProf. Clovis R. Maliska, Ph.D.
Prof. Sérgio Peters, Dr. Eng.
Florianópolis2016Ao meu companheiro Ederson,aos meus pais Sérgio e Tâniae à minha irmã Carina.
AGRADECIMENTOSAgradeço primeiramente ao meu companheiro Ederson por todo carinho e por todosos ensinamentos – tanto no âmbito pessoal, quanto no proﬁssional – sem os quais este tra-balho não seria possível. Agradeço profundamente aos meus pais Sérgio e Tânia, por todoincentivo à educação e por estarem sempre presentes não obstante a distância. Também àminha irmã Carina, a qual sempre foi um exemplo pra mim e ao Rodrigo, o qual consideroum irmão.
Agradeço especialmente ao professor António Fábio Carvalho da Silva, não apenas porrealizar seus papeis de professsor e orientador com primazia, mas também por acreditarem mim no momento mais difícil, permitindo-me conﬁar em meu próprio potencial.
Ao professor Clovis Maliska pela oportunidade de trabalhar no laboratório SINMEC.
Aos amigos e colegas de trabalho Giovani e Gustavo, sempre presentes. Ao Fernando pelaatenção e prestatividade. À Tatiane e ao Axel pelo auxílio quanto às atividades cotidianasdo laboratório. Sobretudo à Tatiane, por sua amizade e por todas as risadas. A todos os in-tegrantes do SINMEC ainda não citados: Emílio, Conrado, Hermínio, Josiane, Rafael, VictorWagner, Maria, Riciêri, Victor Antonio, Fernando Eckstein, Gabriel, Gustavo Trentini, Hen-rique, Jurandir, Lara, Lucas, Róger e Ruan. Também a todos os amigos da universidade quenão foram citados.
À Universidade Federal de Santa Catarina e ao Departamento de Engenharia Mecânica,pela excelência do curso oferecido. Sobretudo, ao Laboratório de Simulação Numérica emMecânica dos Fluidos e Transferência de Calor – SINMEC – e ao Programa de RecursosHumanos da ANP pela estrutura disponibilizada, pelo apoio ﬁnanceiro e pelo excelenteambiente de trabalho.
“If you change the way you look at things,the things you look at change.”
Wayne DyerRESUMOEste trabalho apresenta resultados comparativos das formulações IMPES (IMplicit Pres-sure, Explicit Saturation), sequencial e totalmente implícita ou FIM (Fully Implicit Method)na simulação numérica de escoamento bifásico, isotérmico, imiscível e incompressível emreservatórios de petróleo utilizando malhas não-estruturadas e o método dos volumes ﬁ-nitos baseado em elementos (EbFVM). A implementação do simulador foi realizada pormeio de programação orientada a objetos aplicando a linguagem C ++. A metodologia IM-PES resolve de forma implícita a pressão e explícita, a saturação. Sua estabilidade está, pois,condicionada a uma restrição de passo de tempo, tendo em vista a aproximação explícitado cálculo do campo de saturação. Em decorrência de sua simplicidade, essa abordagempermite reduzir tanto o esforço computacional quanto a diﬁculdade relacionada à etapade implementação. Já a formulação sequencial consiste em um IMPES modiﬁcado com ointuito de atingir uma maior estabilidade. Por ﬁm, no método totalmente implícito tem-se a solução simultânea das equações de conservação por meio do método de Newton-Raphson. Essa formulação acarreta um sistema de equações maior e atrelado a diversasnão-linearidades. Não obstante as diﬁculdades numéricas e de implementação computa-cional desse esquema, trata-se de um método mais estável. Ademais, foi implementadauma estratégia de passo de tempo variável a ﬁm de reduzir o tempo computacional des-pendido na obtenção das soluções numéricas, a qual altera o passo de tempo de acordocom a variação do campo de saturação ao longo do transiente. Os resultados apresentam acomparação dos métodos IMPES sequencial e FIM em termos de estabilidade, custo com-putacional e precisão dos resultados.
Palavras-chave: simulação de reservatórios, escoamento bifásico, EbFVM, malhas não-estruturadas, IMPES, método sequencial, método totalmente implícito, método de New-ton.
ABSTRACTThis study presents comparative results of IMPES (IMplicit Pressure, Explicit Satura-tion), sequential, and fully implicit solution schemes for isothermal, immiscible, incom-pressible two-phase ﬂow reservoir simulation using unstructured grids and the Element-based Finite Volume Method (EbFVM). The implementation of the simulator was done th-rough object-oriented programming (OOP) in C ++. The IMPES method solves pressureimplicitly and saturation explicitly, as the acronym suggests. As a result of this explicit cal-culation its stability is subjected to a restriction of the time step. Nevertheless this approachreduces the computational effort and facilitates implementation. The sequential methodis a modiﬁed IMPES with the aim of improving the stability of explicit formulations. TheFully Implicit Method (FIM) or simultaneous approach solves the system of equations thatmodels the problem simultaneously employing the Newton-Raphson method. This formu-lation implies larger system of equations with many nonlinearities and thus higher com-putational cost. Regardless the difﬁculties related to the numerical scheme and its imple-mentation it is a more stable method. Furthermore, it is also presented a variable time stepstrategy in order to accelerate the performance of the methods. This strategy consists ba-sically in modifying the time step according to the current solution. In this paper, IMPES,sequential and fully implicit methods are compared in terms of stability, computationaltime and accuracy of its results.
Keywords: Reservoir simulations, two-phase ﬂow, EbFVM, unstructured grids, IMPES, se-quential method, fully implicit method, Newton method.
LISTA DE ILUSTRAÇÕES1.1 Etapas da simulação de reservatórios . . . . . . . . . . . . . . . . . . . . . . . . . . . .
231.2 Esquema ilustrativo de um reservatório sujeito à recuperação secundária .
242.1 Volume de controle em um meio poroso . . . . . . . . . . . . . . . . . . . . . . . . .
313.1 Potencial geométrico da malha não-estruturada . . . . . . . . . . . . . . . . . . .
373.2 Principais entidades de um elemento triangular . . . . . . . . . . . . . . . . . . . .
393.3 Construção do volume de controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
393.4 Mapeamento para um espaço transformado . . . . . . . . . . . . . . . . . . . . . .
403.5 Estêncil associado ao nó P . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
433.6 Método de Newton para funções de uma variável . . . . . . . . . . . . . . . . . . .
474.1 Classes responsáveis pela simulação pelo método IMPES . . . . . . . . . . . . .
514.2 Exemplo de estrutura da matriz do sistema linear da pressão . . . . . . . . . .
524.3 Classes responsáveis pela simulação pelo método FIM . . . . . . . . . . . . . . .
544.4 Esquema de interpolação upwind em elemento triangular . . . . . . . . . . . .
574.5 Volume de controle adjacente ao contorno . . . . . . . . . . . . . . . . . . . . . . .
604.6 Exemplo de estrutura da matriz jacobiana . . . . . . . . . . . . . . . . . . . . . . . .
624.7 Exemplo de etapa de montagem da matriz jacobiana . . . . . . . . . . . . . . . .
674.8 Fluxograma da estratégia de modiﬁcação do passo de tempo . . . . . . . . . .
725.1 Conﬁguração do problema de deslocamento unidimensional . . . . . . . . . .
745.2 Curvas de permeabilidade e ﬂuxo fracionário . . . . . . . . . . . . . . . . . . . . . .
765.3 Malhas não-estruturadas utilizadas na solução do problema de Buckley-Leverett . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
785.4 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo emuma malha de 430 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
795.5 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo emuma malha de 1961 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
795.6 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo emuma malha de 7392 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
805.7 Tempo computacional para os três métodos com passo de tempo ﬁxo . . .
805.8 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido depasso de tempo adaptativo em uma malha de 430 nós . . . . . . . . . . . . . . .
815.9 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido depasso de tempo adaptativo em uma malha de 1961 nós . . . . . . . . . . . . . .
815.10 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido depasso de tempo adaptativo em uma malha de 7392 nós . . . . . . . . . . . . . .
825.11 Tempo computacional para os três métodos com critério mais rígido depasso de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
825.12 Evolução do passo de tempo para a malha de 430 nós com critério maisrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
835.13 Evolução do passo de tempo para a malha de 1961 nós com critério maisrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
835.14 Evolução do passo de tempo para a malha de 7392 nós com critério maisrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
845.15 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido depasso de tempo adaptativo em uma malha de 430 nós . . . . . . . . . . . . . . .
845.16 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido depasso de tempo adaptativo em uma malha de 1961 nós . . . . . . . . . . . . . .
855.17 Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido depasso de tempo adaptativo em uma malha de 7392 nós . . . . . . . . . . . . . .
855.18 Tempo computacional para os três métodos com critério menos rígido depasso de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
865.19 Evolução do passo de tempo para a malha de 430 nós com critério menosrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
865.20 Evolução do passo de tempo para a malha de 1961 nós com critério menosrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
875.21 Evolução do passo de tempo para a malha de 7392 nós com critério menosrígido de passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . .
875.22 Campos de saturação e pressão para os instantes de tempo 0,2, 0,3 0,4 e0,5 VPI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
885.23 Conﬁguração do problema de deslocamento bidimensional . . . . . . . . . . .
905.24 Malhas não-estruturadas utilizadas na solução do problema quarter ﬁve-spot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
915.25 Resultados obtidos para o deslocamento bidimensional com passo de tempoﬁxo e uma malha de 425 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
935.26 Resultados obtidos para o deslocamento bidimensional com passo de tempoadaptativo e uma malha de 425 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
945.27 Resultados obtidos para o deslocamento bidimensional com passo de tempoﬁxo e uma malha de 1483 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
955.28 Resultados obtidos para o deslocamento bidimensional com passo de tempoadaptativo e uma malha de 1483 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . .
965.29 Resultados obtidos para o deslocamento bidimensional com passo de tempoﬁxo e uma malha de 5985 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
975.30 Resultados obtidos para o deslocamento bidimensional com passo de tempoadaptativo e uma malha de 5985 nós . . . . . . . . . . . . . . . . . . . . . . . . . . . .
985.31 Campos de pressão e saturação no instante de breakthrough . . . . . . . . . .
995.32 Campos de saturação para os instantes de tempo de 500, 1500, 3000 e 5000dias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
995.33 Tempos computacionais despendidos no caso de deslocamento bidimen-sional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1015.34 Resultados obtidos para o deslocamento bidimensional com o método to-talmente implícito . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1025.35 Conﬁguração do problema tridimensional . . . . . . . . . . . . . . . . . . . . . . . .
1045.36 Ilustração da malha cilíndrica ao redor dos poços . . . . . . . . . . . . . . . . . .
1055.37 Resultados obtidos para o deslocamento tridimensional em malha híbridacom os três métodos para 3000 dias de simulação . . . . . . . . . . . . . . . . . .
1075.38 Resultados obtidos para o deslocamento tridimensional em malha híbridacom o método totalmente implícito para 10000 dias de simulação . . . . . .
1085.39 Campo de saturação para quatro instantes de tempo . . . . . . . . . . . . . . . .
1095.40 Campo de pressão para quatro instantes de tempo . . . . . . . . . . . . . . . . . .
1095.41 Campos ﬁnais de pressão e saturação . . . . . . . . . . . . . . . . . . . . . . . . . . .
110LISTA DE TABELAS4.1 Parâmetros correspondentes ao critérios mais rígido de passo de tempoadaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
714.2 Parâmetros correspondentes ao critérios menos rígido de passo de tempoadaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
715.1 Dados do problema de deslocamento bifásico bidimensional . . . . . . . . . .
915.2 Tempo computacional – passo de tempo ﬁxo e malha de 425 nós . . . . . . .
935.3 Tempo computacional – passo de tempo adaptativo e malha de 425 nós . .
945.4 Tempo computacional – passo de tempo ﬁxo e malha de 1483 nós . . . . . .
955.5 Tempo computacional – passo de tempo adaptativo e malha de 1483 nós .
965.6 Tempo computacional – passo de tempo ﬁxo e malha de 5985 nós . . . . . .
975.7 Tempo computacional – passo de tempo adaptativo e malha de 5985 nós .
985.8 Tempo computacional despendido com o método FIM . . . . . . . . . . . . . .
1025.9 Dados do problema de deslocamento bifásico tridimensional . . . . . . . . . .
1055.10 Tempo computacional despendido . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107LISTA DE LISTAGENS4.1 Pseudocódigo da rotina que resolve o sistema linear da pressão . . . . . . . .
534.2 Pseudocódigo da rotina que resolve o sistema não linear . . . . . . . . . . . . .
554.3 Pseudocódigo da rotina que computa os resíduos . . . . . . . . . . . . . . . . . .
564.4 Pseudocódigo da rotina que adiciona o termo difusivo nos resíduos . . . . .
564.5 Pseudocódigo da rotina que adiciona o termo acumulativo nos resíduos . .
574.6 Pseudocódigo da rotina que adiciona o termo fonte nos resíduos . . . . . . .
594.7 Pseudocódigo da rotina que aplica as condições de contorno nos resíduos604.8 Pseudocódigo da rotina que monta a matriz jacobiana . . . . . . . . . . . . . . .
634.9 Pseudocódigo da rotina que adiciona o termo difusivo na matriz jacobiana654.10 Pseudocódigo da rotina que adiciona o termo acumulativo na matriz jaco-biana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
684.11 Pseudocódigo da rotina que aplica as condições de contorno na matriz ja-cobiana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
694.12 Pseudocódigo da rotina que aplica as condições de contorno na matriz ja-cobiana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70LISTA DE SÍMBOLOSSímbolosRomanos(x , y ) Coordenadas globais[m][m2]SVetor área∆Smax Diferença máxima de saturação especiﬁcada no critério de passo de tempo variável∆Smin Diferença mínima de saturação especiﬁcada no critério de passo de tempo variável[s]∆tPasso de tempo[m2]∆AfVetor área associado à face f[kg/s]˙m fFluxo de massa que atravessa uma face f do volume de controleˆSSaturação de água normalizadaNiFunção de forma associada ao i-ésimo vértice do elemento[m2]KTensor permeabilidade absoluta do meio(cid:69) P(cid:77) Malha(cid:78) e(cid:83) PConjunto dos elementos que compartilham o nó PConjunto dos nós associados ao elemento eEstêncil associado ao nó P[m/s2]gVetor gravidade[m/s]VpVelocidade da fase pξRazão adimensional entre espaço e tempoeii-ésimo elemento de uma malhaFTermo fonte[kg/(m3 s)]F pTaxa de geração ou extinção de massa fase p por unidade de volume[1/s]f pTaxa de geração ou extinção de volume da fase p por unidade de volumeFfFluxo fracionário[m2/s2]GFunção potencial gravitacionalJMatriz jacobiana−1D Operador gradiente discretoJk prPermeabilidade relativa da fase pn vNumero de vértices de um elemento[Pa]P pPressão da fase pR tResíduo associado à conservação da massa totalR wResíduo associado à conservação da massa da fase águaR eNúmero de ReynoldsS pSaturação da fase pS wma x Saturação máxima de águaS wmi nSaturação mínima de água[m/s]v TVelocidade total na direção x[m]XCoordenada axial x normalizadaAbreviações[m3]WIwell indexBTBreakthroughEbFVM Element-based Finite Volume MethodEOR Enhanced Oil RecoveryFIM Fully Implicit MethodIMPES IMplicit Pressure, Explicit SaturationVPIVolume poroso injetadoSímbolosGregos(ξ, η) Coordenadas locais[m][m3/s]αwacTermo de acumulação associado à equação do resíduo R wαaum Constante utilizada para aumentar o passo de tempo[m3/s]αtTermo difusivo associado à equação do resíduo R tdif[m3/s]αwdifTermo difusivo associado à equação do resíduo R w[m3/s]αtTermo fonte associado à equação do resíduo R tfon[m3/s]αwfonTermo fonte associado à equação do resíduo R wαredConstante utilizada para reduzir o passo de tempoΓCoeﬁciente difusivo[1/(Pas)]λpMobilidade da fase p[m3/s]θ pfPseudoﬂuxo da face p na face f[Pa s]µpViscosidade da fase pΩDomínio fechadoψP Média do valor de ψ em P∂ ΩFronteira do volume de controleφPorosidade do meio[Pa]ΦpPotencial da fase pψFunção deﬁnida nos nós de uma malhaVetor com os valores de ψ nos nós do elementoΨeτTempo adimensionalTolerância especiﬁcadaSobrescritoseSubscritosPNó da malhaeElementofFaceoÓleopFase prRelativotTotalwÁguaacAcumulativodifDifusivofonFontemax Máximomin MínimooldAntigopresc PrescritoSUMÁRIO1 Introdução221.1 Simulação de reservatórios . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
221.1.1 Etapas da simulação de reservatórios . . . . . . . . . . . . . . . . . . . . . .
231.1.2 O fenômeno físico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
231.2 O modelo bifásico imiscível . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251.3 O Método dos Volumes Finitos baseado em Elementos . . . . . . . . . . . . . . .
251.4 Revisão bibliográﬁca . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
261.4.1 Método IMPES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
261.4.2 Método sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271.4.3 Método totalmente implícito . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271.5 Objetivos e contribuições . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271.6 Organização do trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
282 Modelo Matemático302.1 A Lei de Darcy na forma de potenciais . . . . . . . . . . . . . . . . . . . . . . . . . . .
302.2 Equações fundamentais do modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
312.3 Propriedades físicas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
332.3.1 Propriedades dos ﬂuidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
332.3.2 Propriedades da rocha . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
342.3.3 Propriedades do conjunto rocha-ﬂuido . . . . . . . . . . . . . . . . . . . . .
353 Método Numérico363.1 Método dos Volumes Finitos Baseado em Elementos . . . . . . . . . . . . . . . .
363.1.1 Entidades geométricas da malha . . . . . . . . . . . . . . . . . . . . . . . . . .
383.1.2 Abordagem numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
393.1.3 Discretização de uma equação de conservação de uma variável ge-nérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
423.2 Equações discretizadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
443.3 Formulações impes e sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
453.4 Formulação totalmente implícita . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
463.4.1 Método de Newton . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
464 Implementação Computacional504.1 Métodos impes e sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
504.1.1 Estrutura geral do simulador . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
514.1.2 Cálculo implícito da pressão . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
514.1.3 Cálculo explícito da saturação . . . . . . . . . . . . . . . . . . . . . . . . . . . .
534.2 Método totalmente implícito . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
544.2.1 Estrutura geral do simulador . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
544.2.2 Cálculo dos resíduos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
554.2.3 Construção da matriz jacobiana . . . . . . . . . . . . . . . . . . . . . . . . . .
614.3 Passo de tempo adaptativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
704.4 Especiﬁcação das tolerâncias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
735 Resultados745.1 Deslocamento unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
745.1.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
745.1.2 Solução analítica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
765.1.3 Resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
775.2 Deslocamento bidimensional em conﬁguração quarter ﬁve-spot . . . . . . .
905.2.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
905.2.2 Resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
915.3 Deslocamento tridimensional em malha híbrida . . . . . . . . . . . . . . . . . . .
1045.3.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1045.3.2 Resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1066 Conclusão1116.1 Sumário . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1116.2 Conclusões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1126.3 Sugestões para trabalhos futuros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
114Referências118221INTRODUÇÃO1.1 SIMULAÇÃO DE RESERVATÓRIOSAtribui-se o desígnio reservatório de petróleo a um meio poroso que contém hidrocar-bonetos. Tendo em vista a concentração de investimentos no setor petrolífero e os gran-des efeitos da produção de petróleo na economia global, ascendeu a necessidade de pre-ver e otimizar a performance dos reservatórios. A decisão de implantar um complexo deexplotação de petróleo envolve custos elevadíssimos e requer, por conseguinte, uma fun-damentação sólida de que será vantajosa. Isso envolve um estudo prévio de viabilidadeeconômica e operacional.
A análise experimental completa do reservatório não é viável, porquanto ocasionariaalém de altos investimentos, muitas diﬁculdades. Nesse contexto, a simulação de reser-vatórios desponta como uma potente ferramenta a ﬁm de prognosticar a performance doreservatório e encontrar meios para otimizar a recuperação de certos hidrocarbonetos sobdiferentes condições operacionais. Essa área envolve física, matemática, engenharia dereservatórios e programação computacional.
Ainda, a simulação de reservatórios é complexa devido, sobretudo, a dois fatores. O
primeiro, é a falta de contato direto com o fenômeno físico o qual se deseja simular. Sendoassim, há diﬁculdades no processo de caracterização física e, por conseguinte, da seleçãode modelos matemáticos adequados que o possam descrever com um grau satisfatório deacurácia. O segundo fator consiste na própria complexidade atrelada ao fenômeno físico,pois que envolve minúcias por vezes nem compreendidas ou extremamente enredado emoutros fenômenos, de forma que a dependência mútua das variáveis acarreta uma simu-lação numérica complicada e custosa.
A ﬁm de progredir na descrição dos fenômenos, a área de simulação de reservatóriostem caráter dinâmico, i.e., trata-se de uma área constantemente aprimorada e ampliada.
Dada a quantidade de novos modelos propostos destinados à simulação de efeitos pro-gressivamente mais complexos, faz-se interessante dominar, primeiramente, aqueles maisbásicos, os quais levam em conta os efeitos mais signiﬁcativos ao fenômeno físico. Aziz &Settari (1979) sugerem que, antes de partir à implementação de qualquer modelo mais so-ﬁsticado, é fundamental adquirir a compreensão do modelo bifásico. O presente trabalhoalmeja explorar esse modelo a ﬁm de analisar o desempenho de três esquemas de solução23distintos – IMPES, sequencial e totalmente implícito. O conhecimento do modelo maisadequado ao objetivo da simulação numérica é imprescindível à correta interpretação dosresultados obtidos, de forma que essa comparação se faz valiosa quanto à escolha do mé-todo a ser utilizado.
1.1.1 ETAPAS DA SIMULAÇÃO DE RESERVATÓRIOSO processo de simulação de reservatórios envolve quatro etapas de modelagem for-temente atreladas, as quais estão esquematizadas na ﬁgura 1.1. Primeiramente, há de sedesenvolver um modelo físico para o problema que incorpore os processos mais relevantesà caracterização do fenômeno. A seguir, o problema é modelado matematicamente atravésde um conjunto de equações diferenciais parciais acopladas e dependentes do tempo. É,
então, desenvolvido um método numérico através do qual pode-se implementar compu-tacionalmente a resolução do sistema de equações associados ao fenômeno físico (Chen,1962).
Figura 1.1: Etapas da simulação de reservatóriosFonte: do autor1.1.2 O FENÔMENO FÍSICOO fenômeno físico de interesse na simulação de reservatórios consiste no escoamentomultifásico multicomponentes em um meio poroso. Usualmente, coexistem três fases:água, óleo e gás (da Cunha, 1996). Além disso, essas fases podem conter mais de um com-ponente e estão impregnadas em micro poros rochosos como o arenito (Ewing, 1983).
Reservatórios de petróleo são, de fato, rochas-reservatório e, portanto, são considera-dos como um meio poroso no qual o escoamento pode ser modelado a partir da equações24de Darcy (Bejan, 2004). O petróleo é produzido na rocha geradora e migra, sobretudo porcapilaridade e forças de empuxo, para a rocha reservatório. Não se desloca para as cama-das mais próximas à superfície em virtude da presença de uma rocha capeadora, a qualo envolve superiormente e apresenta baixa permeabilidade. Esses tipos de rochas estãoilustrados, esquematicamente, na ﬁgura 1.2.
Figura 1.2: Esquema ilustrativo de um reservatório sujeito à recuperação secundáriaFonte: do autorNa maioria das vezes, o petróleo só pode ser retirado do meio poroso através da impo-sição de elevados gradientes de pressão oriundos de mecanismos físicos denominados deprocessos de recuperação(Cordazzo, 2006). Esses processos são divididos em três catego-rias, a saber (Dake, 2001):• Recuperação primária: dá-se a perfuração dos poços e a produção sem nenhumatentativa de elevar a produtividade por meio de injeção de ﬂuidos;• Recuperação secundária: adota-se uma estratégia de injeção de água ou gás no in-tuito de manter a pressão, parcialmente ou totalmente, e acelerar o deslocamento doóleo em direção aos poços produtores. A ﬁgura 1.2 ilustra esse processo;• Recuperação avançada (EOR – Enhanced Oil Recovery): utiliza técnicas mais soﬁsti-cadas a ﬁm de alterar as propriedades originais do óleo. As três principais variantesdesse processo envolvem fenomenos químicos, de alteração de miscibilidade e tér-micos.
251.2 O MODELO BIFÁSICO IMISCÍVELA simulação do processo de recuperação de hidrocarbonetos em reservatórios de pe-tróleo requer a modelagem numérica de escoamentos multifásicos de múltiplos compo-nentes. O modelo matemático pode levar em conta processos de transferência de calor emassa por advecção e difusão e, por vezes, reações químicas.
Tendo em vista a complexidade dos fenômenos físicos associados ao processo de extra-ção, os modelos devem ser simpliﬁcados a ﬁm de que sua solução seja viável. Entretanto,a simpliﬁcação deve ser realizada de forma que os resultados obtidos sejam aceitáveis, i.e.,
as hipóteses devem prover aproximações consistentes.
O modelo utilizado no presente trabalho se destina à simulação de processos de deslo-camento de duas fases ﬂuidas imiscíveis. Um exemplo característico desse processo é a re-cuperação secundária de petróleo de reservatórios mediante a injeção de água. Trata-se damodelagem mais simples de escoamentos multifásicos. Em comparação ao escoamentomonofásico, requer, pois, técnicas mais avançadas, dada a necessidade de lidar com umsistema acoplado de equações não lineares (Aziz, 1993).
Ademais, usualmente novas técnicas numéricas para modelos mais complexos são im-plementadas e avaliadas, inicialmente, com o modelo bifásico, o qual apresenta diﬁculda-des semelhantes em relação às questões geométricas (Hurtado, 2005).
1.3 O MÉTODO DOS VOLUMES FINITOS BASEADO EM ELEMEN-TOSOs primeiros simuladores utilizados na área de óleo e gás empregavam, inicialmente,apenas malhas cartesianas ortogonais. As diﬁculdades associadas à geometria complexados reservatórios motivaram a introdução de malhas cartesianas não-ortogonais, conhe-cidas como malhas corner-point. Esse tipo de malha estruturada ainda é largamente apli-cado em simuladores comerciais.
O Método dos Volumes Finitos baseado em Elementos (EbFVM) emprega malhas nãoestruturadas para uma representação ainda mais ﬂexível e acurada do domínio. Isto é,permite solucionar o problema em geometrias mais complexas, de forma que representao problema de forma mais ﬁdedigna. Trata-se de um método versátil e consistente, que26satisfaz a característica fundamental dos Métodos dos Volumes Finitos – conservação dapropriedade em níveis elementares (Maliska, 2004).
O EbFVM surgiu, inicialmente, para a solução das equações de Navier-Stokes em Ba-liga & Patankar (1983). Sua utilização na área de simulação de reservatórios de petróleoocorreu posteriormente, muito embora ainda seja pouco utilizado em simuladores comer-ciais. Uma descrição detalhada e completa sobre o EbFVM pode ser encontrada em Hur-tado (2011).
1.4 REVISÃO BIBLIOGRÁFICAAs equações provenientes da modelagem matemática de escoamentos multifásicoscompõem um sistema não linear acoplado. Dentre as metodologias utilizadas para resol-ver esse sistema, destacam-se os métodos IMPES e totalmente implícito (Chen, 1962). A
seguir, far-se-á uma breve revisão bibliográﬁca de ambos os métodos.
1.4.1 MÉTODO IMPESO método IMPES (IMplicit Pressure Explicit Saturation) foi originalmente desenvolvidopor Sheldon et al. (1959) e Stone & Garder (1961). A ideia fundamental dessa formulaçãoclássica é dividir o sistema de equações acoplado em sistemas de equações distintos parapressão e saturação, os quais são resolvidos de forma implícita e explícita, respectivamente.
O cálculo explícito da saturação acarreta maior simplicidade quanto à implementaçãodo método e menor custo computacional. Entretanto, sua estabilidade está atrelada à uti-lização de pequenos passos de tempo. (Chen, 1962) e Coats (1968) discutem a estabilidadedessa formulação.
Desenvolvimentos posteriores foram realizadas em Coats (1982), Watts (1985) e Young& Stephenson (1983) e outras metodologias baseadas no IMPES foram propostas em Bu-chwalter & Miller (1993),Coats et al. (1995) e Cao & Aziz (2002). Posteriormente, Chen &Li (2004) e Hurtado (2005) discutiram um IMPES modiﬁcado em que diferentes passos detempo para pressão e saturação foram aplicados.
271.4.2 MÉTODO SEQUENCIALA ﬁm de melhorar a estabilidade da formulação IMPES, MacDonald & Coats (1970) pro-puseram uma modiﬁcação na metodologia IMPES na qual após resolver a pressão implici-tamente e a saturação explciitamente, os coeﬁcientes da matriz correspondente ao sistemalinear da pressão são atualizados e os campos de pressão e saturação são calculados até queseus valores se alterem menos que uma tolerância especiﬁcada.
1.4.3 MÉTODO TOTALMENTE IMPLÍCITOO método totalmente implícito ou FIM (Fully Implicit Method) resolve pressão e sa-turação implicitamente e simultaneamente, de forma que ascende a necessidade de re-solver um sistema não linear de equações. A formulação é incondicionalmente estável eapresenta boa solução para diversos problemas numéricos, conforme descrito em Aziz &Settari (1979), Farnstrom & Ertekin (1987), Peaceman (1977) e Watts (1985).
1.5 OBJETIVOS E CONTRIBUIÇÕESDesde sua criação 1981, o SINMEC – Laboratório de Simulação Numérica em Mecâ-nica dos Fluidos e Transferência de Calor, do Departamento de Engenharia Mecânica daUniversidade Federal de Santa Catarina – tem como objetivo o desenvolvimento de me-todologias numéricas utilizando, sobretudo, o método dos volumes ﬁnitos para resolverproblemas que envolvem escoamento de ﬂuidos. A principal linha de pesquisa do labo-ratório consiste no desenvolvimento de algoritmos empregando malhas não estruturadascom o método dos volumes ﬁnitos baseado em elementos (EbFVM). Uma das aplicaçõesde engenharia precípuas nessa área de trabalho é a simulação numérica de escoamentosem reservatórios de petróleo.
Entre 2007 e 2010, o laboratório executou o projeto SIGER I, do qual resultou a biblio-teca EFVLib, dedicada ao gerenciamento da topologia e geometria de malhas não estrutu-radas para a discretização de equações diferenciais parciais pelo método de volumes ﬁnitosbaseado em elementos.
A principal contribuição deste trabalho consiste na implementação de um simuladorbifásico totalmente implícito na biblioteca EFVLib, a qual, anteriormente, não dispunha28de um solver não linear. Almeja-se assim, não apenas introduzir uma nova metologia nabiblioteca, mas também analisar seu desempenho na simulação de reservatórios de petró-leo. Ainda, tendo em vista o elevado custo computacional atrelado ao método totalmenteimplícito e ao emprego de malhas não-estruturadas, deseja-se implementar um esquemade passo de tempo adaptativo. Essa implementação tem como intuito veriﬁcar tanto a sen-sibilidade da solução numérica quanto a melhoria de desempenho.
Os objetivos deste trabalho são:1. Incorporar à EFVlib um método para resolver um sistema não-linear de equações;2. Desenvolver um simulador bifásico imiscível, isotérmico e incompressível para ma-lhas não-estruturadas aplicando o método dos volumes ﬁnitos baseado em elemen-tos;3. Implementar um esquema de passo de tempo adaptativo e veriﬁcar sua inﬂuêncianas soluções numéricas;4. Comparar o simulador totalmente implícito implementado aos métodos IMPES e se-quenciala;1.6 ORGANIZAÇÃO DO TRABALHONo capítulo 2 é apresentada a formulação matemática do problema. São expostos edescritos os conceitos fundamentais à caracterização do modelo, o conjunto de equaçõesdiferenciais que modelam o fenômeno físico e o tratamento das propriedades físicas, dosﬂuidos, da rocha e da interação entre ﬂuidos e rocha.
No capítulo 3 são realizadas as aproximações numéricas que permitem a obtenção dasolução do problema por meio de rotinas computacionais. São apresentados o método dosvolumes ﬁnitos baseado em elementos, as discretizações das equações conservativas e asformulações adotadas para resolver essas equações.
A seguir, no capítulo 4 tem-se a descrição da etapa de implementação computacionaldo modelo matemático e numérico descrito até então. É descrita a maneira com a qualo código em C ++ é implementado a ﬁm de resolver o problema proposto satisfazendo to-aO IMPES disponível na biblioteca – implementado em (Grein, 2015) – foi modiﬁcado para se ajustar àscomparações realizadas neste trabalho.
29dos os requerimentos já elucidados. Expõe-se também uma visão geral do código, a qualfacilita o entendimento do tratamento de dados e de suas relações hierárquicas.
O capítulo 5 se destina à validação do simulador implementado e à apresentação dosresultados obtidos por meio das formulações propostas.
Por ﬁm, no capítulo 6 estão dispostos um sumário, as conclusões e algumas sugestõespara trabalhos futuros.
302 MODELO MATEMÁTICOA obtenção da solução numérica de qualquer problema físico requer sua prévia mode-lagem matemática(Maliska, 2004). Nessa etapa, aspectos físicos e matemáticos são inte-grados a ﬁm de que um fenômeno natural possa ser descrito com um certo grau de acurá-cia, por meio de equações diferenciais. Ressalta-se a importâncias das hipóteses realizadasao longo da modelagem, pois que instituem o grau de proximidade entre a descrição e ofenômeno em si.
Ao longo deste capítulo, apresentar-se-á a modelagem matemática do deslocamentobifásico imiscível. Considerando-se, sobretudo, o escoamento no reservatório, será apre-sentado o conjunto de equações diferenciais que modelam o problema e as variáveis en-volvidas em sua descrição.
Para isso, será apresentada a lei de Darcy na forma de potenciais. A seguir, será de-duzida a equação de conservação da massa de um componente genérico em escoamentomultifásico. Essa equação será, então, adequada às hipóteses e simpliﬁcações do modeloimplementado. Por ﬁm, descrever-se-á o tratamento das propriedades físicas do ﬂuido eda rocha que apresentam dependência em relação às variáveis primárias do problema.
2.1 A LEI DE DARCY NA FORMA DE POTENCIAISNa mecânica dos ﬂuidos em meios porosos, as equações de Navier-Stokes dão lugar àsobservações experimentais expressas matematicamente por meio da Lei de Darcy (Bejan,2004). Essas observações foram relatadas em Darcy (1856), sugerindo que a velocidademédia de um ﬂuido newtoniano escoando em um dado meio poroso sob regime laminar éproporcional ao gradiente de pressão e inversamente proporcional à viscosidade do ﬂuido.
Assumindo-se que o escoamento da fase p no reservatório se dê na presença do campogravitacional e em regime de Stokes (R e ≤ 1), i.e., em baixas velocidades, de forma queas forças viscosas sejam dominantes, a Lei de Darcy para a determinação do campo develocidades up da fase p é dada porK·∇P p − ρp g,up =−k prµp(2.1)
em que K é o tensor permeabilidade absoluta do meio e µp , P p e k pr são, respectivamente31a viscosidade, a pressão e a permeabilidade relativa associadas à fase p (Kaviany, 1995).
Para a formulação numérica, a qual será detalhada posteriormente, faz-se mais con-veniente o emprego da Lei de Darcy na forma de potenciais. Para isso, deﬁne-se a funçãopotencial da fase p comoΦp ≡ P p − ρpG ,(2.2)
em que G é a função potencial gravitacional, dada porG = x· g,(2.3)
sendo x o vetor posição e g, o vetor aceleração da gravidade. Dado isso, o gradiente dopotencial da fase p é∇Φp =∇P p − ρp g.
(2.4)
Substituindo a equação (2.4) na equação (2.1), tem-se a Lei de Darcy modiﬁcada, es-crita na forma de potenciais:up =−k pK·∇Φp .
rµp(2.5)
2.2 EQUAÇÕES FUNDAMENTAIS DO MODELOA ﬁgura 2.1 representa um volume de controle Ω, de volume V , ﬁxo no espaço, extraídode um meio poroso. O vetor área é representado por dS e a fronteira do volume, por ∂ Ω.
Figura 2.1: Volume de controle em um meio porosoFonte: modiﬁcado de (Hurtado, 2005)Uma vez que o modelo é imiscível, o balanço de massa de um componente coincidecom o balanço de massa da fase associada a esse componente. Sendo assim, pode-se efe-tuar o balanço de massa de uma fase p do escoamento multifásico através desse volume32(cid:90)(cid:90)de controle, o qual é dado porρp u p · dS =∂ M p∂ t+F p dV ,(2.6)
∂ ΩVem que F p é a taxa de geração ou extinção de massa da fase p por unidade de volume.
Tendo em vista que a porosidade φ é a razão entre o volume poroso e o volume total domeio e a saturação da fase p é a razão entre o volume ocupado pela fase p e volume porosodo meio, isto é,φ = VφVS p = VpVφe,(2.7)
(cid:90)(cid:90)(cid:90)ρp u p · dS =(cid:90)pode-se escrever∂∂ tρpS p φdV +F p dV .
(2.8)
∂ ΩVV(cid:90)(cid:90)Aplicando-se o Teorema da Divergência de Gauss e a condição de escoamento incompres-sível, tem-seρp∇· u p dV =∂∂ tρpS p φdV +ρp f p dV ,(2.9)
VVVem quef p = F pρp .
(2.10)
Uma vez que o volume de controle é ﬁxo no espaço e o escoamento é incompressível, pode-(cid:90) ∂S p φ +∇· u p − f pS p φ +∇· u p − f p = 0.
se reescrever a equação na formadV = 0.
(2.11)
∂ tVJá que a equação (2.11) deve ser válida para qualquer volume V , deve-se ter∂∂ t(2.12)
A velocidade da fase p pode ser substituída pela Lei de Darcy na forma de potenciais dadaS p φ +∇· (−λp K∇Φp ) − f p = 0,na equação (2.5). A equação da conservação da massa para a fase p é, então:∂∂ t(2.13)
em que λp é a mobilidade da fase p , dada porλp = k pµp .
r(2.14)
Assim, as equações de conservação da massa das fase água e óleo são dadas, respectiva-33S w φ +∇· (−λw K∇Φw ) − f w = 0,S o φ +∇· (−λo K∇Φo ) − f o = 0.
mente, por∂∂ t∂∂ t(2.15)
(2.16)
O modelo bifásico é completado pela equação de restrição volumétricaS w + S o = 1.
(2.17)
Ainda, assumindo-se que os efeitos de pressão capilar são poucos signiﬁcativos, considera-se uma única pressão P . Utilizando a equação∇Φp =∇P − ρp g,(2.18)
a pressão pode ser obtida por meio de um pós processamento tendo em vista que assumiu-se escoamento incompressível. Tem-se, assim, três equações – (2.15), (2.16) e (2.17) – e trêsincógnitas – S w , S o e P .
2.3 PROPRIEDADES FÍSICASNos estudos de um reservatório de petróleo, é de caráter essencial o conhecimento daspropriedades básicas da rocha e dos ﬂuidos nela contidos. São essas propriedades quedeterminam as quantidades dos ﬂuidos existentes no meio poroso, sua distribuição, seucomportamento. É evidente que têm forte inﬂuência sobre a quantidade de ﬂuido quepode ser extraída e, portanto, se fazem muito importantes no contexto de exploração depetróleo (Thomas, 2001).
Esta seção se destina à descrição da obtenção e tratamento das propriedades físicasabarcadas no modelo matemático apresentado. Primeiramente, serão descritas as propri-edades do ﬂuido; posteriormente, da rocha. Por ﬁm, as propriedades associadas ao con-junto rocha-ﬂuido.
2.3.1 PROPRIEDADES DOS FLUIDOS• Viscosidades:A viscosidade é uma medida da resistência do ﬂuido em relação ao escoamento. Estárelacionada diretamente ao tipo e ao tamanho de suas moléculas. Trata-se de um34parâmetro presente em qualquer equação que descreve movimentos de ﬂuidos (Mc-Cain Jr, 1990). A viscosidade é função da pressão e da temperatura. Sua variação emvirtude da temperatura será desconsiderada, pois que o modelo matemático é desti-nado a um escoamento isotérmico. Quanto à pressão, a viscosidade é crescente coma pressão para um reservatório subsaturado; decrescente, para saturado (Trangens-tein & Bell, 1989). Neste trabalho, contudo, as viscosidades da água e do óleo foramconsideradas constantes.
• Densidades:A densidade é a relação entre a massa e o volume da fase. Uma vez que o modeloconsiderado é incompressível, as densidades da água e do óleo permanecem cons-tantes.
2.3.2 PROPRIEDADES DA ROCHA• Porosidade:A porosidade é a razão entre o volume poroso e o volume total da rocha. Neste tra-balho, a rocha reservatório é considerada incompressível.
• Permeabilidade absoluta:A propriedade permeabilidade absoluta da rocha, presente na Lei de Darcy –equação(2.5)–, é a medida de sua capacidade de permitir o ﬂuxo de ﬂuidos. Neste trabalho, apermeabilidade absoluta é representada na forma de um tensor de segunda ordem.
Tal tensor é simétrico, contendo nove componentes Kaviany (1995). A representaçãoé ortotrópica, considerando as direções principais de permeabilidade alinhadas comos eixos de coordenadas x , y , z . Dessa forma, o tensor K é uma matriz puramentediagonal dada por K x x00K =(2.19)
0K y y000Kz z352.3.3 PROPRIEDADES DO CONJUNTO ROCHA-FLUIDO• Permabilidade relativa:No escoamento multifásico em meio poroso, faz-se necessário introduzir a permea-bilidade relativa na Lei de Darcy no intuito de considerar as interações entre os ﬂui-dos (Peaceman, 1977). Permeabilidade relativa é um conceito utilizado para relaci-onar a permeabilidade absoluta (de um ﬂuido único e saturado) à permeabilidadeefetiva do ﬂuido no escoamento multifásico, quando esse ocupa uma fração do vo-lume poroso. Foi observado, experimentalmente, que a permeabilidade relativa éfunção das saturações – seu valor decresce com a diminuição da saturação da fase(Archer & Wall, 1986). Ou seja, essa propriedade associada ao conjunto rocha-ﬂuidointroduz a forma segundo a qual o escoamento é afetado em virtude da presença deoutras fases e da matriz porosa. Trangenstein & Bell (1989) aﬁrmam que a permeabi-lidade relativa depende do volume ocupado por cada fase, da rocha, do histórico doescoamento e da tensão interfacial entre as fases. Essas interações complexas aindanão são totalmente entendidas e dominadas. Pode-se aﬁrmar, contudo, que a mo-vimentação de uma fase também tende à zero conforme sua saturação tende à zero.
Ainda, sabe-se que a fase deve alcançar o estado imóvel antes que sua saturação sejanula (Trangenstein & Bell, 1989).
Optou-se por calcular as permeabilidades relativas da água e do óleo por meio domodelo proposto em Corey et al. (1956). Para caracterizá-lo, deﬁnem-se S pmi n,as saturações máxima e mínima, respectivamente, da fase p . A permeabilidade rela-ma x e S p= αw ˆSn w= αo1− ˆSn o S w − S w− S wtiva desta fase é dada pork wr,(2.20)
k or,(2.21)
em que o parâmetro αp e o expoente n p são constantes conhecidas dependentes dainteração entre a fase e a rocha e a saturação ˆS normalizada é calculada porˆS =mi n.
(2.22)
S wma xmi n363 MÉTODO NUMÉRICOO conjunto de equações que constitui o modelo numérico associado à simulação deum reservatório é, quase sempre, demasiadamente complexo para que o problema físicopossa ser solucionado analiticamente. Advém disso a necessidade de introduzir aproxi-mações à formulação numérica, as quais permitam escrever as equações em um formatopossível de ser resolvido por rotinas computacionais (Aziz & Settari, 1979).
Maliska (2004) aﬁrma que a tarefa do método numérico é resolver um conjunto deequações diferenciais, substituindo as derivadas por expressões algébricas que envolvama função incógnita. Nesse procedimento, obtém-se a solução do problema para um nú-mero discreto de pontos, com um determinado erro. Se o método adotado for consistente,quanto maior o número de pontos, mais perto da solução exata estará a solução aproxi-mada.
Este capítulo é dedicado à apresentação dos método numéricos adotados na soluçãodo modelo bifásico implementado. Serão apresentados o método dos volumes ﬁnitos ba-seado em elementos, as discretizações das equações conservativas e as formulações ado-tadas para resolver o conjunto de equações.
3.1 MÉTODO DOS VOLUMES FINITOS BASEADO EM ELEMENTOSAtribui-se o desígnio de Método dos Volumes Finitos (FVM) a qualquer método numé-rico que satisfaz a conservação da propriedade em níveis elementares no processo de ob-tenção das equações aproximadas (Maliska, 2004).
A abordagem frequentemente adotada para deduzir as equações conservativas con-siste em realizar um balanço de uma determinada propriedade em um volume de controlepertencente ao domínio do problema. O procedimento de fazer esse volume tender a zerofornece as equações diferenciais. Ao invés de utilizá-las diretamente, o Método dos Volu-mes Finitos emprega as equações prévias de balanço. Isso assegura o caráter conservativodo método.
Ressalta-se que muitos dos balanços não são facilmente deduzidos – e.g. para volumesde controle irregulares. Disso provém a preferência por obter as equações discretizadasatravés da integração das equações diferenciais, visto que integrar a forma conservativa ou37divergente da equação diferencial e fazer um balanço da propriedade são procedimentosequivalentes (Maliska, 2004).
O Método dos Volumes Finitos baseado em Elementos (EbFVM) é um Método dos Volu-mes Finitos que explora alguns conceitos provenientes do Método dos Elementos Finitos(FEM) a ﬁm de prover maior ﬂexibilidade geométrica e possibilidade de reﬁnos localiza-dos de malha. Por conseguinte, consegue-se alcançar elevada acurácia de representaçãodo domínio mantendo a característica fundamental do método dos volumes ﬁnitos – o ca-ráter conservativo (Hurtado, 2011). A formulação adotada permite empregar triângulos equadriláteros em malhas bidimensionais; hexaedros, tetraedros, prismas e pirâmides, emmalhas tridimensionais. Essas malhas são não-estruturadas, o que signiﬁca que não há umpadrão que possa descrever a conﬁguração dos vizinhos de um dado elemento (Maliska,2004). O potencial de discretização geométrica de malhas não-estruradas está ilustrada naﬁgura 3.1, a qual ilustra uma malha de 36950 elementos no formato aproximado do terri-tório brasileiro.
Figura 3.1: Potencial geométrico da malha não-estruturadaFonte: do autor383.1.1 ENTIDADES GEOMÉTRICAS DA MALHAA ﬁm de caracterizar completamente uma malha associada a um determinado domí-nio, deve-se deﬁnir o que é uma malha e descrever as entidades que a compõem. Umamalha(cid:77) é a coleção de elementos ei tais que para um domínio fechado Ω tem-seΩ = (cid:91) =(cid:11)Inte je∈(cid:77) e .
(3.1)
Int(ei )(cid:92)Cada e deve possui um interior não vazio. Ainda, deve-se satisfazer∀ i (cid:54)= j.
(3.2)
Isto é, a interseção dos interiores dos elementos deve ser um conjunto vazio (Hurtado,2011). De forma mais simples, pode-se aﬁrmar que os elementos devem cobrir comple-tamente o domínio sem que ocorra superposição ou espaços vazios.
As superfícies que delimitam os elementos são chamadas de facetas. Tratam-se dearestas em elementos 2D e superfícies, em 3D. Cada faceta que não esteja no contornodo domínio é necessariamente compartilhada por dois elementos. Isso signiﬁca que não épossível contato parcial entre as facetas e por conseguinte, a malha é conforme (Hurtado,2011).
As faces dos elementos bidimensionais são deﬁnidas como os segmentos que conec-tam os pontos médios das arestas ao centroide do elemento. A deﬁnição para o caso tri-dimensional é análoga. Essas faces subdividem o elemento em porções denominadas su-belementos, os quais estão associados a duas das faces do elemento – com exceção do ele-mento tridimensional pirâmide, no qual cada subelemento pode estar associado a quatrofaces do elemento.
O campo de uma variável do modelo diferencial é aproximado no EbFVM pelos valo-res discretos em locais coincidentes com os vértices dos elementos da malha, denomina-dos nós. A ﬁgura 3.2 ilustra as principais entidades de uma malha para o elemento maissimples: o triângulo. As deﬁnições para os demais elementos são similares e podem serencontradas em (Hurtado, 2011).
A construção do volume de controle se dá a partir dos elementos dispostos ao redordos nós, conforme ilustrado na ﬁgura 3.3. Logo, a superfície de controle é composta porfaces de elementos.
39Figura 3.2: Principais entidades de um elemento triangularFonte: do autorEm virtude da disposição geométrica, é conveniente que propriedades físicas tais comoporosidade e permeabilidade sejam homogêneas no domínio de um elemento. Assim, nãoascende necessidade de adotar qualquer esquema de interpolação a ﬁm de avaliá-los nasuperfície do volume de controle (Cordazzo, 2006).
Figura 3.3: Construção do volume de controleFonte: do autor3.1.2 ABORDAGEM NUMÉRICAA estratégia adotada a ﬁm de lidar com a distorção geométrica dos elementos contidosem uma malha não estruturada é uma transformação denominada mapeamento. Trata-sede uma função bijetora por meio da qual os pontos no espaço físico são representados naforma de elementos regulares em espaços transformados (Hurtado, 2011).
40Nesse procedimento, um ponto deﬁnido em coordenadas globais – (x , y ) no caso bi-dimensional – passa a ser descrito em termos de coordenadas locais – (ξ, η). A ﬁgura 3.4
ilustra o mapeamento de um elemento triangular para o espaço transformado. Conformeserá veriﬁcado posteriormente, essa transformação facilita a discretizações das equaçõesmodelo.
Figura 3.4: Mapeamento para um espaço transformadoFonte: do autorO mapeamento das coordenadas locais para as globais é realizado empregando fun-ções de forma de primeira ordem oriundas do Método dos Elementos Finitos. Para cadavértice i pertencente a um elemento, há uma função de forma Ni , a qual assume valor 1em i e 0 em todos os outros vértices. Sendo assim, cada ponto p = (x , y , z ) pode ser repre-sentado segundo a expressãonv(cid:88)p =Ni (ξ, η, ζ) pi ,(3.3)
i =1em que pi , i = 1,...,nv , representam os vértices dos elementos; nv , o número de vértices e(ξ, η, ζ), as coordenadas locais de P .
As funções de forma devem ser contínuas, diferenciáveis e partições da unidade, denv(cid:88)forma que sejam valores positivos e satisfaçam a equaçãoNi (ξ, η, ζ) = 1.
(3.4)
i =1para qualquer ponto (ξ, η, ζ) no sistema local de coordenadas Zienkiewicz & Taylor (2000).
Seja ψ uma função deﬁnida nos nós de uma malha. O EbFVM propõe que o valor de ψnv(cid:88)dentro do elemento seja dado pela relaçãoψ(x , y , z ) =Ni (ξ, η, ζ) ψi .
(3.5)
i =1Portanto, o valor de ψ dentro do elemento é uma média ponderada de seus valores nos41vértices do elemento e o peso dessa média é dado pela função de forma.
Uma vez que funções de forma são diferenciáveis, o gradiente de ψ no sistema de co-∂x Ni ψi Ψe ,ordenadas global pode ser expresso conforme∇ψ =∇ nv(cid:88)nv(cid:88)=Ni (ξ, η, ζ) ψi∂y Ni∂z Ni··· ∂x Nnv··· ∂y Nnv··· ∂z NnvTi =1i =1∂x N1 ∂x N2Ψe =⇒∇ψ =∂y N1 ∂y N2∂z N2∂z N1(3.6)
em que... ψnvψ1 ψ2(3.7)
é um vetor com os valores de ψ nos nós do elemento.
As funções de forma, contudo, são usualmente dadas em termos das coordenadas lo-cais e, por conseguinte, utilizar as derivadas de Ni com respeito às coordenadas globais éinconveniente. Aplicando a regra da cadeia:∂ξNi =∂ξx∂ξx∂ξN1 ∂ξN2∂x Ni.
∂ξ y∂ξz∂ηNi∂ζNi∂ηx ∂η y∂ηz∂y Ni∂z Ni(3.8)
∂ζ y∂ζx∂ζzA matriz J dada por∂ξ y∂ξzJ =∂ηx ∂η y∂ηz(3.9)
∂ζx∂ζ y∂ζzé a matriz Jacobiana. Seu cômputo pode ser realizado através da equação (3.3) Hurtado,(2011). Deﬁnindo a matriz··· ∂ξNnv··· ∂ηNnv··· ∂ζNnvD ≡∂ηN1 ∂ηN2∂ζN1 ∂ζN2(3.10)
42pode-se elucidar a equação (3.6) no formato∇ψ = J−1D Ψe .
(3.11)
−1D pode ser considerada como um operador gradiente discreto (Grein, 2015).
A matrix J3.1.3 DISCRETIZAÇÃO DE UMA EQUAÇÃO DE CONSERVAÇÃO DE UMA VARIÁ-VEL GENÉRICAMaliska (2004), propõe que a equação de conservação de uma propriedade genérica ψρψ +∇·ρuψ =∇·Γ∇ψ + F,associada a um escoamento seja escrita na forma∂∂ t(3.12)
em que ρ é a massa especíﬁca, u é a velocidade do ﬂuido, Γ é um coeﬁciente difusivo e F ,um termo fonte associado à propriedade conservada. Na equação (3.12), o primeiro termoé o de acumulação; o segundo, advectivo; o terceiro, difusivo; o quarto, o termo fonte.
A ﬁm de realizar discretização da equação (3.12), realiza-se uma integração dessa equa-ção para cada volume de controle. Almejando a clareza dos procedimentos, cada termoapresentado na equação (3.12) será discretizado separadamente. Considera-se um volumede controle arbitrário P – vide ﬁgura 3.3 – e uma malha ﬁxa.
A discretização do termo de acumulação se dá utilizando a formulação totalmente im-(cid:90)(cid:90)ρψ dV =MPψPMPψP≈ ∂,plícita (Maliska, 2004):∂∂ t∂∂ t∂∂ tρψ dV =(3.13)
∂ tPPem que MP é massa contida no volume P e ψP é média do valor de ψ em P. Essa média é,no Método dos Volumes Finitos, aproximada pelo valor da propriedade no nó. Essa apro-ximação é razoável, pois que o nó se localiza, geralmente, próximo ao centro do volume decontrole.
(cid:90)A discretização do termo fonte é similar:F dV ≈ FPVP,(3.14)
PO termo de transporte advectivo é discretizado por meio da aplicação do Teorema da43(cid:90)(cid:90)(ρu· ˆn)ψ dA ≈(cid:88) ψf =(cid:88)∇·ρuψ dV =ρu· ∆AfDivergência de Gauss:˙m f ψf ,(3.15)
ff∂ PPem que o índice f representa a face do volume de controle; ∂ P , seu contorno; ∆Af o vetorárea associado à face f e ˙m f o ﬂuxo de massa que a atravessa. O valor da propriedade ψfna face no centro da face é calculado a partir de algum método de iterpolação, como CDSou UDS.
Por ﬁm, parte-se à discretização do termo difusivo – o último termo da equação (3.12).
A discretização desse termo é similar àquela realizada para o termo advectivo. Novamente,lança-se mão do Teorema da Divergência de Gauss e da deﬁnição do operador gradiente(cid:90)(cid:90)(Γ∇ψ)· ˆn dA ≈(cid:88)∇·Γ∇ψ dV =(Γ∇ψ)f · ∆Af =Γ J· ∆Af .
discreto – equação (3.11) – para obter−1D Ψe(3.16)
f∂ PPInfere-se das equações discretizadas que as equações discretizadas envolvem, além dopróprio nó associado a P, os nós que compartilham um elemento com o nó P. Sendo assim,esse é o estêncil associado ao EbFVM.
Matematicamente, se(cid:69) P é o conjunto dos elementos que compartilham o nó P e(cid:78) e ,o conjunto dos nós associados ao elemento e , então o estêncil(cid:83) P é dado por(cid:83) P = (cid:91)(cid:78) e .
(3.17)
e∈(cid:69) PGraﬁcamente, a ﬁgura 3.5 exibe em preto os nós, os quais em conjunto, compõem oestêncil associado ao nó P.
Figura 3.5: Estêncil associado ao nó PFonte: adaptado de (Grein, 2015)443.2 EQUAÇÕES DISCRETIZADASEmpregando o procedimento de discretização exposto anteriormente, obtém-se a equa-ção de conservação da massa das fases água e óleo para um dado volume de controle P damalha, as quais sãoold +(cid:88)old +(cid:88)−S w−S o−λw KJ−λo KJ· ∆Af = q w· ∆Af = q o−1D ΦeφP∆VP∆VP,S wP(3.18)
∆te∈(cid:69) PPP−1D ΦeφP∆VP∆VP,S oP(3.19)
∆te∈(cid:69) PPPem que o índice superior old indica o valor da propriedade no passo de tempo anterior, Φeé um vetor com os valores de Φ nos nós do elemento e e(cid:69) P é o conjunto de elementos quecompartilham o nó P.
Em conjunto com a equação de restrição volumétrica equação (2.17) tem-se três equa-ções para as três variáveis primárias: P , S w e S o .
Esse conjunto de equações pode ser, ainda, manipulado algebricamente para que osistema de equações seja resolvido de forma mais conveniente. Somando a equação (3.18)
(cid:88)−λt KJ· ∆Af = q tq t =q w + q oà equação (3.19) e substituindo a equação (2.17) chega-se à conservação da massa global,dada por−1D Φe∆VP,(3.20)
e∈(cid:69) PPem queλt = (λw + λo )e(3.21)
são, respectivamente, mobilidade e termo fonte totais.
As equações a serem resolvidas são as equações de conservação da massa da água –equação (3.18)– e a equação de conservação da massa global – equação (3.20). Assim, háduas equações para duas variáveis primárias – S w e P . A pressão pode ser obtida a partirdo potencial por meio da expressãoΦ = P − ρG .
(3.22)
Já a saturação do óleo pode ser calculada por meio da equação (2.17). Em virtude de sua re-lação estreita com a implementação computacional, a construção do sistema de equaçõesserá explicado apenas no capítulo subsequente.
453.3 FORMULAÇÕES IMPES E SEQUENCIALO método IMPES (IMplicit Pressure Explicit Saturation), em sua formulação clássica,fundamenta-se na divisão do sistema acoplado de equações em sistemas de equações dis-tintos para pressão e saturação, os quais são resolvidos de forma implícita e explícita, res-pectivamente. O cálculo explícito da saturação acarreta menor custo computacional, eestabilidade condicionada a pequenos passos de tempo (Chen, 1962).
(cid:88)old +−λt KJ−1D Φe(cid:88)· ∆Af = q t−λw KJAs equações associadas ao cálculo implícito de P e explícito de S w são, respectiva-mente:∆VP,=S w· ∆Af − ∆t q w(3.23)
e∈(cid:69) PP−1D Φe∆tPφPS wP.
(3.24)
φP∆VPe∈(cid:69) PPO procedimento iterativo para determinar as variáveis primárias do problema atravésdo IMPES clássico é:1. Especiﬁcar os valores inciais das variáveis primárias – P e S w – em todos os volumesde controle da malha;2. Calcular as mobilidades em todos os volumes de controle da malha;3. Interpolar as mobilidades nas faces dos elementos;4. Resolver o sistema linear da equação da pressão – equação (3.23);5. A partir da solução obtida para a pressão, calcular a saturação da água explicitamente– equação (3.24)
6. Avançar a solução no tempo e retornar ao item 2 até atingir a simulação do tempototal desejado.
O método sequencial calcula as variáveis primárias de modo similar. Neste caso, con-tudo, após o passo 5, retorna-se ao 2 até que os campos de pressão e saturação mudemmenos que uma dada tolerância.
463.4 FORMULAÇÃO TOTALMENTE IMPLÍCITANo método totalmente implícito ou FIM (Fully Implicit Method) as váriaveis são re-solvidas de maneira concomitante. Trata-se da formulação mais estável e robusta para asimulação de reservatórios. Apresenta limitações de passo de tempo menos restritivas emrelação aos esquemas que linearizam o acoplamento entre pressão e saturação, como éfeito no método IMPES (IMplicit Pressure, Explicit Saturation). (Chen, 1962).
3.4.1 MÉTODO DE NewtonQuanto à aplicação do FIM, faz-se necessário o emprego de um solver não linear paraa resolução do sistema de equações. No intuito de resolver esse sistema, foi adotado ométodo de Newton contido na biblioteca PETSc (Portable, Extensible Toolkit for ScientiﬁcComputation). As rotinas implementadas nessa biblioteca são eﬁcientes e têm suportepara a resolução dos problemas em paralelo (Balay et al., 2009). Antes de utilizar a PETSc,contudo, as equações devem ser preparadas à aplicação do método de Newton.
A ideia fundamental desse método é mais simples de ser entendida no caso unidimen-sional, no qual deseja-se determinar, de forma iterativa, as raízes de uma função a partir deuma estimativa inicial. Calcula-se a reta tangente à função no ponto associado à estima-tiva. Determina-se, então, a interseção dessa reta tangente com o eixo das abcissas a ﬁmde encontrar uma melhor aproximação para a raiz. Repetindo esse procedimento, tem-seum método iterativo que pode ser utilizado para estimar a raíz de uma função. Matemati-camente, o método de Newton para funções de uma variável é representado porxn+1 = xn − f (xn)f (cid:48)(xn),(3.25)
(cid:48)(xn) é a derivada da função f em xn. Esse procedi-em que n indica a n-ésima iteração e fmento iterativo está ilustrado e descrito na ﬁgura 3.6.
47Figura 3.6: Método de Newton para funções de uma variávelFonte: do autorNo caso de funções de múltiplas variáveis – caso deste trabalho –, o método de New-ton apresentado para uma única variável deve ser expandido a uma forma mais genérica.
Nessa, são resolvidas, simultaneamente, raízes de várias funções, as quais são denomina-das resíduos. As equações resíduo associadas às equações de conservação discretizadassãoold +(cid:88)−S wR t =(cid:88)−λt KJ−λw KJ· ∆Af − q t· ∆Af − q w−1D ΦeφP∆VPR w =∆VP,S wP(3.26)
∆te∈(cid:69) PPP−1D Φe∆VP,(3.27)
e∈(cid:69) PPuma vez que as raízes dessas funções consistem na solução do sistema de equações. Nasequações 3.26 e 3.27 o símbolo R w denota o resíduo associado à conservação da massa daágua e R t , da conservação da massa total. Ambos os resíduos são funções da saturação daágua S w e da pressão P , as quais constituem as variáveis primárias do problema.
48O procedimento iterativo utilizado no intuito de determinar essas variáveis primáriasestá listado a seguir:1. Construir um vetor X com as estimativas das variáveis primárias – P e S w – em todosos volumes de controle da malha;2. Calcular as propriedades e as mobilidades em todos os volumes de controle da ma-lha;3. Interpolar as mobilidades nas faces dos elementos;4. Computar os resíduos de cada equação – R w e R t – em todos os volumes de controleda malha;5. Computar as derivadas parciais dos resíduos em cada nó através da expansão emsérie de Taylor truncadaa= R i (X + dX )− R i (X )∂ R i∂ X;(3.28)
dX6. Resolver o sistema linearJ ∆X =−R;(3.29)
em que J é a matriz jacobiana, contendo todas as derivadas parciais dos resíduos emtodos os volumes; ∆X, o vetor com as correções a serem aplicadas às estimativas e R,o vetor contendo os resíduos correspondentes às estimativas;7. Corrigir o valor das variáveis contidas em X por meio da equaçãoXk+1 = Xk + ∆X;(3.30)
8. Retornar ao item 2 e iterar até que seja atingida a convergência;9. Retornar ao item 2 e avançar a solução no tempo até a simulação do tempo totaldesejado.
Assim, todas as variáveis são resolvidas de forma implícita, e, portanto, podem ser uti-lizados passos de tempo signiﬁcativamente maiores àqueles utilizados em métodos queapresentam algum caráter explícito Aziz & Settari (1979).
aRessalta-se que os resíduos são funções de S w e P , de forma que a derivada numérica em relação a Xdeve levar em conta a contribuição dessas duas variáveis. A forma por meio da qual essas contribuições sãoconsideradas serão detalhadas posteriormente.
49No capitulo ulterior, destinado ao tema implementação computacional, procedimen-tos tais como a construção da matriz jacobiana serão mais bem detalhados.
504IMPLEMENTAÇÃO COMPUTACIONALConquanto as fases de modelagem matemática e numérica detenham papeis funda-mentais à acurácia com a qual o fenômeno físico é representado, é por meio da implemen-tação computacional que se obtêm os resultados concretos através da simulação numéricado problema. Maliska (2004) aﬁrma que o desenvolvimento de um bom programa com-putacional requer a harmonia entre o uso das ferramentas computacionais disponíveis, aestratégia de depuração dos erros e a ulterior interpretação correta dos resultados.
Este capítulo se destina à descrição de alguns aspectos relacionados à implementaçãocomputacional. Também proporciona uma visão geral do simulador do ponto de vista deprogramação. Isso facilita o entendimento da forma por meio da qual o conjunto de dadosfísicos foi tratado e da inter-relação entre cada módulo implementado. A possibilidadede adquirir essa visão é importante, pois que estreita o caminho entre a percepção de umfenômeno físico e a capacidade de obter algum resultado a partir das equações abstratasque o modelam.
Primeiramente, as metodologias IMPES e totalmente implícita serão explicadas do pontode vista de implementação. Posteriormente, será explicado um esquema de passo de tempoadaptativo implementado a ﬁm de reduzir o esforço computacional de ambas as formula-ções.
4.1 MÉTODOS IMPES E SEQUENCIALO método IMPES, conforme já discutido anteriormente, é mais simples e direto doponto de vista de implementação, quando comparado ao método totalmente implícito.
Esta seção de destina ao esclarecimento da abordagem computacional utilizada para ob-ter a solução do problema. Primeiramente, será exposta a estrutura geral do simulador.
A seguir, serão brevemente descritos os procedimentos de cálculo implícito da pressão eexplícito da saturação. Para mais detalhes quanto ao tratamento numérico do modelo pormeio do método dos volumes ﬁnitos baseado em elementos, consultar Hurtado (2011).
514.1.1 ESTRUTURA GERAL DO SIMULADORA simulação do escoamento bifásico por meio da formulação IMPES é fundamentadoem uma classe denominada Simulator. Essa classe é responsável por administrar a reso-lução implícita da pressão por meio da classe TwoPhasePressureComputer e pelo cálculoexplícito da saturação, por meio da classe WaterSaturationComputer. Ainda há classesderivadas das classes abstratas Event e Controller, as quais são, respectivamente, desti-nadas à execução de eventos – e.g. avanço no tempo e exportação de dados – e controle dasimulação – e.g. veriﬁcar convergência e chegada ao tempo ﬁnal de simulação. A relaçãoentre essas classes está ilustrada esquematicamente na ﬁgura 4.1.
Figura 4.1: Classes responsáveis pela simulação pelo método IMPESFonte: do autor4.1.2 CÁLCULO IMPLÍCITO DA PRESSÃOO cálculo implícito da pressão consiste em resolver o sistema linear constituído pelasequações de conservação da massa total para cada nó da malha. A equação para o nó P édada por(cid:88)−λt KJ· ∆Af = q t−1D Φe∆VP.
(4.1)
e∈(cid:69) PPA ﬁm de adicionar os termos da equação (4.1) à matriz do sistema linear da pressão semexecutar procedimentos duplicados, procede-se conforme o pseudocódigo representadona listagem 4.1. A estrutura ﬁnal da matriz do sistema linear está ilustrada, para uma malhabidimensional simples, na ﬁgura 4.2.
52Figura 4.2: Exemplo de estrutura da matriz do sistema linear da pressãoFonte: modiﬁcado de (Hurtado, 2011)53Listagem 4.1: Pseudocódigo da rotina que resolve o sistema linear da pressão1 PARA todos os elementos da malhaPARA todas as faces do elemento2PARA todos os nós do elemento3calcular contribuição do nó no ﬂuxo difusivo4adicionar contribuição às equações referentes aos nós atrás ...
5... e à frente da face6FIM PARA7FIM PARA89 FIM PARAJá o termo do lado direito da equação (4.1) é adicionado diretamente ao termo inde-pendente, por meio de uma varredura dos nós do poço ou da fronteira com condição decontorno do tipo Neumann. Caso a condição de contorno seja do tipo Dirichlet as linhasda equação dos nós da fronteira são zeradas, exceto a entrada da diagonal principal, à qualé atribuído o valor 1. Ao termo independente é, então, atribuído o valor prescrito. Dadasas montagens da matriz e do termo independente, tem-se o sistema linear, do qual sãocalculadas as pressões para um determinado passo de tempo.
4.1.3 CÁLCULO EXPLÍCITO DA SATURAÇÃOO cálculo explícito da saturação é dado a partir dos valores de pressão calculados im-(cid:88)· ∆Af − ∆t q w−λw KJ=S wold +plicitamente para o passo de tempo em questão. A equação resolvida explicitamente é−1D Φe∆tPφPS wP.
(4.2)
φP∆VPe∈(cid:69) PPA maneira de construir a equação explícita é análoga àquela relativa ao sistema linear.
Nesse caso, contudo, não há necessidade de montar a matriz com essas contribuições, poisque os valores de pressão são conhecidos e pode-se efetuar o somatório presente na equa-ção (4.2) diretamente.
544.2 MÉTODO TOTALMENTE IMPLÍCITOO método totalmente implícito é mais laborioso tanto do ponto de vista de formulaçãoquanto de implementação. Há de se atentar para diversos detalhes referentes não somenteao método numérico em si, mas também aos aspectos computacionais envolvidos em suaconcepção. Esta seção se destina ao esclarecimento da abordagem computacional utili-zada para obter a solução do problema. Primeiramente, será exposta a estrutura geral dosimulador. A seguir, serão detalhados os procedimentos de cálculo dos resíduos e contru-ção da matriz jacobiana.
4.2.1 ESTRUTURA GERAL DO SIMULADORA simulação do escoamento bifásico por meio da formulação totalmente implícita éfundamentado em uma classe denominada TwoPhaseFlowComputer. Essa classe é res-ponsável por administrar a resolução do sistema não linear, a qual é efetuada com o su-porte da biblioteca PETSc (Balay et al., 2013). Para isso, a TwoPhaseFlowComputer pos-sui classes responsáveis por calcular as mobilidades (MobilityCalculator); montar osresíduos (ResidualsAssembler); montar a matriz jacobiana (JacobianAssembler) eexportar a solução numérica de forma que essa possa ser visualizada convenientemente(TwoPhaseFlowExporter). A relação entre essas classes está ilustrada esquematicamentena ﬁgura 4.3.
Figura 4.3: Classes responsáveis pela simulação pelo método FIMFonte: do autorA classe TwoPhaseFlowComputer contém a função responsável pela resolução do sis-tema não linear, a qual está representada em pseudocódigo na listagem 4.2. As opera-55ções executadas nas linhas 2 e 3 da listagem são executadas, respectivamente, pelas classesResidualsAssembler e JacobianAssembler. A linha 6, por sua vez, se refere ao passode tempo adaptativo já explicado anteriormente.
Listagem 4.2: Pseudocódigo da rotina que resolve o sistema não linear1 Alocar memória para o vetor de resíduos2 Alocar memória para a matriz jacobiana3 REPETIRResolver o sistema não linear utilizando a PETSc ...
4...( informando à biblioteca a implementação própria das funções ...
5... de montagem do vetor de resíduos e da matriz jacobiana)6SE convergência atingida e saturação consistente ENTÃO7Ajustar passo de tempo8Avançar a solução no tempo9SE NÃO10Ajustar passo de tempo11FIM SE1213 ENQUANTO tempo ﬁnal atingido4.2.2 CÁLCULO DOS RESÍDUOSA ﬁm de facilitar a indexação das variáveis, optou-se por dispô-las de forma que a sa-turação e a pressão de um dado volume de controle consistam em entradas adjacentes dovetor de resíduos. A classe ResidualsAssembler dispõe de uma função que calcula osresíduos R w e R t e já os adiciona nas posições corretas do vetor resíduo. Essa adição é feitapor etapas nas quais são calculados os termos difusivo, acumulativo e fonte denotados,respectivamente, por αdif, αac e αfon nas equações a seguir:(cid:125)(cid:124)(cid:123)old+(cid:122)(cid:122)(cid:88)(cid:125)(cid:124)−λw KJ−1D Φe(cid:123)(cid:122) (cid:125)(cid:124) (cid:123)· ∆Af − αw−S wαwacαwdiffonφP∆VPR w =∆VP .
S wPq wP(4.3)
∆te∈(cid:69) PP56(cid:122)(cid:88)(cid:125)(cid:124)−λt KJ−1D Φe(cid:123)(cid:122) (cid:125)(cid:124) (cid:123)· ∆Af − αtαtdiffonR t =∆VP,q tP(4.4)
e∈(cid:69) PA função responsável por esses cálculos está representada em pseudocódigo na listagem4.8. As quatro subrotinas chamadas na listagem 4.8 serão explicadas nos itens a seguir.
Listagem 4.3: Pseudocódigo da rotina que computa os resíduos1 CHAMA função que adiciona o termo difusivo2 CHAMA função que adiciona o termo acumulativo3 CHAMA função que adiciona termo fonte4 CHAMA função que aplica condições de contornoADIÇÃO DO TERMO DIFUSIVO A adição dos termo difusivos correspondentes às equações=(cid:88)=(cid:88)−λw KJ−λw KJ· ∆Af· ∆Af ,de conservação da massa da água e global,−1D Φe−1D Φeαwdifαte(4.5)
e∈(cid:69) Pe∈(cid:69) Pdiffoi implementada de forma que não fossem realizados cálculos e procedimentos duplica-dos. A listagem 4.4 contém o pseudocódigo da função que executa essa operação.
Listagem 4.4: Pseudocódigo da rotina que adiciona o termo difusivo nos resíduos1 PARA todos os elementos da malhaPARA todas as faces do elemento2calcular ﬂuxo difusivo de água3calcular ﬂuxo difusivo total4adicionar ﬂuxos nas equações referentes aos volumes de controle ...
5... separados pela face6FIM PARA78 FIM PARA57Ressalta-se que as mobilidades λw e λt devem ser avaliadas nas faces. Tendo em vistaque a mobilidade é função de variáveis primárias armazenadas nos nós, essas são primei-ramente avaliadas nos nós. Posteriormente, esses valores são interpolados a ﬁm de deter-minar as mobilidades na face do volume de controle. Essa interpolação foi realizada peloesquema upwind, o qual tem relação direta com o termo parabólico da equação, i.e., o valorda função na interface é igual ao valor do volume de controle a montante (Maliska, 2004).
 λpMatematicamente, tem-sese Vp · ∆Af (cid:190) 0 ;se Vp · ∆Af < 0 ,=nBλpnFλpf(4.6)
onde nB e nF indicam os nós atrás e a frente da face, conforme mostrado na ﬁgura 4.4.
Figura 4.4: Esquema de interpolação upwind em elemento triangularFonte: do autorADIÇÃO DO TERMO ACUMULATIVO A função que adiciona o termo acumulativo da equa-old−S wção da conservação da massa da água,φP∆VP=αwacS wP,(4.7)
∆tPpor sua vez, é mais direta e está representada na listagem 4.5. Tendo em vista que essetermo não necessita interpolações e cálculos envolvendo outras entidades além dos nós,pode-se varrer os nós da malha diretamente. Ressalta-se, pois, que esse termo deve seradicionado apenas à equação da conservação da massa da água, porquanto a equação derestrição volumétrica cancela esse termo na equação de conservação da massa totala.
aEssa simpliﬁcação só se aplica em caso de escoamento incompressível.
58Listagem 4.5: Pseudocódigo da rotina que adiciona o termo acumulativo nos resíduos1 PARA todos os nós da malhacalcular termo acumulativo2adicionar termo na equação de conservação da massa da água34 FIM PARAADIÇÃO DO TERMO FONTE A função que adiciona os termos fontes correspondentes àsequações de conservação da massa da água e global,= q w= q tP,αwfonαte(4.8)
Pfonveriﬁca os poços localizados ao longo da malha, e, a partir da informação sobre sua ope-ração – pressão constante ou vazão constante – adiciona o valor adequado ao resíduo dasequações associadas aos volumes de controle nos quais os poços se encontram. Tendo emvista que esse termo não necessita interpolações e cálculos envolvendo outras entidadesalém dos nós, pode-se varrer os nós da malha diretamente e adicionar os termos fonte. A
função responsável por adicioná-los aos resíduos está representada em pseudocódigo nalistagem 4.6.
qpoço = λp WIPP− Ppoço,A vazão nos poços cuja condição de operação é pressão prescrita é calculada por meioda equação(4.9)
em que qpoço é a vazão da fase p no sentido reservatório-poço, WI é o well index ou índicede poço, PP é a pressão no nó P do reservatório e Ppoço é a pressão de fundo de poço. Nestetrabalho, o índice de poço foi calculado realizando uma adaptação do modelo de Peace-man (1978), utilizando a expressão req,WI = 2πKh(4.10)
lnrpoçoem que h é o comprimento do poço, rpoço é o raio do poço e req é o raio equivalente, o qualnesse trabalho foi calculado como metade do diâmetro hidráulico do volume de controleassociado ao poço por meio da equaçãoreq = Volume do volume de controle associado ao poçoÁrea da superfície de controle associada ao poço.
(4.11)
59Listagem 4.6: Pseudocódigo da rotina que adiciona o termo fonte nos resíduos1 PARA todos os poços da malhaSE poço opera com pressão constante2calcula vazão no poço a partir de sua pressão de operação3adiciona vazão às equações dos volumes de controle do poço4FIM SE5SE poço opera com vazão constante6adiciona vazão às equações dos volumes de controle do poço7FIM SE89 FIM PARAAPLICAÇÃO DAS CONDIÇÕES DE CONTORNO Quanto à imposição das condições de con-torno, optou-se por considerar condições de Neumann e Dirichlet. Quanto à imposição deﬂuxo prescrito – condição de contorno de Neumann – preferiu-se prescrever velocidade, aﬁm de que o problema a ser resolvido ﬁcasse independente da malha utilizada.
Ressalta-se que em malhas não estruturadas tanto a face quanto o nó nos quais sãoprescritas condições de Neumann e Dirichlet, respectivamente, estão localizados sobre ocontorno. Essa conﬁguração geométrica pode ser visualizada na ﬁgura 4.5, em que estáilustrado um volume de controle adjacente ao contorno. É importante ressaltar que o vo-lume de controle associado ao nó P é interior ao domínio, ao passo que o nó está sobre afronteira.
A condição de Neumann é imposta diretamente fazendo, nas equações (4.3) e (4.4),
= q w= q tP,αwfonαte(4.12)
Pfon= (cid:88)= (cid:88)em que q wP e q tP são as vazões volumétricas de água e total, obtidas através de(V w + V o )∆Abf,V w ∆Abfq wPq tPe(4.13)
bf∈ (cid:70)bbf∈ (cid:70)bPPem que (cid:70)bP é o conjunto de faces que formam a parte da superfície de controle associadaao nó P que está localizada sobre a fronteira e bf são as faces contidas nesse conjunto. Já
V w e V t são as velocidades de água e total prescritas, respectivamente.
No caso de condição de contorno de Dirichlet, elimina-se a equação da variável co-60Figura 4.5: Volume de controle adjacente ao contornoFonte: modiﬁcado de (Maliska et al., 2015)nhecida e, em seu lugar, insere-se apenas o valor unitário na diagonal principal da matrizjacobiana. O resíduo, por sua vez, recebe o valor zero.
O pseudocódigo da função destinada à aplicação das condições de contorno está re-presentada por meio de pseudocódigo na listagem 4.7. A face de contorno mencionadano algoritmo é uma entidade da fronteira, a qual está ilustrada na ﬁgura 4.5 juntamente àsoutras entidades das fronteiras da malha.
Listagem 4.7: Pseudocódigo da rotina que aplica as condições de contorno nos resíduos1 PARA todas as fronteiras com condição de contorno do tipo NeumannPARA todos os elementos da fronteira2PARA todas as faces do elemento3adicionar ﬂuxo prescrito na equação do nó associado ...
4... à face de contorno5FIM PARA6FIM PARA78 FIM PARA9 PARA todas as fronteiras com condição de contorno do tipo DirichletPARA todos os nós da fronteira10adicionar zero nas equações do nó11FIM PARA1213 FIM PARA614.2.3 CONSTRUÇÃO DA MATRIZ JACOBIANAO cálculo da matriz jacobiana é a parte mais custosa e complexa dos algoritmos desolução de sistemas não lineares. Ainda, sua construção é diferenciada em se tratando dométodo dos volumes ﬁnitos baseado em elementos, pois que esse método se fundamentaem varreduras nos elementos da malha computacional.
Um aspecto relevante do processo de montagem da matriz jacobiana é sua estrutura,a qual deve ser compativel àquela associada ao vetor resíduo. Uma vez que a indexação devariáveis se deu de forma que as equações de conservação da massa da água e total de umdeterminado volume de controle fossem adjacentes, tem-se:∂ R w1∂ S1∂ R t1∂ S1...
∂ R wn∂ S1∂ R tn∂ S1∂ R w1∂ P1∂ R t1∂ P1...
∂ R wn∂ P1∂ R tn∂ P1∂ R w1∂ Sn∂ R t1∂ Sn...
∂ R wn∂ Sn∂ R tn∂ Sn∂ R w1∂ Pn∂ R t1∂ Pn...
∂ R wn∂ Pn∂ R tn∂ Pn∆S1∆P1...
R w1R t1...
...
=−...
...
,(4.14)
∆SnR wn...
∆PnR tn...
= RP(x j + ∆x j )− RP(x j )em que∂ RP∂ x j.
(4.15)
∆x jNa equação (4.15), P é o volume de controle em que se deseja calcular a derivada e RPé o resíduo, o qual pode ser associado à equação de conservação da massa da água ou totaldo nó P. Já x j é a variável em relação à qual a derivada é calculada. Ressalta-se que x j éum componente do vetor solução, o qual possui tanto S w quanto P em suas entradas, i.e.,
a variável x j representada na equação (4.15) pode ser tanto saturação quanto pressão.
Quanto à estrutura da matriz, pode-se veriﬁcar que cada linha é composta pelas deri-vadas de uma única equação do resíduo, ao passo que cada coluna contém as derivadas emrelação a uma única variável. Ademais, a equação (4.14) consiste na equação (3.29) com oscoeﬁcientes explicitados.
Na ﬁgura 4.6 pode-se visualizar um exemplo de estrutura da matriz jacobiana. É inte-ressante notar que a estrutura da matriz do sistema linear da pressão no método IMPES,representada na ﬁgura 4.2 é semelhante àquela associada à matriz jacobiana e exposta naﬁgura 4.6. Esta última, contudo, é composta por blocos – matrizes 2x2 nas quais estão62dispostas as derivadas numéricas de R w e R t em relação à S w e P , conforme ilustrado naﬁgura.
Figura 4.6: Exemplo de estrutura da matriz jacobianaFonte: modiﬁcado de (Maliska et al., 2015)A ﬁm de efetuar o cálculo das derivadas numéricas que compõem a matriz jacobianade forma mais conveniente e eﬁcaz, as equações resíduo podem ser escritas na formaR w = αwac+ αwdif+ αwfonR t = αtac+ αtdif+ αtefon.
(4.16)
63αwαw = = = =Assim, as derivadas numéricas associadas ao resíduo R w são dadas por∂ αwdif∂ Sj∂ αwfon∂ Sj∂ αwac∂ Sj∂ R wP∂ Sj∂∂ Sj++=+ αwdif+ αwfon,(4.17)
ac∂ αwac∂ Pj∂ αwdif∂ Pj∂ αwfon∂ Pj∂ R wP∂ Pj∂∂ Pj++=+ αwdif+ αwfon,(4.18)
acαtαte as derivadas numéricas associadas ao resíduo R t , por∂ αtfon∂ Sj∂ αtdif∂ Sj∂ R tP∂ Sj∂∂ Sj+ αt=+,(4.19)
diffon∂ αtfon∂ Pj∂ αtdif∂ Pj∂ R tP∂ Pj∂∂ Pj=++ αt.
(4.20)
diffonDado isso, infere-se que a montagem da matriz jacobiana pode ser realizada conside-rando separadamente as contribuições devidas aos termos difusivo, acumulativo e fonte.
A classe JacobianAssembler dispõe de uma função responsável por calcular cada umadessas contribuições e adicioná-las à matriz jacobiana. Essa função é semelhante àqueladestinada a calcular os resíduos. Seu pseudocódigo está contido na listagem 4.8. As quatrosubrotinas chamadas na listagem 4.8 serão explicadas nos itens a seguir.
Listagem 4.8: Pseudocódigo da rotina que monta a matriz jacobiana1 CHAMA função que adiciona o termo difusivo2 CHAMA função que adiciona o termo acumulativo3 CHAMA função que adiciona termo fonte4 CHAMA função que aplica condições de contornoADIÇÃO DO TERMO DIFUSIVO Quanto à função que adiciona a contribuição do termo di-fusivo à matriz jacobiana, procurou-se efetuar a implementação computacional de formaa tentar minimizar procedimentos repetidos. Essa preocupação se deu, sobretudo, em re-lação às varreduras das entidades da malha.
Lembrando que termos difusivos são dados conforme a equação (4.5), as derivadasnuméricas do termo difusivo podem ser calculadas por64j ,Pj )− αw+ ∆S w(S wjj ,Pj + ∆Pj )− αt(S w∆Pjj ,Pj )− αw(S w+ ∆S wjj ,Pj + ∆Pj )− αt(S w(S wj ,Pj )αwdif∂ αwdif∂ Sj∂ αwdif∂ Pj∂ αtdif∂ Sj∂ αtdif∂ Pj=dif,(4.21)
∆S wjj ,Pj )(S wαwdif=dif,(4.22)
(S wj ,Pj )αt=difdif,(4.23)
∆S wj(S wj ,Pj )αt=difdif,(4.24)
∆Pjj é uma perturbação na saturação e ∆Pj , na pressão do nó j . Isto é, as deriva-em que ∆S wdas parciais dos resíduos calculadas numericamente consistem em subtrair o ﬂuxo difusivoperturbado do ﬂuxo difusivo não perturbado e dividir esse valor pela perturbação. Optou-se por armazenar o ﬂuxo não perturbado já na etapa da construção dos resíduos. Sendoassim, a função da classe JacobianAssembler, cujo intuito é adicionar os termos difu-sivos à matriz jacobiana, deve calcular o ﬂuxo perturbado, para então calcular a derivadanumérica e adicioná-la à matriz.
A ﬁm de realizar esse cálculo, dá-se primeiro a perturbação da saturação; depois, dapressão. Para o primeiro caso, faz-se a varredura dos elementos da malha e para cada nódo elemento, perturba-se a saturação, calcula-se os ﬂuxos nas faces e adiciona-se esse valorà matriz jacobiana.
O mesmo procedimento é realizado para a perturbação da pressão. Contudo, nestecaso pode-se ocasionar uma mudança no sentido dos ﬂuxos e, por conseguinte, nas mobi-lidades nas faces, interpoladas por upwind. Para simpliﬁcar o cálculo dessas mobilidades,=−KJ· ∆Af.
deﬁne-se o pseudoﬂuxo na face f , dado por−1D Φeθ pf(4.25)
Esse pseudoﬂuxo, apesar de não apresentar o valor correto do ﬂuxo difusivo, contém a in-formação referente a seu sentido, e pode, portanto, ser utilizado para determinar os valorescorretos de mobilidade.
Os procedimentos de perturbação da saturação e da pressão para a montagem da ma-triz jacobiana estão representados de forma mais detalhada na listagem 4.9.
65Listagem 4.9: Pseudocódigo da rotina que adiciona o termo difusivo na matriz jacobiana{Perturbação da saturação}12 PARA todos os elementos da malhaPARA todos os vértices do elemento3perturbar saturação do vértice4calcular mobilidade do vértice perturbado5PARA todas as faces do elemento6PARA todos os vértices do elemento7calcular contribuição do nó no ﬂuxo perturbado da face8adicionar contribuição ao ﬂuxo perturbado da face9FIM PARA10adicionar ﬂuxo perturbado dividido pela perturbação à matriz ...
11... nas equações dos nós nF e nB da face12subtrair ﬂuxo perturbado dividido pela perturbação à matriz ...
13... nas equações dos nós nF e nB da face14FIM PARA15FIM PARA1617 FIM PARA18{Perturbação da pressão}1920 PARA todos os elementos da malhaPARA todos os vértices do elemento21perturbar pressão do vértice22calcular pseudoﬂuxo23calcular mobilidade do vértice perturbado24PARA todas as faces do elemento25PARA todos os vértices do elemento26calcular contribuição do nó no ﬂuxo perturbado da face27adicionar contribuição ao ﬂuxo perturbado da face28FIM PARA29adicionar ﬂuxo perturbado dividido pela perturbação à matriz ...
30... nas equações dos nós nF e nB da face31subtrair ﬂuxo perturbado dividido pela perturbação à matriz ...
32... nas equações dos nós nF e nB da face33FIM PARA34FIM PARA3536 FIM PARA66No intuito de prover uma visualização menos abstrata da função responsável por mon-tar a matriz jacobiana, ilustrou-se um exemplo na ﬁgura 4.7. Nela, considera-se uma malhacomposta por um único elemento triangular. Admite-se, também, que está sendo realizadaa etapa de perturbação da saturação. Dá-se, então, a perturbação da saturação do nó cujoíndice é 0.
Uma vez que a perturbação é da variável correspondente à primeira equação do sis-tema, esse procedimento proverá as contribuições do termo difusivo à primeira coluna damatriz. Dada a perturbação da saturação e o cálculo das mobilidades perturbadas nas facesdo elemento, parte-se à varredura das faces. Para cada face, varre-se os nós do elementocalculando a contribuição do nó aos ﬂuxos difusivos perturbados de água e total. Faz-se,então, o cálculo da derivada numérica a partir dos valores de ﬂuxos perturbado, não per-turbado e perturbação. Essa derivada é, pois, adicionada às equações dos nós associados aessa face. Por exemplo, à face f0, estão associados os nós 0 e 1. Sendo assim, são calculadasas seguintes derivadas:∂αw∂αt∂αw∂αtdif∂ S0dif∂ S0dif∂ S0dif∂ S00011,,,.
(4.26)
Esses coeﬁcientes são relacionados às equações 0, 1, 2 e 3, respectivamente, i.e. conserva-ção da massa da água do nó 0, conservação da massa total do nó 0, conservação da massada água do nó 1 e conservação da massa total do nó 1. Constituem, portanto, contribui-ções às entradas (0,0), (1,0), (2,0) e (3,0) da matriz jacobiana. A ﬁgura 4.7 ainda apresentaa sequência do processo de varredura das faces do elemento, ilustrando as contribuiçõesdos ﬂuxos através das faces f1 e f2.
Para continuar a montagem da matriz, ter-se-ia de realizar o mesmo procedimentoincrementando as saturações dos nós 1 e 2, processo do qual seriam calculadas as colunas2 e 4 da matriz – referentes às equações de conservação da massa da água dos nós 1 e 2.
Por ﬁm, o mesmo procedimento seria feito incrementando as pressões dos nós 0, 1 e2, procedimento do qual seriam determinadas as colunas 1, 3 e 5, referentes às equaçõesde conservação da massa total dos nós 0, 1 e 2. Conforme já explicitado, a única diferençaentre esse processo de perturbação de pressão é a necessidade de calcular o pseudoﬂuxonas faces do elemento.
67Figura 4.7: Exemplo de etapa de montagem da matriz jacobianaFonte: do autor68ADIÇÃO DO TERMO ACUMULATIVO Adicionar o termo acumulativo à matriz jacobiana émuito mais simples que adicionar o termo difusivo. Isso porque só há termo de acumula-ção na equação da conservação da massa da água e, além disso, o resíduo desse termo éold−S wfunção exclusiva e linear da saturação:φP∆VP=αwacS wP.
(4.27)
∆tPA derivada parcial, pois, consiste em um valor constante e que pode ser calculado direta-mente para cada nó da malha:∂ αwac∂ S wφP∆VP=.
(4.28)
∆tA listagem 4.10 representa o pseudocódigo da função que adiciona esse termo à jacobiana.
Listagem 4.10: Pseudocódigo da rotina que adiciona o termo acumulativo na matriz jacobiana1 PARA todos os nós da malhacalcular derivada do termo acumulativo2adicionar derivada à matriz jacobiana na equação de conservação da ...
3... massa da água do nó45 FIM PARAADIÇÃO DO TERMO FONTE A função que adiciona o termo fonte veriﬁca os poços locali-zados ao longo da malha, e, a partir da informação sobre sua operação – pressão constanteou vazão constante – adiciona o valor adequado à matriz jacobiana. Os termos fonte devi-dos aos poços são= q w= q tP.
αwfonαte(4.29)
PfonAssim, se o poço opera com vazão constante, a derivada numérica é nula, logo não épreciso varrer os poços que operam sob essa condição. Já para os poços de pressão cons-= λp WIPP− Ppoço= λt WIPP− Ppoço.
tante tem-seαwfonαte(4.30)
fonPortanto, os termos fonte correspondentes aos poços que operam sob a condição depressão constante são funções de S w e P . São necessárias, então, as perturbações da satu-69ração e da pressão de forma a calcular suas contribuições à matriz jacobiana. Essa funçãoestá representada em pseudocódigo na listagem 4.11
Listagem 4.11: Pseudocódigo da rotina que aplica as condições de contorno na matriz jacobiana{Perturbação da saturação}12 PARA todos os poços da malhaSE poço opera com pressão constante3PARA cada vértice contido no poço4perturbar saturação do nó5calcular mobilidade perturbada6calcular ﬂuxo perturbadocalcular derivada e adicioná−la à matriz nas equações de ...
78... conservação do nó9FIM PARA10FIM SE1112 FIM PARA{Perturbação da pressão}1314 PARA todos os poços da malhaSE poço opera com pressão constante15PARA cada vértice contido no poço16perturbar pressão do nó17calcular mobilidade perturbada18calcular ﬂuxo perturbadocalcular derivada e adicioná−la à matriz nas equações de ...
1920... conservação do nó21FIM PARA22FIM SE2324 FIM PARAAPLICAÇÃO DAS CONDIÇÕES DE CONTORNOSe a fronteira apresentar condição de con-torno do tipo Neumann, a derivada numérica de sua contribuição é nula. Apenas ascende,pois, a necessidade de varrer as fronteiras cuja condição de contorno é do tipo Dirichlet. A
imposição dessa condição é bastante simples – basta zerar as linha referentes às equações70dos nós da fronteira e atribuir o valor unitário às entradas da diagonal principal. A funçãoresponsável pela aplicação das condições de contorno à matriz jacobiana está represen-tada por meio de pseudocódigo na listagem 4.12.
Listagem 4.12: Pseudocódigo da rotina que aplica as condições de contorno na matriz jacobiana1 PARA todas as fronteiras com condição de contorno do tipo DirichletPARA todos os nós da fronteira2zerar as entradas das linhas associadas às equações do nó3setar valor unitário na diagonal principal dessas linhas4FIM PARA56 FIM PARA4.3 PASSO DE TEMPO ADAPTATIVOAlmejando poupar esforço computacional demasiado e, simultaneamente, prevenir aespeciﬁcação de passos de tempo excessivamente altos, foi implementado um esquemade modiﬁcação do passo de tempo inicialmente especiﬁcado na simulação a partir da di-ferença do campo de saturação calculado em relação ao campo de saturação antigo, i.e.,
associado ao passo de tempo anterior. O funcionamento desse esquema está esquemati-zado por meio de um ﬂuxograma na ﬁgura 4.8.
Devem ser especiﬁcados pelo usuário cinco parâmetros de entrada: o passo de tempoinicial ∆t , a diferença máxima de saturação ∆Smax, a diferença mínima de saturação ∆Smine as duas constantes αaum e αred. A ideia central do esquema de passo de tempo adaptativoé ajustar o passo de tempo de acordo com a magnitude da variação do campo de saturaçãoa partir da especiﬁcação de um valor de αaum superior ao valor unitário e de αred, inferior.
Dessa forma, caso a diferença entre a saturação atual e a saturação antiga exceda ∆Smax emalgum volume de controle, o passo de tempo é reduzido por meio da expressão∆t = αred∆t .
(4.31)
e a solução no nível de tempo em questão é recalculada. Por outro lado, se essa diferençafor inferior a ∆Smin em todos os volumes de controle, permite-se um aumento do passo de71tempo calculando-o por meio de∆t = αaum∆t .
(4.32)
Almejando dispor de mais indicativos quanto à adequação do valor do passo de tempo,também são efetuadas veriﬁcações quanto à convergência da solução. Se ocorrer diver-gência de algum sistema linear, ou até mesmo do sistema não-linear no caso do métodototalmente implícito, o passo de tempo é reduzido utilizando a equação (4.31) e não se dáo avanço no tempo, mas sim calcula-se a solução novamente com um passo de tempo devalor mais baixo. Considera-se também como divergência o caso em que o método se-quencial efetua o número máximo de iterações em um mesmo passo de tempo sem atingira tolerância requerida.
Ademais, ainda é veriﬁcado se o campo de saturação é ﬁsicamente consistente iden-tiﬁcando se as saturações de todos os volumes de controle possuem valores entre 0 e 1−6. Se essa condição não ocorrer, procede-se como no caso dadivergência, reduzindo o passo de tempo e resolvendo novamente os campos de pressão ecom uma tolerância de 10saturação associados àquele mesmo nível temporal.
Neste trabalho optou-se por utilizar dois conjuntos de parâmetros especiﬁcados ao es-quema de passo de tempo adaptativo. O primeiro, e mais rígido, tem os valores de seusparâmetros listados na tabela 4.1; O segundo, e menos rígido, na tabela 4.2.
Tabela 4.1: Parâmetros correspondentes ao critérios mais rígido de passo de tempo adaptativo∆Smax ∆Smin αaum αred0,10,50,051,01Tabela 4.2: Parâmetros correspondentes ao critérios menos rígido de passo de tempo adaptativo∆Smax ∆Smin αaum αred0,20,50,051,172Figura 4.8: Fluxograma da estratégia de modiﬁcação do passo de tempoFonte: do autor734.4 ESPECIFICAÇÃO DAS TOLERÂNCIASO método totalmente implícito requer a especiﬁcação de duas tolerâncias. A primeiracorresponde ao sistema linear composto pela matriz jacobiana e pelo vetor de resíduos.
Tendo em vista que o termo independente é o resíduo, optou-se por utilizar a tolerânciaabsoluta da biblioteca PETSc para esse caso a ﬁm de que não fosse especiﬁcado um critérioexcessivamente apertado. Assim, o critério de convergência do solver linear é(cid:107)R(cid:107) < ,(4.33)
em que R é o vetor resíduo e  é a tolerância especiﬁcada. O valor de  atribuído para−5. Outra tolerância que necessitaresolver os problemas apresentados neste trabalho foi 10ser especiﬁcada no método totalmente implícito corresponde ao sistema não linear. Nessecaso, optou-se por utilizar a norma da mudança da solução ao longo dos passos de tempo(cid:107)∆X(cid:107)(cid:107)X(cid:107) < ,(4.34)
em que X é a solução e ∆X é a diferença entre a solução atual em relação à iteração anterior−8do solver não linear. Para resolver os problemas desta trabalho, especiﬁcou-se valor 10para essa tolerância.
Quanto ao método IMPES, a única tolerância a ser especiﬁcada diz respeito ao sistemalinear de cálculo da pressão. Atribuiu-se, nesse caso, o mesmo critério do solver não li-near do método totalmente implícito. Ao método sequencial também atribuiu-se o mesmocriério de convergência. Neste último, contudo, após resolver o sistema linear da pressão,segue-se a atualização das mobilidades e nova resolução do sistema linear até que a solu-ção mude menos que uma tolerância. Para isso, utilizou-se como critério a razão entre anorma inﬁnita do campo de pressão atual e a norma inﬁnita do campo de pressão obtidono passo na iteração anterior, i.e., utlizou-se a expressão(cid:107)Patual− Panterior(cid:107)∞(cid:107)Panterior(cid:107)∞< ,(4.35)
−6. Também optou-se por determinarem que a tolerância  foi especiﬁcada com o valor 1050 como o número máximo de iterações em um mesmo passo de tempo. Esse limite sepresta a impedir que o programa continue sendo executado indeﬁnidamente nos casos dedivergência. Conforme explicado na seção anterior, caso isso ocorra a solução correspon-dente a esse mesmo nível de tempo é recalculada com um passo de tempo inferior.
745RESULTADOSNeste capítulo, serão apresentados os resultados provenientes da simulação numéricado modelo descrito. Primeiramente, será apresentada a validação do simulador implemen-tado lançando-se mão de um caso de deslocamento unidimensional em que há soluçãoanalítica disponível – o caso de Buckley-Leverett. A seguir, serão expostos os resultados ob-tidos para a simulação do deslocamento bidimensional em um reservatório que apresentaa conﬁguração conhecida como quarter ﬁve-spot. Por ﬁm, serão apresentados os resulta-dos provenientes da simulação do deslocamento tridimensional em uma malha híbrida.
5.1 DESLOCAMENTO UNIDIMENSIONAL5.1.1 DESCRIÇÃO DO PROBLEMAConsidera-se uma amostra de rocha homogênea inicialmente embebida em óleo naqual injeta-se água a uma vazão constante através de uma de suas fronteiras, conformeilustrado na ﬁgura 5.1. Se a vazão de água for suﬁcientemente alta, a inﬂuência da pressãocapilar diminui de tal forma que o problema pode ser modelado como um processo dedeslocamento unidimensional do tipo que permite uma solução analítica (Hurtado, 2005).
Figura 5.1: Conﬁguração do problema de deslocamento unidimensionalFonte: modiﬁcado de (Maliska et al., 2015)A equação que modela o escoamento na direção do eixo x é dada por (Maliska et al.,
752015):∂ Ff∂ x∂ S∂ t+ v T= 0,φ(5.1)
em que Ff é o ﬂuxo fracionário deﬁnido pork wrµw+ k orµoFf =.
(5.2)
k wrµwÉ possível mostrar que a solução analítica para essa problema depende do ﬂuxo fracio-nário, o qual, por sua vez, é determinado pelas curvas de permeabilidade relativa e pelarelação entre as viscosidades (Maliska et al., 2015).
Para os exemplos apresentados nesta seção foram empregadas as curvas de permea-= ˆS2 ,=1− ˆS2.
 S w − S w− S wblidade descritas dadas pelo modelo de Corey – descrito no capítulo 2 – com coeﬁcienteunitário e expoente 2, isto é,k wr(5.3)
k or(5.4)
A saturação ˆS normalizada é calculada porˆS =mi n,(5.5)
S wma xmi nem que as saturações mínimas e máximas de água foram tomadas como 0 e 1, respectiva-mente. Já a relação entre as viscosidades é dada, neste problema, porµoµw= 4.
(5.6)
À porosidade foi atribuído o valor unitário. As curvas de permeabilidade relativa e ﬂuxofracionário podem ser visualizadas na ﬁgura 5.2.
Outro parâmetro presente na equação (5.1) é a velocidade total v T , que consiste nasoma das velocidades das duas fases na direção x . Pois que nesse caso a equação de con-∇·vT = 0,servação é simpliﬁcada para(5.7)
e a velocidade prescrita na fronteira x = 0 é constante, pode-se aﬁrmar que essa velocidadeé constante ao longo do domínio (Hurtado, 2005).
76Figura 5.2: Curvas de permeabilidade e ﬂuxo fracionário(a) Curvas de permeabilidade relativa(b) Fluxo fracionário em função da saturaçãoFonte: do autor5.1.2 SOLUÇÃO ANALÍTICAA ﬁm de obter a solução analítica, as variáveis do problema são adimensionalizadas. As
versões adimensionais da coordenada axial do domínio e do tempo são, respectivementeτ = v T tφLX = xLe.
(5.8)
Dado isso, a equação (5.1) pode ser escrita na forma∂ Ff∂ X∂ S∂ τ+= 0.
(5.9)
Deﬁnindo, ainda, o parâmetroξ = Xτ ,(5.10)
− ξdFa equação (5.9) se torna uma equação diferencial ordinária:dSdξ= 0(5.11)
dS ξ = FA solução analítica dessa equação é (Dullien, 1979):se 0≤ ξ≤ D ,se D ≤ ξ≤∞,(Sf ) = Ff (Sf )− Ff (Si )(cid:48)(S)fS = Siem que(cid:48)Sf − SiD = Ff,(5.12)
77Si é a saturação inicial do domínio e Sf , a saturação da frente de água. Essa solução analíticaé conhecida como solução de Buckley-Leverett.
5.1.3 RESULTADOS OBTIDOSA ﬁm de comparar resultados numéricos à solução analítica, especiﬁcou-se como con-dição inicialS(x ,0) = 0, para 0≤ x ≤ L,P (x ,0) = 0, para 0≤ x ≤ L,(5.13)
(5.14)
i.e., o domínio está, inicialmente, embebido com óleo. A condição de contorno para afronteira x = 0 é de Neumann. A velocidade de água foi prescrita com valor unitário; doóleo, nulo. Já para a fronteira x = L prescreveu-se os mesmos valores de pressão e satu-ração iniciais. Devido ao caráter hiperbólico da equação e sabendo-se que o ﬂuido estádeixando essa fronteira, nenhuma condição de saturação precisaria ser prescrita (Maliskaet al., 2015). Por motivos computacionais, foi prescrito o mesmo valor das condições inici-ais e faz-se uma veriﬁcação para identiﬁcar se a frente de água ainda não chegou a x = L.
Não obstante se trate de um problema unidimensional, utilizou-se um domínio bidi-mensional e exportou-se as soluções de todos os nós da malha. Os quatro perﬁs mostradosnos resultados são correspondentes aos instantes de tempo 0,2, 0,3, 0,4 e 0,5 VPI – equiva-lentes a 0,8, 1,2, 1,6 e 2,0 segundos. O VPI pode ser interpretado como um tempo adimen-(cid:82) t(cid:82)sional em um problema de deslocamento é o volume poroso injetado e é dado por(Ql )entdtφdVVPI = Volume de ﬂuido injetadovolume poroso disponível=0,(5.15)
Vem que (Ql )ent é a vazão injetada no meio poroso.
As soluções analíticas correspondentes a esses tempos foram comparadas às soluçõesnuméricas advindas dos métodos IMplicit pressure, Explicit Saturation, sequencial e to-talmente implícito, identiﬁcados nos gráﬁcos, respectivamente, pelas siglas FIM, IMPESe SEQ. Os resultados numéricos foram obtidos empregando três malhas com diferentesgraus de reﬁno, todas compostas por elementos triangulares. A mais grosseira possui 430nós; a mediana, 1961; a mais reﬁnada, 7392. Essas malhas podem ser visualizadas na ﬁ-gura 5.3. Os resultados numéricos apresentados a seguir foram obtidos considerando-se−3 segundos.
um passo de tempo inicial de 1078Figura 5.3: Malhas não-estruturadas utilizadas na solução do problema de Buckley-LeverettFonte: do autorOs resultados obtidos com passo de tempo ﬁxo estão dispostos nas ﬁguras 5.4, 5.5 e
5.6 para malhas de 430, 1961 e 7392 nós, respectivamente. O tempo computacional des-pendido para 0,5 VPI por meio dos três métodos pode ser visualizado na ﬁgura 5.7. Nesses−3s.
casos, o passo de tempo foi mantido em seu valor inicial de 10Já os resultados obtidos para o critério mais rígido de passo de tempo estão dispostosnas ﬁguras 5.8, 5.9 e 5.10 para malhas de 430, 1961 e 7392 nós, respectivamente. O tempocomputacional despendido para 0,5 VPI por meio dos três métodos pode ser visualizadona ﬁgura 5.11. A evolução dos passos de tempo estão dispostas nas ﬁguras 5.12, 5.13 e 5.14.
Por ﬁm, os resultados obtidos para o critério menos rígido de passo de tempo estão dis-postos nas ﬁguras 5.15, 5.16 e 5.17 para malhas de 430, 1961 e 7392 nós, respectivamente.
O tempo computacional despendido para 0,5 VPI por meio dos três métodos pode ser vi-sualizado na ﬁgura 5.18. A evolução dos passos de tempo estão dispostas nas ﬁguras 5.19,
5.20 e 5.21.
Ainda, os campos de saturação e pressão obtidos por meio do método totalmente im-plícito com o critério mais rígido de passo de tempo adaptativo e na malha mais reﬁnadaestão ilustrados na ﬁgura 5.22 para 0,2, 0,3, 0,4 e 0,5 VPI. Os resultados são associados àscurvas correspondentes ao método FIM na ﬁgura 5.10.
79Figura 5.4: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malhade 430 nósFonte: do autorFigura 5.5: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malhade 1961 nósFonte: do autor80Figura 5.6: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com passo de tempo ﬁxo em uma malhade 7392 nósFonte: do autorFigura 5.7: Tempo computacional para os três métodos com passo de tempo ﬁxoFonte: do autor81Figura 5.8: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempoadaptativo em uma malha de 430 nósFonte: do autorFigura 5.9: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempoadaptativo em uma malha de 1961 nósFonte: do autor82Figura 5.10: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério mais rígido de passo de tempoadaptativo em uma malha de 7392 nósFonte: do autorFigura 5.11: Tempo computacional para os três métodos com critério mais rígido de passo de tempoadaptativoFonte: do autor83Figura 5.12: Evolução do passo de tempo para a malha de 430 nós com critério mais rígido de passode tempo adaptativoFonte: do autorFigura 5.13: Evolução do passo de tempo para a malha de 1961 nós com critério mais rígido de passode tempo adaptativoFonte: do autor84Figura 5.14: Evolução do passo de tempo para a malha de 7392 nós com critério mais rígido de passode tempo adaptativoFonte: do autorFigura 5.15: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo detempo adaptativo em uma malha de 430 nósFonte: do autor85Figura 5.16: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo detempo adaptativo em uma malha de 1961 nósFonte: do autorFigura 5.17: Resultados obtidos para VPI 0,2, 0,3, 0,4 e 0,5 com critério menos rígido de passo detempo adaptativo em uma malha de 7392 nósFonte: do autor86Figura 5.18: Tempo computacional para os três métodos com critério menos rígido de passo detempo adaptativoFonte: do autorFigura 5.19: Evolução do passo de tempo para a malha de 430 nós com critério menos rígido depasso de tempo adaptativoFonte: do autor87Figura 5.20: Evolução do passo de tempo para a malha de 1961 nós com critério menos rígido depasso de tempo adaptativoFonte: do autorFigura 5.21: Evolução do passo de tempo para a malha de 7392 nós com critério menos rígido depasso de tempo adaptativoFonte: do autor88Figura 5.22: Campos de saturação e pressão para os instantes de tempo 0,2, 0,3 0,4 e 0,5 VPIFonte: do autorPara todos os critérios de passo de tempo adaptativo, as soluções numéricas apresen-tam o comportamento esperado, i.e., os perﬁs numéricos de saturação se aproximam aoperﬁl correspondente à solução analítica à medida que a malha é reﬁnada. Entretanto, atémesmo na malha mais reﬁnada há considerável presença de difusão numérica, a qual é res-ponsável pela suavização da discontinuidade dos perﬁs. Hurtado (2005) aﬁrma que esseé o preço que deve ser pago pela garantia de soluções ﬁsicamente coerentes e que, nestecaso, a difusão numérica advém da interpolação de primeira ordem utilizada nos termosadvectivos.
Quanto à evolução do passo de tempo, infere-se que o esquema de passo de tempoadaptativo pode ser responsável por considerável redução do tempo computacional, poisque permite-se um acréscimo de seu valor até que isso não afete a obtenção de uma soluçãoestável. Além disso, conforme esperado, o passo de tempo deve ser reduzido à medida quea malha é reﬁnada, conforme expõem as ﬁguras 5.12, 5.13, 5.14, 5.19, 5.20 e 5.21.
89Entretanto, observa-se que a utilização de um esquema de passo de tempo adaptativopode inﬂuenciar na qualidade da solução numérica obtida. Quando esse esquema não éaplicado as soluções determinadas pelos três métodos praticamente coincidem – 5.4, 5.5 e
5.6. A solução obtida por meio do método totalmente implícito não é afetada signiﬁcativa-mente quando os criérios mais e menos rígido de passo de tempo adaptativo são emprega-dos. O método sequencial, contudo, apresenta alguns pontos distantes da curva quandoo critério menos rígido de passo de tempo adaptativo é empregado – 5.15, e 5.17. Já o mé-todo IMPES apresenta uma solução mais próxima da analítica quando o critério de passode tempo adaptativo é aplicado. Isso se deve, possivelmente, a uma condição mais próximadaquela na qual essse método fornece a solução analítica para o caso de Buckley-Leverett.
Essa condição é apresentada no apêndice A para o caso de uma malha unidimensional.
Também é explicado que o método FIM, não obstante a estabilidade incondicional, apre-senta difusão numérica para quaisquer combinações de malha e parâmetros do problema.
Os resultados obtidos neste trabalho sugerem que esse comportamento se mantém no casode uma malha não estruturada bidimensional. Nesse caso, entretanto, as condições quepermitem ao IMPES apresentar a solução analítica não podem ser obtidas de forma direta.
Mesmo se essas condições pudessem ser determinadas, ter-se-ia de especiﬁcar um passode tempo ﬁxo, logo não seria possível satisfazê-la com o esquema de passo adaptativo.
Quanto ao tempo computacional despendido em cada simulação, infere-se que o passode tempo adaptativo é interessante sobretudo ao método totalmente implícito, o qual per-mite uma redução do custo computacional sem que a solução seja signiﬁcativamente al-terada. O método sequencial, muito embora tenha fornecido soluções mais rapidamenteque o FIM para alguns casos, apresentou certa sensibilidade em relação ao uso de um passode tempo adaptativo, de forma que deve-se ter cautela a aplicar essa condição para tal mé-todo. Já o método IMPES clássico se comportou bem quanto à utilização do passo de tempoadaptativo. Contudo, conforme já explicado, isso pode ser devido a um caráter particulardo problema unidimensional de Buckley-Leverett.
905.2 DESLOCAMENTO BIDIMENSIONAL EM CONFIGURAÇÃO QUAR-TER FIVE-SPOT5.2.1 DESCRIÇÃO DO PROBLEMAConsidera-se uma amostra de rocha quadrada, homogênea, inicialmente embebidaem óleo e na qual injeta-se água a uma vazão constante através de um poço injetor e produz-se óleo a partir de um poço produtor que opera com pressão constante, conforme ilustradona ﬁgura 5.23.
Figura 5.23: Conﬁguração do problema de deslocamento bidimensionalFonte: modiﬁcado de (Maliska et al., 2015)A conﬁguração desse problema é conhecida como quarter ﬁve-spot, pois que repre-senta um quarto de um domínio quadrado em que há quatro poços produtores nos vérti-ces e um poço injetor no centro (Aziz & Settari, 1979). Os dados de entrada utilizados noproblema estão listados na tabela 5.1. A injeção de água ao longo do tempo especiﬁcadocorresponde a cerca de 48% do volume poroso injetado. O modelo de permeabilidade re-= ˆS2 ,=1− ˆS2.
lativa considerado foi o modelo de Corey com coeﬁciente unitário e expoente quadrático,ou seja,k wr(5.16)
k or(5.17)
As saturações mínima e máxima de água e óleo foram especiﬁcadas como 0 e 1, respecti-vamente e o campo de pressão inicial é nulo.
91Tabela 5.1: Dados do problema de deslocamento bifásico bidimensionalAtributoValor90000 m2−3 Pa.s
10−2 Pa.s
10−11 m2100,2−5 m3/s5000Área do reservatórioViscosidade da águaViscosidade do óleoPermeabilidade absolutaPorosidadeVazão de água injetadaDias de simulação2.10
Fonte: do autor5.2.2 RESULTADOS OBTIDOSA seguir serão apresentados alguns resultados obtidos para o problema descrito. Os re-sultados numéricos advindos de cada método – IMPES, totalmente implícito e sequencial– serão apresentados e comparados entre si. Foram empregadas três malhas computacio-nais com diferentes graus de reﬁno – 425, 1483 e 5985 nós – compostas apenas de elemen-tos triangulares. Essas malhas podem ser visualizadas na ﬁgura 5.24. Os valores de índice−11 m3 para as−11 m3 e 6,18471.10
−11 m3, 3,25968.10
de poço utilizados foram 2,85208.10
malhas de 425, 1483 e 5985 nós, respectivamente.
Figura 5.24: Malhas não-estruturadas utilizadas na solução do problema quarter ﬁve-spotFonte: do autorOs critérios de convergência e as tolerâncias utilizadas foram idênticos àqueles espe-ciﬁcados no caso de deslocamento unidimensional. Neste caso utilizou-se apenas o es-quema mais rídido de passo de tempo, o qual tem seus parâmetros listados na tabela 4.1.
92Os resultados obtidos para a malha mais grossa – de 425 nós – sem e com a utilizaçãodo passo de tempo adaptativo podem ser visualizados, respectivamente, nas ﬁguras 5.25 e5.26. No caso de passo de tempo ﬁxo, seu valor foi mantido constante e igual a 1 dia. No
caso em que é utilizado o esquema de passo de tempo adaptativo, esse valor correspondeao passo de tempo inicial. As primeiras curvas expostas são a pressão média ao longo dotempo e a taxa de produção de óleo. A terceira curva corresponde ao corte de água – razãoentre a vazão de água e a vazão total no poço. A quarta curva correlaciona o volume po-roso injetado à eﬁciência de varrido horizontal – razão entre o volume de óleo produzido eo volume injetável. Quando se dispõem de curvas de eﬁciência de varrido horizontal, parase obterem os valores reais para um determinado reservatório basta multiplicar os valoresadimensionais que podem ser lidos na ﬁgura pelo volume deslocável do meio poroso emestudo (Rosa et al., 2006). Em decorrência de sua deﬁnição, essa curva é idêntica à de satu-ração média no domínio. Por ﬁm, a última curva apresenta a evolução do passo de tempoda simulação. Os tempos computacionais despendidos sem e com a utilização do passode tempo adaptativo estão listados, respectivamente, nas tabelas 5.2 e 5.3.
Os mesmos resultados também foram obtidos para uma malha de 1483 nós e estão dis-postos, sem e com a utilização do passo de tempo adaptativo, respectivamente, nas ﬁguras5.27 e 5.28. Para esse caso, o passo de tempo inicial especiﬁcado foi de 0,5 dia quandoutilizado o esquema de passo de tempo adaptativo. Quando não utilizado, seu valor foimantido em 0,5 dia. Os tempos computacionais despendidos sem e com a utilização dopasso de tempo adaptativo estão listados, respectivamente, nas tabelas 5.4 e 5.5.
Por ﬁm, também foram calculados os mesmos resultados para a malha mais reﬁnada– de 5985 nós. Esses resultados estão dispostos, sem e com a utilização do passo de tempoadaptativo, respectivamente, nas ﬁguras 5.29 e 5.30. Para essa conﬁguração, o passo detempo foi mantido em 0,05 dia quando não utilizada a estratégia de passo de tempo adap-tativo. Quando utilizada, esse foi o valor especiﬁcado como passo de tempo inicial. Os
tempos computacionais despendidos sem e com a utilização do passo de tempo adapta-tivo estão listados, respectivamente, nas tabelas 5.6 e 5.7.
Ademais, os campos de saturação e pressão no instante de breakthrough estão ilustra-dos na ﬁgura 5.31. A partir desse instante, o poço produtor passa a produzir não apenasóleo, mas também água (Rosa et al., 2006). Já a ﬁgura 5.32 exibe os campos de saturaçãoobtidos pelo método totalmente implícito, com passo de tempo ﬁxo e com a malha maisreﬁnada para os instantes de tempo de 500, 1500, 3000 e 5000 dias.
93Figura 5.25: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e umamalha de 425 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.2: Tempo computacional – passo de tempo ﬁxo e malha de 425 nósFIMIMPES46,7706 sSEQ481,315 s206,893 sFonte: do autor94Figura 5.26: Resultados obtidos para o deslocamento bidimensional com passo de tempo adapta-tivo e uma malha de 425 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.3: Tempo computacional – passo de tempo adaptativo e malha de 425 nósFIMIMPES13,8850 sSEQ49,8253 s57,2920 sFonte: do autor95Figura 5.27: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e umamalha de 1483 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.4: Tempo computacional – passo de tempo ﬁxo e malha de 1483 nósFIMIMPES453,339 sSEQ4259,28 s822,232 sFonte: do autor96Figura 5.28: Resultados obtidos para o deslocamento bidimensional com passo de tempo adapta-tivo e uma malha de 1483 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.5: Tempo computacional – passo de tempo adaptativo e malha de 1483 nósFIMIMPES108,822 sSEQ219,840 s306,970 sFonte: do autor97Figura 5.29: Resultados obtidos para o deslocamento bidimensional com passo de tempo ﬁxo e umamalha de 5985 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.6: Tempo computacional – passo de tempo ﬁxo e malha de 5985 nósFIMIMPESSEQ115135 s13.097,2 s28.003,0 sFonte: do autor98Figura 5.30: Resultados obtidos para o deslocamento bidimensional com passo de tempo adapta-tivo e uma malha de 5985 nós(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.7: Tempo computacional – passo de tempo adaptativo e malha de 5985 nósFIMIMPESSEQ1.315,89 s1.048,18 s4.625,63 sFonte: do autor99Figura 5.31: Campos de pressão e saturação no instante de breakthroughFonte: do autorFigura 5.32: Campos de saturação para os instantes de tempo de 500, 1500, 3000 e 5000 diasFonte: do autor100Observa-se que a curva de eﬁciência de varrido horizontal apresenta dois trechos dis-tintos – uma reta correspondente à função identidade e uma curva tendendo a se tornarhorizontal. O tempo associado à transição entre esses dois trechos é o instante de breakth-rough (BT).
Quanto à curva de pressão, veriﬁca-se que seu valor máximo não ocorre quando a ro-cha está saturada de óleo. Tem-se uma curva de pressão média crescente até atingir seuvalor máximo e, a partir de então, a curva passa a ser decrescente. Esse comportamentodecorre da utilização de um modelo de permeabilidade relativa quadrático, pois que comesse modelo o mínimo valor de mobilidade total ocorre quando a saturação de óleo é me-nor que a unidade.
Pode-se inferir dos resultados que o métodos IMPES apresenta instabilidades na solu-ção numérica correspondente após o breakthrough. Essas instabilidades ocorrem porqueesse esquema não itera na não linearidade existente entre pressão e saturação, de modoque o valor da saturação utilizada para calcular a vazão de ﬂuido produzida é o do tempoanterior. Isso pode levar a inconsistências físicas no instante de tempo em que se passa aproduzir água. Nesse instante, os volumes de controle ao redor do poço produtor apresen-tam saturação de água relativamente elevada, levando a uma vazão de água entrando novolume de controle do poço também relativamente alta. Porém, a vazão de água produzidano poço ainda é baixa, pois a saturação de água nesse volume é a do instante anterior, queé pequena. Ou seja, a diferença entre as vazões entrando e saindo do volume de controleé alta. Caso passos de tempo grandes sejam utilizados, a variação da saturação será tam-bém relativamente alta (e possivelmente não física). No próximo passo de tempo ter-se-ia,pois, mobilidade da água com valor elevado, levando a uma produção de água excessiva,que leva a uma redução demasiada da saturação. Desse modo, a saturação de água novolume de controle do poço ﬁca instável, alternando entre valores altos e baixos. Essasinstabilidades podem ser reduzidas substancialmente modiﬁcando o IMPES clássico parao método sequencial. Contudo, isso se dá às custas da necessidade um maior tempo decomputação.
Já o método totalmente implícito apresenta soluções estáveis não obstante a utilizaçãodo esquema de passo de tempo adaptativo. Ademais, essa estratégia permitiu uma reduçãosigniﬁcativa do custo computacional correspondente ao método FIM, que com passo detempo ﬁxo era o que mais demandava tempo computacional e com passo de tempo adap-tativo ﬁcou menos custoso que o método sequencial. Ressalta-se que embora o IMPEStenha sido o método menos custoso em todos os casos, sua solução só apresentou estabi-101lidade em casos de passo de tempo ﬁxo. Além disso, o custo computacional de utilizar ométodo totalmente implícito com passo de tempo adaptativo ﬁcou da mesma ordem docusto correspondente à utilização da formulação IMPES sem o passo de tempo adaptativoe ambos os métodos apresentaram soluções estáveis e consistentes. Portanto, foi possíveltirar proveito da robustez do FIM no intuito de utilizar passos de tempo mais elevados epor conseguinte reduzir o tempo despendido na simulação numérica. Os tempos compu-tacionais despendidos estão sumarizados por meio de gráﬁcos na ﬁgura 5.33.
Figura 5.33: Tempos computacionais despendidos no caso de deslocamento bidimensional(a) Malha de 425 nós(b) Malha de 1483 nós(c) Malha de 5985 nósFonte: do autorAlmejando analisar mais pormenorizadamente a inﬂuência do esquema de passo detempo adaptativo na solução numérica obtida por meio do método totalmente implícito,foram comparados os resultados advindos de três tratamentos distintos do passo de tempo– passo de tempo ﬁxo, critério mais rígido e critério menos rígido. Os parâmetros associ-ados a esses critérios já foram explicados e podem ser encontrados nas tabelas 4.1 e 4.2.
Para realizar essa comparação, optou-se por utilizar a malha mais grossa, a qual possui425 nós. Os resultados obtidos estão expostos na ﬁgura 5.34. Os tempos computacionaisdespendidos na obtenção de tais soluções estão listados na tabela 5.8.
102Figura 5.34: Resultados obtidos para o deslocamento bidimensional com o método totalmente im-plícito(a) Curva de pressão média(b) Curva de produção de óleo(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autorTabela 5.8: Tempo computacional despendido com o método FIMFixoMais rígido Menos rígido481,315 s49,825 s10,6337 sFonte: do autor103Pode-se inferir dos resultados obtidos que o emprego do passo de tempo adaptativoreduziu o tempo computacional em uma ordem. Além disso, do critério mais rígido para omenos rígido veriﬁcou-se uma redução de cinco vezes nesse tempo despendido. Não obs-tante essa redução esteja inevitavelmente em conjunto com uma maior difusão numéricae por conseguinte menor capacidade de capturar gradientes elevados, todas as soluçõesapresentadas são ﬁsicamente consistentes. Logo, é evidente que a escolha do esquema depasso de tempo adaptativo a ser utilizado está fortemente relacionado com a precisão coma qual se deseja solucionar o problema.
1045.3 DESLOCAMENTO TRIDIMENSIONAL EM MALHA HÍBRIDA5.3.1 DESCRIÇÃO DO PROBLEMAO problema de deslocamento bifásico tridimensional será simulado em uma malhanão-estruturada híbrida com o formato aproximado do território brasileiro. Trata-se deum processo de recuperação secundária de óleo em um reservatório tridimensional noqual há três poços injetores e dois produtores, conforme esquematizado na ﬁgura 5.35.
Figura 5.35: Conﬁguração do problema tridimensionalFonte: do autorOs três poços injetores são verticais e atravessam integralmente a espessura do reser-vatório. Os dois poços produtores, por sua vez, são direcionais. Em torno de cada um dospoços a malha tem formato cilíndrico acompanhando a trajetória da linha que representao poço, conforme ilustrado na ﬁgura 5.36. Todas as fronteiras do reservatório são imper-meáveis. Tanto as informações relacionadas à malha quanto os dados de entrada estãolistados na tabela 5.9.
O modelo de permeabilidade relativa é o mesmo que aquele utilizado nos casos an-teriores, i.e., modelo de Corey com expoente quadrático e coeﬁciente unitário. Ainda, oproblema foi resolvido em termos de potenciais. A ﬁm de obter o campo de pressão poder-105Figura 5.36: Ilustração da malha cilíndrica ao redor dos poçosFonte: modiﬁcado de Maliska et al. (2012)Tabela 5.9: Dados do problema de deslocamento bifásico tridimensionalAtributoValor200 m200 m130 mComprimento máximo do reservatórioLargura máxima do reservatórioEspessura máxima do reservatórioVolume do reservatórioNúmero de nósNúmero de tetraetrosNúmero de hexaedrosNúmero de prismasNúmero de pirâmidesNúmero de poços injetoresNúmero de poços produtoresViscosidade da águaViscosidade do óleoPermeabilidade absolutaPorosidadeVazão de água injetada pelo poço injetor 1Vazão de água injetada pelo poço injetor 2Vazão de água injetada pelo poço injetor 3Dias de simulação1,02249.106 m380733528654454457632−3 Pa.s
10−2 Pa.s
10−14 m2100,1−4 m3/s−5 m3/s−5 m3/s30001,1.10
9.10
8.10
se-ia fazer um pós processamento a partir dos dados de densidades das fases e aceleraçãodevida à gravidade. As saturações mínima e máxima de água e óleo foram especiﬁcadascomo 0 e 1, respectivamente e os campos inciais de pressão e saturação são nulos. Os cri-térios de convergência e as tolerâncias especiﬁcadas para este problema também foramiguais àqueles utilizados nos problemas anteriores. Já os valores de índice de poço utiliza-−13 m3 e 3,92357.10
−13 m3.
dos para os poços 1 e 2 foram, respectivamente, 3,05816.10
1065.3.2 RESULTADOS OBTIDOSA seguir, os resultados numéricos advindos de cada método – IMPES, totalmente implí-cito e sequencial – serão apresentados e comparados entre si. Uma vez que foi observado,a partir dos resultados obtidos para o deslocamento bidimensional, que o método IMPESé signiﬁcativamente sensível ao esquema de passo de tempo adaptativo implementado,optou-se por utilizar passo de tempo ﬁxo quando este método for empregado. Quantoao método sequencial, veriﬁcou-se que sua limitação quanto ao passo de tempo utilizadoapós o instante de breakthrough é severa a ponto de ser mais vantajoso especiﬁcar passode tempo ﬁxo. Sendo assim, apenas para o método FIM foi empregado o esquema de passode tempo variável mais rígido, cujos parâmetros estão listados na tabela 4.1.
Os resultados obtidos para 3000 dias de simulação podem ser visualizados na ﬁgura5.37. As primeiras curvas expostas são a pressão e saturação média ao longo do tempo. As
terceira e quarta curvas correspondem à produção de óleo e ao corte de água, respectiva-mente. A quinta curva correlaciona o volume injetado adimensional injetado à eﬁciênciade varrido horizontal. Já a última curva apresenta a evolução do passo de tempo da simu-lação. Por ﬁm, os tempos computacionais despendidos estão listados na tabela 5.10.
Quanto à solução numérica, infere-se que os três métodos apresentam soluções coe-rentes e quase coincidentes. O método FIM, contudo, apresenta expressiva vantagem emrelação ao tempo computacional necessário à simulação do problema, tendo em vista quedespendeu apenas 7,69% do tempo computacional gasto pelo método IMPES e 2,96%, dosequencial. É interessante veriﬁcar que em nenhum momento foi necessária uma reduçãodo passo de tempo adaptativo quando se empregou a formulação totalmente implícita.
A ﬁm de explorar ainda mais as potencialidades do método totalmente implícito, foramobtidos resultados para 10000 dias de simulação apenas com esse método, os quais podemser visualizados na ﬁgura 5.38. As ﬁguras ﬁgura 5.39 e ﬁgura 5.40 ilustram, respectivamente,os campos de saturação e pressão para seis instantes de tempo – 496, 997, 3010 e 5000, 7013e 10000 dias. Em ambas as ﬁguras foi realizado um corte na malha a ﬁm de prover uma me-lhor visualização da região próxima aos poços injetores. Os campos ﬁnais de saturação epressão – para 10000 dias – podem ser visualizados na ﬁgura 5.41. O tempo computaci-onal despendido nesse caso foi de 18909,8 segundos, apenas cerca de 12% a mais que otempo necessário para simular 3000 dias. Percebe-se, assim, que lançando-se mão de umesquema de passo de tempo adaptativo foi possível utilizar-se da robustez da formulaçãototalmente implícita a ﬁm de prover uma simulação menos custosa.
107Figura 5.37: Resultados obtidos para o deslocamento tridimensional em malha híbrida com os trêsmétodos para 3000 dias de simulação(a) Curva de pressão média(b) Curva de produção de óleo acumulada(d) Curva de eﬁciência de varrido horizontal(c) Curva de corte de água(e) Curva de passo de tempoFonte: do autorTabela 5.10: Tempo computacional despendidoFIMIMPES219.877 sSEQ16.914,3 s571.286 sFonte: do autor108Figura 5.38: Resultados obtidos para o deslocamento tridimensional em malha híbrida com o mé-todo totalmente implícito para 10000 dias de simulação(a) Curva de pressão média(b) Curva de produção de óleo acumulada(c) Curva de corte de água(d) Curva de eﬁciência de varrido horizontal(e) Curva de passo de tempoFonte: do autor109Figura 5.39: Campo de saturação para quatro instantes de tempoFonte: do autorFigura 5.40: Campo de pressão para quatro instantes de tempoFonte: do autor110Figura 5.41: Campos ﬁnais de pressão e saturaçãoFonte: do autor1116CONCLUSÃO6.1 SUMÁRIONeste trabalho foram expostos o estudo e a implementação de um simulador bifásico,imiscível, isotérmico e incompressível destinado à simulação numérica do deslocamentode ﬂuidos em reservatórios de petróleo. Foram apresentadas e comparadas três formu-lações distintas – método totalmente implícito, IMPES clássico e sequencial – em termosde estabilidade, acuracidade e tempo computacional. Utilizou-se o método dos volumesﬁnitos baseado em elementos, o qual proporciona uma maior ﬂexibilidade para a repre-sentação geométrica de reservatórios. Ainda, foi implementado um esquema de passo detempo adaptativo a ﬁm de veriﬁcar tanto a sensibilidade de cada método em relação a esseesquema quanto a capacidade de reduzir os tempos computacionais despendidos nas si-mulações.
Os métodos IMPES clássico e sequencial foram adaptados a partir do código desen-volvido em (Grein, 2015) e disponibilizado na EFVLib. Nessas formulações, a pressão éresolvida de forma implícita; a saturação, explícita. A diferença entre ambos é que o mé-todo sequencial atualiza os coeﬁcientes do sistema linear da pressão e resolve novamenteos campos de pressão e saturação até que a alteração de seus valores seja inferior a umatolerância especiﬁcada.
O método totalmente implícito ou FIM (Fully implicit method) foi implementado in-tegralmente. Nessa formulação, as variáveis são resolvidas simultaneamente. Para isso,fez-se necessária a integração de um método capaz de resolver um sistema não-linear deequações à EFVLib. A implementação desse solver não-linear na EFVLib consistiu em umadas grandes contribuições deste trabalho. Foi adotado o método de Newton-Raphson, oqual foi implementado com o suporte da biblioteca PETSc (Balay et al., 2013). A utilizaçãodo método disponível na biblioteca, contudo não foi direta. Foram construidos e infor-mados, manualmente, o vetor resíduo e a matriz jacobiana. O algoritmo de montagemda matriz jacobiana consiste na parte mais custosa e complexa do código computacional.
Além disso, o procedimento realizado para calcular corretamente as derivadas numéricasque compõem essa matriz demandou um estudo especial em se tratando do método dosvolumes ﬁnitos baseado em elementos, o qual se fundamenta em varreduras de elementosda malha computacional.
112As três metodologias abordadas foram analisadas por meio de três exemplos de apli-cação. O primeiro foi destinado à validação do simulador. Trata-se de um caso de desloca-mento unidimensional em uma amostra de rocha no qual é possível calcular uma soluçãoanalítica – a solução de Buckley-Leverett. O segundo exemplo de aplicação foi o desloca-mento bidimensional em conﬁguração ﬁve-spot, a qual é amplamente empregada em es-tudos relacionados à simulação numérica de reservatórios de petróleo. Já o ultimo casoanalisado foi o deslocamento tridimensional em uma malha híbrida.
6.2 CONCLUSÕESO primeiro caso avaliado, de deslocamento unidimensional através de um meio po-roso, possibilitou a veriﬁcação das três metologias utilizadas. As soluções numéricas apre-sentaram o comportamento esperado quanto ao reﬁno de malha, i.e., os perﬁs numéricosde saturação se aproximaram do perﬁl correspondente à solução analítica à medida quea malha foi reﬁnada. Entretanto, até mesmo na malha mais reﬁnada há considerável pre-sença de difusão numérica, a qual é responsável pela suavização da discontinuidade dosperﬁs. Quanto à evolução do passo de tempo, inferiu-se que o esquema de passo de tempoadaptativo pode ser responsável por signiﬁcativa redução do tempo computacional. Alémdisso, conforme esperado, o passo de tempo deve ser reduzido à medida que a malha éreﬁnada. Veriﬁcou-se, também, que sua utilização pode inﬂuenciar demasiadamente aqualidade da solução numérica obtida. Quando esse esquema não foi adotado, as solu-ções determinadas por meio dos três métodos praticamente coincidiram. A solução ob-tida por meio do método totalmente implícito não foi afetada signiﬁcativamente quandoos critérios de passo de tempo adaptativo foram empregados. O método sequencial, con-tudo, apresentou sensibilidade ao critério menos rígido. Já o método IMPES apresentouuma solução mais próxima da analítica quando o critério de passo de tempo adaptativo foiaplicado. Isso se deve, possivelmente, a uma condição mais próxima daquela na qual es-sse método fornece a solução analítica para o caso de Buckley-Leverett. Quanto ao tempocomputacional despendido em cada simulação, infere-se que o passo de tempo adapta-tivo é interessante sobretudo ao método totalmente implícito, o qual é capaz de resolver oproblema mais rapidamente sob essa condição sem que a solução seja demasiadamentealterada. O método sequencial, muito embora tenha fornecido soluções mais rapidamenteque o FIM para alguns casos, apresentou certa sensibilidade em relação ao uso de um passode tempo adaptativo, de forma que deve-se ter cautela a aplicar essa condição para tal mé-113todo. Já o método IMPES clássico se comportou bem quanto à utilização do passo de tempoadaptativo. Contudo, isso pode ser devido a um caráter particular do problema unidimen-sional de Buckley-Leverett.
O segundo caso analisado, de deslocamento em conﬁguração quarter ﬁve-spot, foi uti-lizado a ﬁm de comparar os três métodos quanto ao desempenho e à sensibilidade em re-lação ao esquema de passo de tempo adaptativo em um problema bidimensional. Quandoempregado o esquema de passo de tempo adaptativo, o método IMPES apresentou insta-bilidades na solução numérica após o instante de breakthrough. Essa instabilidade podeser reduzida substancialmente modiﬁcando o IMPES clássico para o método sequencial.
Contudo, isso se dá às custas da necessidade um maior tempo de computação. O métodototalmente implícito, por sua vez, não apresentou tamanha sensibilidade em relação à esseesquema, provendo soluções consistentes tanto com passo de tempo ﬁxo, quanto variável.
Ainda, o tempo computacional despendido por esse método foi aproximadamente dez ve-zes inferior quando utilizou-se o critétio de passo de tempo adaptativo proposto. Alémdisso, a utlização dessa estratégia permitiu que o método FIM, que demandava o maiorcusto computacional com passo de tempo ﬁxo, chegasse a um custo menor que aqueledespendido pelo método sequencial quando foi utilizado o passo de tempo adaptativo.
Ressalta-se ainda que os tempos de simulação correspondentes ao método totalmente im-plícito com passo de tempo adaptativo ﬁcaram da mesma ordem daqueles corresponden-tes à utilização da formulação IMPES com passo de tempo ﬁxo e ambos os métodos apre-sentaram soluções estáveis e consistentes. Portanto, conseguiu-se tirar proveito da robus-tez do FIM no intuito de utilizar passos de tempo mais elevados e, assim, reduzir o tempodemandado pela simulação numérica.
O terceiro caso analisado, de deslocamento tridimensional em uma malha híbrida,possibilitou a veriﬁcação de que, no caso de um problema tridimensional, os métodos IM-PES e sequencial são severamente limitados quanto ao máximo passo de tempo que podeser utilizado, sobretudo em decorrência de um maior grau de reﬁno nas regiões próximasaos poços. À luz dos resultados previamente obtidos, optou-se, nesse caso, por especiﬁcarum passo de tempo ﬁxo aos métodos IMPES e sequencial a ﬁm de evitar instabilidades nassoluções numéricas e utilizar o esquema de passo de tempo adaptativo no caso do mé-todo totalmente implícito no intuito de reduzir o tempo computacional consumido poressa formulação. Os resultados obtidos praticamente coincidiram para os três métodos. O
FIM, contudo, foi capaz de prover as soluções com um custo computacional muito infe-rior em relação aos outros métodos – apenas 7,69% do tempo despendido pela formulaçãoIMPES e 2,96%, do método sequencial. Certamente, esses resultados podem servir a enco-114rajar futuros desenvolvimentos que utilizem o método totalmente implícito em conjuntocom o método dos volumes ﬁnitos baseado em elementos.
6.3 SUGESTÕES PARA TRABALHOS FUTUROSPara estudo subsequentes quanto ao tema abordado neste trabalho recomenda-se:• Estudar esquemas de passo de tempo adaptativo a ﬁm de reduzir a sensibilidade dosmétodos IMPES clássico e sequencial à sua utilização;• Paralelizar o simulador implementado a ﬁm de melhorar seu desempenho quantoao tempo computacional empregado nas simulações;• Introduzir um modelo físico mais complexo no simulador;• Incluir a equação da energia no modelo proposto;• Acoplar modelos de geomecânica ao modelo proposto;115REFERÊNCIASARCHER, J. S., WALL, C. G. Petroleum Engineering – Principles and Practice. Springer,1986.
AZIZ, K. Reservoir Simulation Grids: Opportunities and Problems. Jornal of PetroleumTechnology, v. 45, n. 7, pp. 658–663, Julho, 1993.
AZIZ, K., SETTARI, A. Petroleum Reservoir Simulation. Applied Science Publishers, 1979.
BALAY, S., BUSCHELMAN, K., GROPP, W. D., KAUSHIK, D., KNEPLEY, M. G., MCINNES,L. C., SMITH, B. F., ZHANG, H., 2009. PETSc Web page. http://www.mcs.anl.gov/petsc.
BALAY, S., BROWN, J., BUSCHELMAN, K., GROPP, W. D., KAUSHIK, D., KNEPLEY, M. G.,
MCINNES, L. C., SMITH, B. F., ZHANG, H. PETSc (Portable, Extensible Toolkit for Scien-tiﬁc Computation). http://www.mcs.anl.gov/petsc, 2013.
BALIGA, B. R., PATANKAR, S. V. A. A control-volume ﬁnite-element method for two-dimensional ﬂuid ﬂow and heat transfer. Numerical Heat Transfer, 1983.
BEJAN, A. Convection Heat Transfer, 3ª. John Wiley & Sons, Durham, North Carolina,2004.
BUCHWALTER, J. L., MILLER, C. A. Compositional and Black Oil Reservoir Simulation.
SPE Rocky Mountain Regional/Low Permeability reservoir symposium, Abril, 1993.
CAO, H., AZIZ, K. Performance of IMPSAT and IMPSAT-AIM models in compositionalsimulation. SPE Annual Technical conference and Exhibition, Setembro, 2002.
CHEN, Z. Reservoir Simulation – Mathematical Techniques in Oil Recovery. SIAM, 1962.
CHEN, Z., HUAN, G., MA, Y. Computational Methods for Multiphase Flows in Porous Me-dia. Computational Science and Engineering. Society for Industrial and Applied Mathe-matics (SIAM, 3600 Market Street, Floor 6, Philadelphia, PA 19104), 2006.
CHEN, Z. H., LI, B. An improved IMPES method for two-phase ﬂow in porous media.
Transport in Porous Media,, v. 54, pp. 361–376, 2004.
COATS, K. H. IMPES stability: selection of stable time steps. SPE Reservoir SimulationSymposium, Fevereiro, 1968.
116COATS, K. H. Reservoir simulation: State of art. SPE, Agosto, 1982.
COATS, K. H., THOMAS, L. K., R.G., P. A new simpliﬁed compositional simulator. SPE -Society of Petroleum Engineers, 1995.
CORDAZZO, J. Simulação de reservatórios de petróleo utilizando o método EbFVM eMultigrid algébrico. Master’s Thesis, Universidade Federal de Santa Catarina, 2006.
COREY, A. T., RATHJENS, C. H., HENDERSON, J. H., WYLLIE, M. R. Three-phase relativepermeability. SPE - AIME, 1956.
DA CUNHA, A. R. Uma metodologia para simulação numérica tridimensional de re-servatórios de petróleo utilizando modelo black-oil e formulação em frações mássicas.
Master’s Thesis, Universidade Federal de Santa Catarina - UFSC, 1996.
DAKE, L. P. The Practice of Reservoir Engineering, revised edition. Eselvier, Netherlands,2001.
DARCY, H. Les Fontaines Publiques de la Ville de Dijon. 1856.
DULLIEN, F. A. L. Porous media. Fluid transport and pore structure. Academic Press,1979.
EWING, R. The Mathematics of Reservoir Simulation. SIAM, 1983.
FARNSTROM, K. L., ERTEKIN, T. A versatile, fully implicit, black oil simulator with vari-able bubble-point option. SPE California Regional Meeting, 1987.
GREIN, E. A. Aplicação da computação paralela na simulação de reservatórios de petró-leo. Master’s Thesis, Universidade Federal de Santa Catarina, 2015.
HURTADO, F. S. V. Uma formulação de volumes ﬁnitos baseada em elementos para asimulação do deslocamento bifásico imiscível em meios porosos. Master’s Thesis, Uni-versidade Federal de Santa Catarina, 2005.
HURTADO, F. S. V. Formulação tridimensional de volumes ﬁnitos para simulação de re-servatórios de petróleo com malhas não-estruturadas híbridas. Tese de doutorado, De-partamento de Engenharia Mecânica, Universidade Federal de Santa Catarina, Florianó-polis, Brasil, 2011.
KAVIANY, M. Principles of Heat Transfer in Porous Media. Springer, Ann Arbor, Michigan,1171995.
MACDONALD, R. C., COATS, K. H. Methods for Numerical Simulation of Water and GasConing. SPE, n. 10, pp. 425–436, 1970.
MALISKA, C. R. Transferência de Calor e Mecânica dos Fluidos Computacional. LTC Edi-tora, Rio de Janeiro, RJ, 2004.
MALISKA, C. R., DA SILVA, A. F. C., HURTADO, F. S. V., RIBEIRO, G. G., JR, A. A. V. B. P.,
GREIN, E. A., CERBATO, G. Introdução às malhas poliédricas e ao método baseado na re-construção explícita do gradiente, Relatório Técnico SINMEC/SiGeR 01. Technical report01, SINMEC/EMC/UFSC, Florianópolis, SC, 2012.
MALISKA, C. R., DA SILVA, A. F. C., HURTADO, F. S. V., RIBEIRO, G. G., CERBATO, G. De-senvolvimento de um esquema para a aproximação dos ﬂuxos na interface entre malhasestruturadas e não estruturadas, Relatório Técnico SINMEC/SiGeR 03. Technical report01, SINMEC/EMC/UFSC, Florianópolis, SC, 2015.
MCCAIN JR, W. The propreties of Petroleum Fluids. PennWell Publishing Company, Tulsa,Oklahoma, 1990.
PEACEMAN, D. W. Fundamentals of numerical reservoir simulation. Elsevier ScientiﬁcPublishing Company, Houston, Texas, 1977.
PEACEMAN, D. W. Interpretation of Well-Block Pressures in Numerical Reservoir Simu-lation. SPE journal, v. 18, n. 3, pp. 183–194, Junho, 1978.
ROSA, A. J., CARVALHO, R. S., XAVIER, J. A. Engenharia de reservatórios de petróleo. Edi-tora Interciência, 2006.
SHELDON, J. W., ZONDEK, B., CARDWELL, W. T. One Dimensional, Incompressible, Non-capillary, Two-Phase Fluid Flow in a Porous Medium. AIME, v. 216, pp. 290–296, 1959.
STONE, H. L., GARDER, A. O. Analysis of gas-cap or dissolved-gas reservoir. SPE AIME, v.
222, pp. 94–104, 1961.
THOMAS, J. E. Fundamentos de Engenharia de Petróleo. Editora Interciência, Rio deJaneiro, RJ, 2001.
TRANGENSTEIN, J. A., BELL, J. B. Mathematical Structure Of The Black-Oil Model For Pe-118troleum Reservoir Simulation. SIAM Journal on Applied Mathematics, v. Vol. 49, pp. 749–783, 1989.
WATTS, J. W. A compositional formulation of the pressure and saturation equations. SPE,1985.
YOUNG, L. C., STEPHENSON, E. R. A generalized compositional approach for reservoirsimulation. SPEJ, 1983.
ZIENKIEWICZ, O. C., TAYLOR, R. L. The Finite Element Method, ﬁfth, vol. 1. Butterworth-Heinemann, 2000.
119APÊNDICE A – DIFUSÃO NUMÉRICA NO PROBLEMA DEBUCKLEY-LEVERETTMétodos explícitos requerem que a restrição de Courant-Friedrichs-Lewy (CFL) sejasatisfeita, ao passo que métodos implícitos são incondicionalmente estáveis (Chen et al.,
2006). Esses métodos aprentam não apenas estabilidades diferentes, mas também com-portamentos distintos quanto ao custo computacional e à difusão numérica.
No caso especíﬁco do problema unidimensional de Buckley-Leverett, pode-se elucidarque há uma condição especíﬁca em que o método IMPES fornece a solução analítica e quenão é possível obtê-la por meio do método totalmente implícito. A equação modelo doproblema é∂ S∂ τ∂ F∂ X+= 0.
(A.1)
Trata-se de uma equação hiperbólica na qual tem-se a propagação unidirecional de umaonda (Chen et al., 2006).
A discretização dessa equação por meio do método dos volumes ﬁnitos e do esquemaupwind para uma malha unidimensional éSi − S oSi − Si−1(cid:48)= 0.
+ Fii(A.2)
∆τ∆Xem que i é o índice do volume de controle da equação e o superíndice o representa umavariável associada ao passo de tempo anterior.
S o = 0.
Para o método explícito tem-se(cid:48)Si − S o− S oi−1∆τFi∆X+(A.3)
iiIdentiﬁcando o coeﬁciente que multiplica o termo entre parênteses como o CFL e denotando-o por α, pode-se escreverSi − (1− α)S o− αS oi−1= 0.
(A.4)
iPode-se observar que a equação (A.4) é numéricamente estável para α ≤ 1. Além disso,